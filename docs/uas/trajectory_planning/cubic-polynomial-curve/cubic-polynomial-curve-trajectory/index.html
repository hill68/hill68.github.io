<!doctype html><html lang=zh-cn dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.147.3"><meta name=generator content="Relearn 7.6.1+4407b4364ab6f7477f7671fbd20c0494bade40ee"><meta name=description content="é’ˆå¯¹è½¨è¿¹è§„åˆ’é—®é¢˜ï¼Œè¯¦ç»†é˜è¿°äº†å¦‚ä½•åˆ©ç”¨ä¸‰æ¬¡å¤šé¡¹å¼æ ·æ¡æ’å€¼æ„é€ ä¸€æ¡å¹³æ»‘è¿ç»­çš„è½¨è¿¹æ›²çº¿ã€‚"><meta name=author content="ä½ çš„åå­—"><meta name=twitter:card content="summary"><meta name=twitter:title content="ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ :: FlitSoft Docs"><meta name=twitter:description content="é’ˆå¯¹è½¨è¿¹è§„åˆ’é—®é¢˜ï¼Œè¯¦ç»†é˜è¿°äº†å¦‚ä½•åˆ©ç”¨ä¸‰æ¬¡å¤šé¡¹å¼æ ·æ¡æ’å€¼æ„é€ ä¸€æ¡å¹³æ»‘è¿ç»­çš„è½¨è¿¹æ›²çº¿ã€‚"><meta property="og:url" content="https://hill68.github.io/uas/trajectory_planning/cubic-polynomial-curve/cubic-polynomial-curve-trajectory/index.html"><meta property="og:site_name" content="FlitSoft Docs"><meta property="og:title" content="ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ :: FlitSoft Docs"><meta property="og:description" content="é’ˆå¯¹è½¨è¿¹è§„åˆ’é—®é¢˜ï¼Œè¯¦ç»†é˜è¿°äº†å¦‚ä½•åˆ©ç”¨ä¸‰æ¬¡å¤šé¡¹å¼æ ·æ¡æ’å€¼æ„é€ ä¸€æ¡å¹³æ»‘è¿ç»­çš„è½¨è¿¹æ›²çº¿ã€‚"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="UAS"><meta property="article:published_time" content="2025-05-21T17:07:50+08:00"><meta property="article:modified_time" content="2025-05-21T17:07:50+08:00"><meta itemprop=name content="ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ :: FlitSoft Docs"><meta itemprop=description content="é’ˆå¯¹è½¨è¿¹è§„åˆ’é—®é¢˜ï¼Œè¯¦ç»†é˜è¿°äº†å¦‚ä½•åˆ©ç”¨ä¸‰æ¬¡å¤šé¡¹å¼æ ·æ¡æ’å€¼æ„é€ ä¸€æ¡å¹³æ»‘è¿ç»­çš„è½¨è¿¹æ›²çº¿ã€‚"><meta itemprop=datePublished content="2025-05-21T17:07:50+08:00"><meta itemprop=dateModified content="2025-05-21T17:07:50+08:00"><meta itemprop=wordCount content="7896"><title>ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ :: FlitSoft Docs</title>
<link href=/images/logo.png?1750837026 rel=icon type=image/png><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1750837026 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1750837026 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1750837026 rel=stylesheet><link href=/css/theme.min.css?1750837026 rel=stylesheet><link href=/css/format-html.min.css?1750837026 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1750837026 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1750837026 defer></script><script src=/js/lunr/lunr.min.js?1750837026 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1750837026 defer></script><script src=/js/lunr/lunr.multi.min.js?1750837026 defer></script><script src=/js/lunr/lunr.zh.min.js?1750837026 defer></script><script src=/js/search.min.js?1750837026 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/uas/trajectory_planning/cubic-polynomial-curve/cubic-polynomial-curve-trajectory/index.html",window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://hill68.github.io",window.relearn.contentLangs=["zh"],window.relearn.index_js_url="/searchindex.en.js?1750837026",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.relearn.themevariants=["zen-light","zen-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/css/custom.css?1750837026 rel=stylesheet></head><body class="mobile-support html" data-url=/uas/trajectory_planning/cubic-polynomial-curve/cubic-polynomial-curve-trajectory/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#æ‘˜è¦><strong>æ‘˜è¦ï¼š</strong></a></li><li><a href=#ä¸€é—®é¢˜å®šä¹‰>ä¸€ã€é—®é¢˜å®šä¹‰</a></li><li><a href=#äºŒç»™å®šçº¦æŸèµ·å§‹é€Ÿåº¦--ç»“æŸé€Ÿåº¦>äºŒã€ç»™å®šçº¦æŸï¼šèµ·å§‹é€Ÿåº¦ ã€ç»“æŸé€Ÿåº¦</a><ul><li><a href=#1-ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ‰€æœ‰çº¦æŸ>1. ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ‰€æœ‰çº¦æŸï¼š</a></li><li><a href=#2-ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—>2. ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—</a></li><li><a href=#3ä¸¤ç§è®¡ç®—æ–¹æ³•çš„æ¯”è¾ƒ>3ã€ä¸¤ç§è®¡ç®—æ–¹æ³•çš„æ¯”è¾ƒ</a></li></ul></li><li><a href=#ä¸‰ç»™å®šçº¦æŸå‘¨æœŸä¸‰æ¬¡æ ·æ¡>ä¸‰ã€ç»™å®šçº¦æŸï¼šå‘¨æœŸä¸‰æ¬¡æ ·æ¡</a></li><li><a href=#å››ç»™å®šçº¦æŸç»™å®šèµ·å§‹é€Ÿåº¦--ç»“æŸé€Ÿåº¦--èµ·å§‹åŠ é€Ÿåº¦--ç»“æŸåŠ é€Ÿåº¦>å››ã€ç»™å®šçº¦æŸï¼šç»™å®šèµ·å§‹é€Ÿåº¦ ã€ç»“æŸé€Ÿåº¦ ï¼Œèµ·å§‹åŠ é€Ÿåº¦ ã€ç»“æŸåŠ é€Ÿåº¦</a></li><li><a href=#äº”å‚è€ƒæ–‡çŒ®>äº”ã€å‚è€ƒæ–‡çŒ®</a></li><li><a href=#é™„å½•-1--ä¸‰å¯¹è§’æ–¹ç¨‹ä¸å¾ªç¯ä¸‰å¯¹è§’æ–¹ç¨‹æ•°å€¼è§£>é™„å½• 1. ä¸‰å¯¹è§’æ–¹ç¨‹ä¸å¾ªç¯ä¸‰å¯¹è§’æ–¹ç¨‹æ•°å€¼è§£</a><ul><li><a href=#1-ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£>1. ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£</a></li><li><a href=#2-å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£>2. å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£</a></li><li><a href=#3-c-ç¤ºä¾‹ä»£ç >3. C++ ç¤ºä¾‹ä»£ç </a></li></ul></li><li><a href=#é™„å½•-2--ç»™å®šèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼cç¤ºä¾‹>é™„å½• 2. ç»™å®šèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼C++ç¤ºä¾‹</a><ul><li><a href=#1ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—>1ã€ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—</a></li><li><a href=#2ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—>2ã€ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—</a></li></ul></li><li><a href=#é™„å½•-3-ç»™å®šèµ·å§‹ä¸ç»“æŸçš„é€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼>é™„å½• 3. ç»™å®šèµ·å§‹ä¸ç»“æŸçš„é€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼</a><ul><li><a href=#ä»£ç è¯´æ˜-3>ä»£ç è¯´æ˜</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>FlitSoft Docs</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/uas/index.html><span itemprop=name>UAS</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/uas/trajectory_planning/index.html><span itemprop=name>Trajectory Planning</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/uas/trajectory_planning/cubic-polynomial-curve/index.html><span itemprop=name>Cubic Polynomial Spline</span></a><meta itemprop=position content="4">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼</span><meta itemprop=position content="5"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/uas/trajectory_planning/cubic-polynomial-curve/index.html title="Cubic Polynomial Spline (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/uas/trajectory_planning/-b-spline/index.html title="B-Spline (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable uas" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼>ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼</h1><p><a href=https://github.com/flitai/Cubic-Polynomial-Spline-Trajectory rel=external target=_blank>C++å®ç°ä»£ç </a></p><h2 id=æ‘˜è¦><strong>æ‘˜è¦ï¼š</strong></h2><p>æœ¬æ–‡æ¡£é’ˆå¯¹è½¨è¿¹è§„åˆ’é—®é¢˜ï¼Œè¯¦ç»†é˜è¿°äº†å¦‚ä½•åˆ©ç”¨ä¸‰æ¬¡æ ·æ¡æ’å€¼æ„é€ ä¸€æ¡å¹³æ»‘è¿ç»­çš„è½¨è¿¹æ›²çº¿ã€‚æ–‡æ¡£ä¸ä»…ç³»ç»Ÿé˜è¿°äº†ä¸‰æ¬¡æ ·æ¡æ’å€¼çš„ç†è®ºåŸºç¡€åŠå…¶è¾¹ç•Œæ¡ä»¶æ„é€ æ–¹æ³•ï¼ŒåŒæ—¶é€šè¿‡è¯¦ç»†çš„ç¤ºä¾‹ä»£ç å’Œé™„å½•éƒ¨åˆ†ï¼Œä¸ºå®é™…è½¨è¿¹è§„åˆ’é—®é¢˜æä¾›äº†ä»ç†è®ºåˆ°æ•°å€¼å®ç°çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚</p><p>æ–‡æ¡£çš„ä¸»ä½“éƒ¨åˆ†æŒ‰ä¸åŒè¾¹ç•Œæ¡ä»¶åˆ†ç±»è®¨è®ºäº†ä¸‰ç§æƒ…å†µï¼š</p><ol><li><p><strong>ä»…ç»™å®šèµ·å§‹ä¸ç»“æŸé€Ÿåº¦çš„æƒ…å½¢</strong><br>è¯¥æ–¹æ³•ä»¥å„è¿æ¥å¤„çš„é€Ÿåº¦ä½œä¸ºä¸»è¦æœªçŸ¥é‡ï¼Œåˆ©ç”¨ä½ç½®ã€é€Ÿåº¦ä¸åŠ é€Ÿåº¦è¿ç»­æ€§æ¡ä»¶æ„é€ å‡ºä¸€ä¸ªæ ‡å‡†çš„å¯¹è§’å ä¼˜ä¸‰å¯¹è§’ç³»ç»Ÿã€‚é‡‡ç”¨ Thomas ç®—æ³•æ±‚è§£è¯¥ç³»ç»Ÿåï¼Œå†æ ¹æ®æ±‚å¾—çš„é€Ÿåº¦å€¼è®¡ç®—å„æ®µå¤šé¡¹å¼çš„ç³»æ•°ã€‚è¯¥æ–¹æ³•ç»“æ„ç®€å•ï¼Œé€‚ç”¨äºåªç»™å®šè¾¹ç•Œé€Ÿåº¦æ—¶çš„è½¨è¿¹è§„åˆ’ã€‚</p></li><li><p><strong>å‘¨æœŸä¸‰æ¬¡æ ·æ¡</strong><br>å½“æ ·æ¡æ›²çº¿è¦æ±‚å‘¨æœŸæ€§ï¼ˆå³èµ·å§‹ä½ç½®ä¸ç»“æŸä½ç½®ç›¸åŒï¼ŒåŒæ—¶è¾¹ç•Œå¤„çš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ä¹Ÿç›¸ç­‰ï¼‰æ—¶ï¼Œé—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹ã€‚æ–‡æ¡£ä»‹ç»äº†å¦‚ä½•æ„é€ è¿™ç§ç‰¹æ®Šç³»ç»Ÿä»¥åŠåˆ©ç”¨ Sherman-Morrison å…¬å¼æˆ–å…¶ä»–åˆ†è§£æ–¹æ³•å°†å…¶è½¬åŒ–ä¸ºæ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿè¿›è¡Œæ±‚è§£ã€‚</p></li><li><p><strong>åŒæ—¶ç»™å®šèµ·å§‹ä¸ç»“æŸçš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çš„æƒ…å½¢</strong><br>ç”±äºä¸€èˆ¬éš¾ä»¥ç›´æ¥åŒæ—¶æŒ‡å®šç«¯ç‚¹çš„é€Ÿåº¦ä¸åŠ é€Ÿåº¦ï¼Œæ–‡æ¡£æå‡ºåœ¨ç¬¬ä¸€æ®µå’Œæœ€åä¸€æ®µåˆ†åˆ«æ’å…¥è¾…åŠ©èŠ‚ç‚¹ï¼Œä»è€Œæ‰©å±•åŸå§‹èŠ‚ç‚¹åºåˆ—ã€‚æ‰©å±•ååˆ©ç”¨ä¿®æ­£è¾¹ç•Œæ¡ä»¶æ„é€ æ–°çš„ä¸‰å¯¹è§’ç³»ç»Ÿæ±‚è§£è¾…åŠ©å˜é‡ï¼ˆèŠ‚ç‚¹åŠ é€Ÿåº¦ï¼‰ï¼Œè¿›è€Œè®¡ç®—å„æ®µå¤šé¡¹å¼ç³»æ•°ï¼Œå®ç°åŒæ—¶æ»¡è¶³ç«¯ç‚¹é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çº¦æŸçš„æ ·æ¡æ„é€ ã€‚</p></li></ol><p>æ–‡æ¡£ååŠéƒ¨åˆ†æä¾›äº†è¯¦ç»†çš„ MATLAB ç¤ºä¾‹ä»¥åŠæ¨¡å—åŒ–çš„ C++ ç¤ºä¾‹ä»£ç ï¼Œåˆ†åˆ«æ¼”ç¤ºäº†åŸºäºé€Ÿåº¦æ³•å’ŒåŸºäºåŠ é€Ÿåº¦æ³•çš„å®ç°è¿‡ç¨‹ã€‚</p><p><strong>é™„å½•éƒ¨åˆ†</strong>åˆ™æ·±å…¥ä»‹ç»äº†æ•°å€¼æ±‚è§£çš„åŸºç¡€æ–¹æ³•ï¼š</p><ul><li><strong>é™„å½• 1</strong>è¯¦ç»†è¯´æ˜äº†ä¸‰å¯¹è§’çŸ©é˜µä¸å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µçš„æ•°å€¼è§£æ³•ï¼Œé‡ç‚¹ä»‹ç»äº† Thomas ç®—æ³•çš„å‰å‘æ¶ˆå»ä¸å›ä»£æ­¥éª¤ï¼Œå¹¶è®¨è®ºäº†å¦‚ä½•å¤„ç†å…·æœ‰å¾ªç¯è¾¹ç•Œæ¡ä»¶çš„ç‰¹æ®Šæƒ…å½¢ï¼ˆåˆ©ç”¨ Sherman-Morrison å…¬å¼æˆ–åˆ†è§£æ³•ï¼‰ã€‚</li><li><strong>é™„å½• 2</strong>å’Œ<strong>é™„å½• 3</strong>åˆ†åˆ«ç»™å‡ºäº†åœ¨ä»…ç»™å®šè¾¹ç•Œé€Ÿåº¦å’ŒåŒæ—¶ç»™å®šè¾¹ç•Œé€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼çš„ C++ ç¤ºä¾‹ä»£ç ï¼Œæä¾›äº†å®Œæ•´çš„å®ç°æ–¹æ¡ˆï¼Œä¾¿äºå·¥ç¨‹å®è·µä¸­è¿›è¡Œæ‰©å±•å’Œè°ƒè¯•ã€‚</li></ul><h2 id=ä¸€é—®é¢˜å®šä¹‰>ä¸€ã€é—®é¢˜å®šä¹‰</h2><p>ç»™å®š $\mathrm{n}+1$ ä¸ªç‚¹ $\left(\mathrm{t}_{\mathrm{i}}, \mathrm{q}_{\mathrm{i}}\right), \mathrm{i}=0,1, \ldots, \mathrm{n}$ ï¼Œæ±‚è§£ n æ®µä¸‰æ¬¡å¤šé¡¹å¼ $\mathrm{q}_{\mathrm{k}}(\mathrm{t})$ ï¼Œä½¿å¾—æ‹¼æ¥è€Œæˆçš„ä¸‰æ¬¡æ ·æ¡æ›²çº¿ $\mathrm{s}(\mathrm{t})$ ç»è¿‡æ‰€æœ‰ç»™å®šç‚¹ï¼Œè€Œä¸”äºŒé˜¶è¿ç»­ã€‚ä¸‰æ¬¡æ ·æ¡æ›²çº¿ $\mathrm{s}(\mathrm{t})$ å®šä¹‰å¦‚ä¸‹ï¼š</p><img src=https://cdn.mathpix.com/snip/images/9lbuJx1WtYE0aso-mtHaXo1ryCnMf6Vrh7LO4WLWhwY.original.fullsize.png width=500/>
$$
\left\{\begin{array}{l}
\mathrm{s}(\mathrm{t})=\left\{\mathrm{q}_{\mathrm{k}}(\mathrm{t}), \mathrm{t} \in\left[\mathrm{t}_{\mathrm{k}}, \mathrm{t}_{\mathrm{k}+1}\right], \mathrm{k}=0,1, \ldots, \mathrm{n}-1\right\} \\
\mathrm{q}_{\mathrm{k}}(\mathrm{t})=\mathrm{a}_{\mathrm{k} 0}+\mathrm{a}_{\mathrm{k} 1}\left(\mathrm{t}-\mathrm{t}_{\mathrm{k}}\right)+\mathrm{a}_{\mathrm{k} 2}\left(\mathrm{t}-\mathrm{t}_{\mathrm{k}}\right)^2+\mathrm{a}_{\mathrm{k} 3}\left(\mathrm{t}-\mathrm{t}_{\mathrm{k}}\right)^3
\end{array}\right. \tag{1}
$$<p>æ¯ä¸€æ®µä¸‰æ¬¡å¤šé¡¹å¼ $q_k(\mathrm{t})$ éœ€è¦ç¡®å®š 4 ä¸ªç³»æ•°ï¼Œå› è€ŒæœªçŸ¥æ•°å…± 4 n ä¸ªã€‚</p><p>ä¸‰æ¬¡æ ·æ¡æ›²çº¿åŸºæœ¬çº¦æŸæ¡ä»¶ï¼š</p><p>ï¼ˆ1ï¼‰ä½ç½®çº¦æŸï¼Œæ¯ä¸€æ®µä¸‰æ¬¡å¤šé¡¹å¼éƒ½å¿…é¡»ç»è¿‡ä¸¤ä¸ªç‚¹ï¼Œæœ‰çº¦æŸæ¡ä»¶ 2 n ä¸ªï¼›</p><p>ï¼ˆ2ï¼‰é€Ÿåº¦çº¦æŸï¼Œç›¸é‚»ä¸¤æ®µä¸‰æ¬¡å¤šé¡¹å¼åœ¨è¿æ¥å¤„çš„é€Ÿåº¦ç›¸ç­‰ï¼Œæœ‰çº¦æŸæ¡ä»¶ $\mathrm{n}-1$ ä¸ªï¼›</p><p>ï¼ˆ3ï¼‰åŠ é€Ÿåº¦çº¦æŸï¼Œç›¸é‚»ä¸¤æ®µä¸‰æ¬¡å¤šé¡¹å¼åœ¨è¿æ¥å¤„çš„åŠ é€Ÿåº¦ç›¸ç­‰ï¼Œæœ‰çº¦æŸæ¡ä»¶ $\mathrm{n}-1$ ä¸ªã€‚æ•…è¿˜éœ€ä¸¤ä¸ªç»™å®šçº¦æŸ $(4 \mathrm{n}-2 \mathrm{n}-(\mathrm{n}-1)-(\mathrm{n}-1)=2)$ ï¼Œä¾¿å¯å”¯ä¸€ç¡®å®šä¸‰æ¬¡æ ·æ¡æ›²çº¿ã€‚</p><p>è¿™é‡Œè®¨è®ºä¸‰ç§ä¸åŒçš„ç»™å®šçº¦æŸï¼š</p><p>ï¼ˆ1ï¼‰ç»™å®šèµ·å§‹é€Ÿåº¦ $\mathrm{v}_0$ ä¸ç»“æŸé€Ÿåº¦ $\mathrm{v}_{\mathrm{n}}$</p><p>ï¼ˆ2ï¼‰èµ·å§‹ä½ç½® $q_0$ ä¸ç»“æŸä½ç½® $q_n$ ç›¸ç­‰ï¼ˆæ•°æ®éœ€æ»¡è¶³çš„ç‰¹æ€§ï¼Œéçº¦æŸæ¡ä»¶ï¼‰ï¼Œèµ·å§‹é€Ÿåº¦ $v_0$ ä¸ç»“æŸé€Ÿåº¦ $v_n$ç›¸ç­‰ï¼Œèµ·å§‹åŠ é€Ÿåº¦ $a_0$ ä¸ç»“æŸåŠ é€Ÿåº¦ $a_n$ ç›¸ç­‰ï¼ˆå‘¨æœŸä¸‰æ¬¡æ ·æ¡ï¼‰</p><p>ï¼ˆ3ï¼‰ç»™å®šèµ·å§‹é€Ÿåº¦ $v_0$ ï¼Œç»“æŸé€Ÿåº¦ $v_n$ ï¼Œèµ·å§‹åŠ é€Ÿåº¦ $a_0$ ï¼Œç»“æŸåŠ é€Ÿåº¦ $a_n$</p><p>ç”±äºæ ·æ¡æ’å€¼åœ¨æ¯ä¸ªç»´åº¦ä¸Šæ˜¯ç‹¬ç«‹çš„ï¼ˆå‰ææ˜¯å‚æ•° $t$ ç›¸åŒï¼‰ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¸­å¯ä»¥å°†äºŒæ¨é—®é¢˜æ‹†åˆ†ä¸ºå¯¹ $x(t)$ä¸ $y(t)$ åˆ†åˆ«åšä¸€ç»´æ ·æ¡æ’å€¼ã€‚è¿™ç§è®¾è®¡å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰©å±•åˆ°äºŒç»´ï¼ˆæˆ–æ›´é«˜ç»´ï¼‰ï¼Œåªéœ€è¦ä¸ºæ¯ä¸ªåˆ†é‡æ„é€ ç‹¬ç«‹çš„æ ·æ¡ï¼Œç„¶ååœ¨ä½¿ç”¨æ—¶å°†å„ä¸ªåˆ†é‡ç»„åˆå³å¯ã€‚</p><h2 id=äºŒç»™å®šçº¦æŸèµ·å§‹é€Ÿåº¦--ç»“æŸé€Ÿåº¦>äºŒã€ç»™å®šçº¦æŸï¼šèµ·å§‹é€Ÿåº¦ $\mathrm{v}_0$ ã€ç»“æŸé€Ÿåº¦ $\mathrm{v}_{\mathrm{n}}$</h2><h3 id=1-ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ‰€æœ‰çº¦æŸ>1. ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ‰€æœ‰çº¦æŸï¼š</h3>$$
\left\{\begin{array}{l}
\mathrm{q}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}}\right)=\mathrm{q}_{\mathrm{k}}, \mathrm{q}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}\right)=\mathrm{q}_{\mathrm{k}+1}, \mathrm{k}=0, \ldots, \mathrm{n}-1 \\
\dot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}\right)=\dot{\mathrm{q}}_{\mathrm{k}+1}\left(\mathrm{t}_{\mathrm{k}+1}\right)=\mathrm{v}_{\mathrm{k}+1}, \mathrm{k}=0, \ldots, \mathrm{n}-2 \\
\ddot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}\right)=\ddot{\mathrm{q}}_{\mathrm{k}+1}\left(\mathrm{t}_{\mathrm{k}+1}\right), \mathrm{k}=0, \ldots, \mathrm{n}-2 \\
\dot{\mathrm{q}}_0\left(\mathrm{t}_0\right)=\mathrm{v}_0, \dot{\mathrm{q}}_{\mathrm{n}-1}\left(\mathrm{t}_{\mathrm{n}}\right)=\mathrm{v}_{\mathrm{n}}
\end{array}\right. \tag{2}
$$<p>è‹¥æ‰€æœ‰ä¸­é—´ç‚¹é€Ÿåº¦ $\mathrm{v}_{\mathrm{k}}(\mathrm{k}=1, \ldots, \mathrm{n}-1)$ éƒ½å·²çŸ¥ï¼Œæ ¹æ®ä½ç½®ä¸é€Ÿåº¦çº¦æŸï¼š</p>$$
\left\{\begin{array}{l}
\mathrm{q}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}}\right)=\mathrm{a}_{\mathrm{k} 0}=\mathrm{q}_{\mathrm{k}} \\
\dot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}}\right)=\mathrm{a}_{\mathrm{k} 1}=\mathrm{v}_{\mathrm{k}} \\
\mathrm{q}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}\right)=\mathrm{a}_{\mathrm{k} 0}+\mathrm{a}_{\mathrm{k} 1} \mathrm{~T}_{\mathrm{k}}+\mathrm{a}_{\mathrm{k} 2} \mathrm{~T}_{\mathrm{k}}^2+\mathrm{a}_{\mathrm{k} 3} \mathrm{~T}_{\mathrm{k}}^3=\mathrm{q}_{\mathrm{k}+1} \\
\dot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}\right)=\mathrm{a}_{\mathrm{k} 1}+2 \mathrm{a}_{\mathrm{k} 2} \mathrm{~T}_{\mathrm{k}}+3 \mathrm{a}_{\mathrm{k} 3} \mathrm{~T}_{\mathrm{k}}^2=\mathrm{v}_{\mathrm{k}+1}
\end{array}\right. \tag{3}
$$<p>å…¶ä¸­ï¼Œ $\mathrm{T}_{\mathrm{k}}=\mathrm{t}_{\mathrm{k}+1}-\mathrm{t}_{\mathrm{k}}$ ã€‚
ç”±å¼ï¼ˆ3ï¼‰å¯è§£å¾—ï¼š</p>$$
\left\{\begin{array}{l}
\mathrm{a}_{\mathrm{k}, 0}=\mathrm{q}_{\mathrm{k}} \\
\mathrm{a}_{\mathrm{k}, 1}=\mathrm{v}_{\mathrm{k}} \\
\mathrm{a}_{\mathrm{k}, 2}=\left[3\left(\mathrm{q}_{\mathrm{k}+1}-\mathrm{q}_{\mathrm{k}}\right) / \mathrm{T}_{\mathrm{k}}-2 \mathrm{v}_{\mathrm{k}}-\mathrm{v}_{\mathrm{k}+1}\right] / \mathrm{T}_{\mathrm{k}} \\
\mathrm{a}_{\mathrm{k}, 3}=\left[2\left(\mathrm{q}_{\mathrm{k}}-\mathrm{q}_{\mathrm{k}+1}\right) / \mathrm{T}_{\mathrm{k}}+\mathrm{v}_{\mathrm{k}}+\mathrm{v}_{\mathrm{k}+1}\right] / \mathrm{T}_{\mathrm{k}}^2
\end{array}\right. \tag{4}
$$<p>è€ƒè™‘åŠ é€Ÿåº¦çº¦æŸï¼š</p>$$
\ddot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}\right)=2 \mathrm{a}_{\mathrm{k}, 2}+6 \mathrm{a}_{\mathrm{k}, 3} \mathrm{~T}_{\mathrm{k}}=2 \mathrm{a}_{\mathrm{k}+1,2}=\ddot{\mathrm{q}}_{\mathrm{k}+1}\left(\mathrm{t}_{\mathrm{k}+1}\right) \tag{5}
$$<p>å°† $\mathrm{a}_{\mathrm{k}, 2}, \mathrm{a}_{\mathrm{k}, 3}, \mathrm{a}_{\mathrm{k}+1,2}$ ä»£å…¥å¼ï¼ˆ5ï¼‰åŒ–ç®€å¾—ï¼š</p>$$
\begin{aligned}
& \mathrm{T}_{\mathrm{k}+1} \mathrm{v}_{\mathrm{k}}+2\left(\mathrm{~T}_{\mathrm{k}+1}+\mathrm{T}_{\mathrm{k}}\right) \mathrm{v}_{\mathrm{k}+1}+\mathrm{T}_{\mathrm{k}} \mathrm{v}_{\mathrm{k}+2} \\
& =3\left[\mathrm{~T}_{\mathrm{k}}^2\left(\mathrm{q}_{\mathrm{k}+2}-\mathrm{q}_{\mathrm{k}+1}\right)+\mathrm{T}_{\mathrm{k}+1}^2\left(\mathrm{q}_{\mathrm{k}+1}-\mathrm{q}_{\mathrm{k}}\right)\right] /\left(\mathrm{T}_{\mathrm{k}} \mathrm{~T}_{\mathrm{k}+1}\right)
\end{aligned} \tag{6}
$$<p>å…¶ä¸­ï¼Œ $\mathrm{k}=0,1, \ldots, \mathrm{n}-2$ ã€‚
å¼ï¼ˆ6ï¼‰å†™æˆçŸ©é˜µå½¢å¼ï¼ˆ $\mathrm{v}_0, \mathrm{v}_{\mathrm{n}}$ å·²çŸ¥ï¼‰ï¼š</p>$$
\begin{gathered}
{\left[\begin{array}{ccccc}
2\left(\mathrm{~T}_0+\mathrm{T}_1\right) & \mathrm{T}_0 & 0 & \cdots & 0 \\
\mathrm{~T}_2 & 2\left(\mathrm{~T}_1+\mathrm{T}_2\right) & \mathrm{T}_1 & 0 & \vdots \\
0 & & \ddots & & 0 \\
\vdots & 0 & \mathrm{~T}_{\mathrm{n}-2} & 2\left(\mathrm{~T}_{\mathrm{n}-3}+\mathrm{T}_{\mathrm{n}-2}\right) & \mathrm{T}_{\mathrm{n}-3} \\
0 & \cdots & 0 & \mathrm{~T}_{\mathrm{n}-1} & 2\left(\mathrm{~T}_{\mathrm{n}-2}+\mathrm{T}_{\mathrm{n}-1}\right)
\end{array}\right]\left[\begin{array}{c}
\mathrm{v}_1 \\
\mathrm{v}_2 \\
\vdots \\
\mathrm{v}_{\mathrm{n}-2} \\
\mathrm{v}_{\mathrm{n}-1}
\end{array}\right]} \\
\quad=\left[\begin{array}{c}
3\left[\mathrm{~T}_0^2\left(\mathrm{q}_2-\mathrm{q}_1\right)+\mathrm{T}_1^2\left(\mathrm{q}_1-\mathrm{q}_0\right)\right] /\left(\mathrm{T}_0 \mathrm{~T}_1\right)-\mathrm{T}_1 \mathrm{v}_0 \\
3\left[\mathrm{~T}_1^2\left(\mathrm{q}_3-\mathrm{q}_2\right)+\mathrm{T}_2^2\left(\mathrm{q}_2-\mathrm{q}_1\right)\right] /\left(\mathrm{T}_1 \mathrm{~T}_2\right) \\
\vdots \\
3\left[\mathrm{~T}_{\mathrm{n}-2}^2\left(\mathrm{q}_{\mathrm{n}}-\mathrm{q}_{\mathrm{n}-1}\right)+\mathrm{T}_{\mathrm{n}-1}^2\left(\mathrm{q}_{\mathrm{n}-1}-\mathrm{q}_{\mathrm{n}-2}\right)\right] /\left(\mathrm{T}_{\mathrm{n}-2} \mathrm{~T}_{\mathrm{n}-1}\right)-\mathrm{T}_{\mathrm{n}-2} \mathrm{v}_{\mathrm{n}}
\end{array}\right]
\end{gathered} \tag{7}
$$<p>å¼ï¼ˆ7ï¼‰ä¸ºå¯¹è§’å ä¼˜çš„ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹ï¼Œå¯ä»¥åˆ©ç”¨Thomas algorithm æˆ–ç§°ï¼‚è¿½èµ¶æ³•ï¼‚å¿«é€Ÿä¸”ç¨³å®šåœ°æ±‚è§£ï¼Œè€Œæ— éœ€æ±‚è§£çŸ©é˜µçš„é€†ã€‚å¯å‚è€ƒ<a href=https://blog.csdn.net/maple_2014/article/details/107170005 rel=external target=_blank>åšæ–‡</a>ï¼šä¸‰å¯¹è§’æ–¹ç¨‹ä¸å¾ªç¯ä¸‰å¯¹è§’æ–¹ç¨‹æ•°å€¼è§£</p><p><strong>å¯¹ä»¥ä¸Šä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„è§£æï¼ˆChatGPTï¼‰ï¼š</strong></p><p>ä»çŸ©é˜µå½¢å¼æ¥çœ‹ï¼Œè¯¥æ–¹ç¨‹çš„ç³»æ•°çŸ©é˜µä¸º</p>$$
\begin{pmatrix}
2(T_0+T_1) & T_0 & 0 & \cdots & 0 \\
T_2 & 2(T_1+T_2) & T_1 & 0 & \cdots \\
0 & \ddots & \ddots & \ddots & 0 \\
\vdots & 0 & T_{n-2} & 2(T_{n-3}+T_{n-2}) & T_{n-3} \\
0 & \cdots & 0 & T_{n-1} & 2(T_{n-2}+T_{n-1})
\end{pmatrix}.
$$<p>å…¶ä¸­ï¼Œå¯¹äºç¬¬ $i$ è¡Œï¼ˆæŒ‰ç…§ $1 \le i \le n-1$ è®°æœªçŸ¥æ•° $v_1,\ldots,v_{n-1}$ï¼‰ï¼Œä¸»å¯¹è§’å…ƒä¸º</p>$$
b_i = 2(T_{i-1}+T_i)
$$<p>ï¼ˆæ³¨æ„ç¬¬ä¸€è¡Œç”¨ $T_0$ å’Œ $T_1$ï¼Œæœ€åä¸€è¡Œç”¨ $T_{n-2}$ å’Œ $T_{n-1}$ï¼‰ï¼Œè€Œéä¸»å¯¹è§’å…ƒåˆ†åˆ«ä¸º $a_i$ å’Œ $c_i$ï¼ˆå…·ä½“ä¸º $a_1$ ä¸å­˜åœ¨ï¼Œåç»­è¡Œçš„ä¸‹å¯¹è§’å…ƒå–è‡ªç›¸åº”çš„ $T$ å€¼ï¼Œç±»ä¼¼åœ°ä¸Šå¯¹è§’å…ƒï¼‰ã€‚</p><p>å¦‚æœæ‰€æœ‰çš„ $T_i$ éƒ½ä¸ºæ­£ï¼Œåˆ™å¯¹äºä»»æ„è¡Œéƒ½æœ‰</p>$$
b_i = 2(T_{i-1}+T_i) > T_{i-1}+T_i,
$$<p>ä¹Ÿå°±æ˜¯ä¸»å¯¹è§’å…ƒçš„ç»å¯¹å€¼ä¸¥æ ¼å¤§äºåŒä¸€è¡Œä¸­å…¶ä»–éé›¶ç³»æ•°ä¹‹å’Œï¼Œä»è€Œæ»¡è¶³ä¸¥æ ¼å¯¹è§’å ä¼˜çš„æ¡ä»¶ã€‚</p><p>å¦å¤–ï¼Œä»çŸ©é˜µçš„ç»“æ„æ¥çœ‹ï¼Œè¯¥çŸ©é˜µä»…åœ¨ä¸»å¯¹è§’åŠå…¶ä¸Šä¸‹å¯¹è§’ä¸Šæœ‰éé›¶å…ƒï¼Œå¹¶ä¸å«æœ‰â€œå¾ªç¯â€é¡¹ï¼ˆå³ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œä¹‹é—´æ— è€¦åˆï¼‰ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ä¸‰å¯¹è§’çŸ©é˜µã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼š</p><ul><li><strong>å¯¹è§’å ä¼˜æ€§</strong>ï¼šå½“ $T_i > 0$ æ—¶ï¼ŒçŸ©é˜µæ»¡è¶³ä¸¥æ ¼å¯¹è§’å ä¼˜æ¡ä»¶ã€‚</li><li><strong>æ±‚è§£æ–¹æ³•</strong>ï¼šç”±äºè¯¥çŸ©é˜µæ˜¯æ ‡å‡†çš„ä¸‰å¯¹è§’çŸ©é˜µï¼Œä¸”æ»¡è¶³å¯¹è§’å ä¼˜æ¡ä»¶ï¼Œå› æ­¤å¯ä»¥ç›´æ¥é‡‡ç”¨ Thomas ç®—æ³•ï¼ˆè¿½èµ¶æ³•ï¼‰æ¥æ±‚è§£è¿™ä¸€çº¿æ€§ç³»ç»Ÿã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ–¹ç¨‹å³ä¾§åŒ…å«äº†è¾¹ç•Œæ¡ä»¶ï¼ˆä¾‹å¦‚ $v_0$ å’Œ $v_n$ å·²çŸ¥ï¼‰ï¼Œè¿™äº›é€šå¸¸ä¼šåœ¨æ„é€ å³ä¾§å‘é‡æ—¶ä½“ç°å‡ºæ¥ï¼›è€Œå¾…æ±‚è§£çš„æœªçŸ¥æ•°ä¸º $v_1, v_2, \ldots, v_{n-1}$ã€‚</li></ul><p>å› æ­¤ï¼Œå¯¹äºä»¥ä¸Šç»™å‡ºçš„è¿™ä¸ªæ–¹ç¨‹ï¼Œå¦‚æœ $T_i$ ä¸ºæ­£ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ Thomas ç®—æ³•æ¥å¿«é€Ÿä¸”ç¨³å®šåœ°æ±‚è§£ã€‚</p><hr><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>clc;
</span></span><span style=display:flex><span>clear;
</span></span><span style=display:flex><span>close all;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>]<span style=color:#f92672>&#39;</span>; <span style=color:#75715e>%é€’å¢æ—¶é—´åºåˆ—</span>
</span></span><span style=display:flex><span>q = [<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>]<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>v0 = <span style=color:#ae81ff>2</span>; <span style=color:#75715e>%èµ·å§‹é€Ÿåº¦</span>
</span></span><span style=display:flex><span>vn = <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>; <span style=color:#75715e>%ç»“æŸé€Ÿåº¦</span>
</span></span><span style=display:flex><span>deltaT = <span style=color:#ae81ff>0.001</span>; <span style=color:#75715e>%æ’è¡¥å‘¨æœŸ</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n = length(t); <span style=color:#75715e>% n &gt;= 4</span>
</span></span><span style=display:flex><span>T = diff(t);
</span></span><span style=display:flex><span>a = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>b = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>c = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>d = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    a(i) = T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    b(i) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T(i) <span style=color:#f92672>+</span> T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    c(i) = T(i);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (T(<span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(<span style=color:#ae81ff>3</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>2</span>)) <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>2</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>))) <span style=color:#f92672>/</span> (T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>2</span>)) <span style=color:#f92672>-</span> T(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> v0;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>   d(i) = <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (T(i)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>+</span> T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i))) <span style=color:#f92672>/</span> (T(i) <span style=color:#f92672>*</span> T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>d(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) = <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(n) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>))) <span style=color:#f92672>/</span> (T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>-</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> vn;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[v, sta] = solve_tridiagonal_matrix_equation(a, b, c, d, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> sta <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    error(<span style=color:#e6db74>&#39;ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹æ±‚è§£å‡ºé”™!&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>v = [v0; v; vn];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>time = [];
</span></span><span style=display:flex><span>pos = [];
</span></span><span style=display:flex><span>vel = [];
</span></span><span style=display:flex><span>acc = [];
</span></span><span style=display:flex><span>time = [time; t(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>pos = [pos; q(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>vel = [vel; v0];
</span></span><span style=display:flex><span>acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> v(<span style=color:#ae81ff>2</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    tt = (t(i) <span style=color:#f92672>+</span> deltaT : deltaT : t(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>    b0 = q(i);
</span></span><span style=display:flex><span>    b1 = v(i);
</span></span><span style=display:flex><span>    b2 = (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v(i) <span style=color:#f92672>-</span> v(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i);
</span></span><span style=display:flex><span>    b3 = (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (q(i) <span style=color:#f92672>-</span> q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>+</span> v(i) <span style=color:#f92672>+</span> v(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i)^<span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    time = [time; tt];
</span></span><span style=display:flex><span>    pos = [pos; b0 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (b1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (b2 <span style=color:#f92672>+</span> b3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))))];
</span></span><span style=display:flex><span>    vel = [vel; b1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> b2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> b3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i)))];
</span></span><span style=display:flex><span>    acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> b2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> b3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> abs(time(<span style=color:#66d9ef>end</span>) <span style=color:#f92672>-</span> t(n)) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1.0e-8</span>
</span></span><span style=display:flex><span>    b2 = (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q(n) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> v(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    b3 = (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> v(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> v(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    time = [time; t(n)];
</span></span><span style=display:flex><span>    pos = [pos; q(n)];
</span></span><span style=display:flex><span>    vel = [vel; vn];
</span></span><span style=display:flex><span>    acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> b2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> b3 <span style=color:#f92672>.*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>figure(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>plot(time, pos);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot(t, q, <span style=color:#e6db74>&#39;ro&#39;</span>);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;pos&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>plot(time, vel);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot([t(<span style=color:#ae81ff>1</span>), t(n)], [v0, vn], <span style=color:#e6db74>&#39;ro&#39;</span>);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;vel&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>plot(time, acc);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;acc&#39;</span>)</span></span></code></pre></div><p><img src=https://cdn.mathpix.com/snip/images/lxebM-8nEo_GiZ-saOddPV0SHQ9bmvvIUDCLost6nwU.original.fullsize.png alt="fig y" width=500 style=height:auto></p><h4 id=åœ¨çº¿éªŒè¯è®¡ç®—å™¨>åœ¨çº¿éªŒè¯è®¡ç®—å™¨</h4><p>æ ¹æ®ä»¥ä¸Šç®—æ³•ï¼Œåˆ©ç”¨Claudeç”Ÿæˆä¸‰æ¬¡æ ·æ¡æ’å€¼<a href=https://claude.site/artifacts/a4a9a9ba-d1f0-452b-ae53-097ff36e880b rel=external target=_blank>åœ¨çº¿è®¡ç®—å™¨</a> ï¼ˆä»£ç æœ‰ç¼ºé™·ï¼Œæ’å€¼ç‚¹æ•°é‡æœ€å°ä¸º4ï¼Œå°äº4åŠ é€Ÿåº¦ä¸è¿ç»­ï¼‰ï¼Œå¯ç”¨äºä»£ç è°ƒè¯•æµ‹è¯•æ£€éªŒã€‚</p><img src=https://cdn.mathpix.com/snip/images/20pUfP72JQWsdOdlzFsP4YOeifCFZBpqz8tZweenejs.original.fullsize.png>
<img src=https://cdn.mathpix.com/snip/images/_Iwf0e1xv_AAwajTb1IOyqSHLDSc7K9b44mB3lQJcGE.original.fullsize.png><h3 id=2-ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—>2. ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—</h3><p>ç¬¬kæ®µä¸‰æ¬¡å¤šé¡¹å¼çš„åŠ é€Ÿåº¦ï¼š</p>$$
\ddot{\mathrm{q}}_{\mathrm{k}}(\mathrm{t})=\left[\omega_{\mathrm{k}+1}\left(\mathrm{t}-\mathrm{t}_{\mathrm{k}}\right)+\omega_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}-\mathrm{t}\right)\right] / \mathrm{T}_{\mathrm{k}} \tag{8}
$$<p>å…¶ä¸­ï¼Œ$\omega_{\mathrm{k}}$ ä¸º $\mathrm{t}_{\mathrm{k}}$ å¤„å¯¹åº”çš„åŠ é€Ÿåº¦ï¼Œ $\mathrm{k}=0,1, \ldots, \mathrm{n}$ ã€‚å¯¹ä¸Šå¼ç§¯åˆ†ï¼Œå¾—åˆ°é€Ÿåº¦ï¼š</p>$$
\begin{aligned}
\dot{\mathrm{q}}_{\mathrm{k}}(\mathrm{t})= & \omega_{\mathrm{k}+1}\left(\mathrm{t}-\mathrm{t}_{\mathrm{k}}\right)^2 /\left(2 \mathrm{~T}_{\mathrm{k}}\right)+\omega_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}+1}-\mathrm{t}\right)^2 /\left(2 \mathrm{~T}_{\mathrm{k}}\right) \\
& +\left(\mathrm{q}_{\mathrm{k}+1}-\mathrm{q}_{\mathrm{k}}\right) / \mathrm{T}_{\mathrm{k}}-\mathrm{T}_{\mathrm{k}}\left(\omega_{\mathrm{k}+1}-\omega_{\mathrm{k}}\right) / 6
\end{aligned} \tag{9}
$$<p>$\mathrm{t}_{\mathrm{k}}$ å¤„çš„é€Ÿåº¦ä¸åŠ é€Ÿåº¦çº¦æŸï¼š</p>$$
\left\{\begin{array}{l}
\dot{\mathrm{q}}_{\mathrm{k}-1}\left(\mathrm{t}_{\mathrm{k}}\right)=\dot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}}\right) \\
\ddot{\mathrm{q}}_{\mathrm{k}-1}\left(\mathrm{t}_{\mathrm{k}}\right)=\ddot{\mathrm{q}}_{\mathrm{k}}\left(\mathrm{t}_{\mathrm{k}}\right)=\omega_{\mathrm{k}}
\end{array}\right.\tag{10}
$$<p>ç”±å¼ï¼ˆ8ï¼‰ï¼ˆ9ï¼‰ï¼ˆ10ï¼‰å¾—ï¼š</p>$$
\begin{gathered}
\left(\mathrm{T}_{\mathrm{k}-1} / \mathrm{T}_{\mathrm{k}}\right) \omega_{\mathrm{k}-1}+\left[2\left(\mathrm{~T}_{\mathrm{k}}+\mathrm{T}_{\mathrm{k}-1}\right) / \mathrm{T}_{\mathrm{k}}\right] \omega_{\mathrm{k}}+\omega_{\mathrm{k}+1} \\
=\left(6 / \mathrm{T}_{\mathrm{k}}\right)\left[\left(\mathrm{q}_{\mathrm{k}+1}-\mathrm{q}_{\mathrm{k}}\right) / \mathrm{T}_{\mathrm{k}}-\left(\mathrm{q}_{\mathrm{k}}-\mathrm{q}_{\mathrm{k}-1}\right) / \mathrm{T}_{\mathrm{k}-1}\right], \mathrm{k}=1,2, \ldots, \mathrm{n}-1
\end{gathered} \tag{11}
$$<p>ç”± $\dot{s}\left(\mathrm{t}_0\right)=\mathrm{v}_0$ å¾—ï¼š</p>$$
\mathrm{T}_0^2 \omega_0 / 3+\mathrm{T}_0^2 \omega_1 / 6=\mathrm{q}_1-\mathrm{q}_0-\mathrm{T}_0 \mathrm{v}_0 \tag{12}
$$<p>ç”± $\dot{s}\left(\mathrm{t}_{\mathrm{n}}\right)=\mathrm{v}_{\mathrm{n}}$ å¾—ï¼š</p>$$
\mathrm{T}_{\mathrm{n}-1}^2 \omega_{\mathrm{n}} / 3+\mathrm{T}_{\mathrm{n}-1}^2 \omega_{\mathrm{n}-1} / 6=\mathrm{q}_{\mathrm{n}-1}-\mathrm{q}_{\mathrm{n}}+\mathrm{T}_{\mathrm{n}-1} \mathrm{v}_{\mathrm{n}} \tag{13}
$$<p>å°†å¼ï¼ˆ9ï¼‰ï¼ˆ12ï¼‰ï¼ˆ13ï¼‰å†™æˆçŸ©é˜µå½¢å¼ï¼š</p>$$
\mathrm{A} \omega=\mathrm{c} \tag{14}
$$<p>å…¶ä¸­ï¼š</p>$$
\mathrm{A}=\left[\begin{array}{ccccc}
2 \mathrm{~T}_0 & \mathrm{~T}_0 & 0 & \cdots & 0 \\
\mathrm{~T}_0 & 2\left(\mathrm{~T}_0+\mathrm{T}_1\right) & \mathrm{T}_1 & 0 & \vdots \\
0 & & \ddots & & 0 \\
\vdots & 0 & \mathrm{~T}_{\mathrm{n}-2} & 2\left(\mathrm{~T}_{\mathrm{n}-2}+\mathrm{T}_{\mathrm{n}-1}\right) & \mathrm{T}_{\mathrm{n}-1} \\
0 & \cdots & 0 & \mathrm{~T}_{\mathrm{n}-1} & 2 \mathrm{~T}_{\mathrm{n}-1}
\end{array}\right] \tag{15}
$$$$
\mathrm{c}=\left[\begin{array}{c}
6\left[\left(\mathrm{q}_1-\mathrm{q}_0\right) / \mathrm{T}_0-\mathrm{v}_0\right] \\
6\left[\left(\mathrm{q}_2-\mathrm{q}_1\right) / \mathrm{T}_1-\left(\mathrm{q}_1-\mathrm{q}_0\right) / \mathrm{T}_0\right] \\
\vdots \\
6\left[\left(\mathrm{q}_{\mathrm{n}}-\mathrm{q}_{\mathrm{n}-1}\right) / \mathrm{T}_{\mathrm{n}-1}-\left(\mathrm{q}_{\mathrm{n}-1}-\mathrm{q}_{\mathrm{n}-2}\right) / \mathrm{T}_{\mathrm{n}-2}\right] \\
6\left[\mathrm{v}_{\mathrm{n}}-\left(\mathrm{q}_{\mathrm{n}}-\mathrm{q}_{\mathrm{n}-1}\right) / \mathrm{T}_{\mathrm{n}-1}\right]
\end{array}\right] \tag{16}
$$<p>æ±‚å¾— $\omega$ ï¼Œå³å¯è®¡ç®—æ ·æ¡çš„ç³»æ•°ï¼š</p>$$
\left\{\begin{array}{l}
\mathrm{a}_{\mathrm{k} 0}=\mathrm{q}_{\mathrm{k}} \\
\mathrm{a}_{\mathrm{k} 1}=\left(\mathrm{q}_{\mathrm{k}+1}-\mathrm{q}_{\mathrm{k}}\right) / \mathrm{T}_{\mathrm{k}}-\mathrm{T}_{\mathrm{k}}\left(\omega_{\mathrm{k}+1}+2 \omega_{\mathrm{k}}\right) / 6 \\
\mathrm{a}_{\mathrm{k} 2}=\omega_{\mathrm{k}} / 2 \\
\mathrm{a}_{\mathrm{k} 3}=\left(\omega_{\mathrm{k}+1}-\omega_{\mathrm{k}}\right) /\left(6 \mathrm{~T}_{\mathrm{k}}\right)
\end{array}\right. \tag{17}
$$<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>clc;
</span></span><span style=display:flex><span>clear;
</span></span><span style=display:flex><span>close all;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>]<span style=color:#f92672>&#39;</span>; <span style=color:#75715e>%é€’å¢æ—¶é—´åºåˆ—</span>
</span></span><span style=display:flex><span>q = [<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>]<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>v0 = <span style=color:#ae81ff>2</span>; <span style=color:#75715e>%èµ·å§‹é€Ÿåº¦</span>
</span></span><span style=display:flex><span>vn = <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>; <span style=color:#75715e>%ç»“æŸé€Ÿåº¦</span>
</span></span><span style=display:flex><span>deltaT = <span style=color:#ae81ff>0.001</span>; <span style=color:#75715e>%æ’è¡¥å‘¨æœŸ</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n = length(t); <span style=color:#75715e>% n &gt;= 4</span>
</span></span><span style=display:flex><span>T = diff(t);
</span></span><span style=display:flex><span>a = zeros(n, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>b = zeros(n, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>c = zeros(n, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>d = zeros(n, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    a(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) = T(i);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    b(i) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> T(i));
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>b(n) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    c(i) = T(i);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> v0);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>   d(i) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>-</span> (q(i) <span style=color:#f92672>-</span> q(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>d(n) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> (vn <span style=color:#f92672>-</span> (q(n) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[w, sta] = solve_tridiagonal_matrix_equation(a, b, c, d, n);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> sta <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    error(<span style=color:#e6db74>&#39;ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹æ±‚è§£å‡ºé”™!&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>time = [];
</span></span><span style=display:flex><span>pos = [];
</span></span><span style=display:flex><span>vel = [];
</span></span><span style=display:flex><span>acc = [];
</span></span><span style=display:flex><span>time = [time; t(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>pos = [pos; q(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>vel = [vel; v0];
</span></span><span style=display:flex><span>acc = [acc; w(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    tt = (t(i) <span style=color:#f92672>+</span> deltaT : deltaT : t(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>    a0 = q(i);
</span></span><span style=display:flex><span>    a1 = (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>-</span> T(i) <span style=color:#f92672>*</span> (w(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> w(i)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>    a2 = <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> w(i);
</span></span><span style=display:flex><span>    a3 = (w(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> w(i)) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> T(i));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    time = [time; tt];
</span></span><span style=display:flex><span>    pos = [pos; a0 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (a1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (a2 <span style=color:#f92672>+</span> a3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))))];
</span></span><span style=display:flex><span>    vel = [vel; a1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> a2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> a3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i)))];
</span></span><span style=display:flex><span>    acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> a2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> a3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> abs(time(<span style=color:#66d9ef>end</span>) <span style=color:#f92672>-</span> t(n)) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1.0e-8</span>
</span></span><span style=display:flex><span>    time = [time; t(n)];
</span></span><span style=display:flex><span>    pos = [pos; q(n)];
</span></span><span style=display:flex><span>    vel = [vel; vn];
</span></span><span style=display:flex><span>    acc = [acc; w(n)];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>figure(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>plot(time, pos);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot(t, q, <span style=color:#e6db74>&#39;ro&#39;</span>);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;pos&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>plot(time, vel);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;vel&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>plot(time, acc);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;acc&#39;</span>)</span></span></code></pre></div><p><img src=https://cdn.mathpix.com/snip/images/Ho-0Tp3Be9-KCEtLgRZ_O1vW4QahJPGUYGkcZVD0_2k.original.fullsize.png alt="fig x" width=500 style=height:auto></p><h3 id=3ä¸¤ç§è®¡ç®—æ–¹æ³•çš„æ¯”è¾ƒ>3ã€ä¸¤ç§è®¡ç®—æ–¹æ³•çš„æ¯”è¾ƒ</h3><p>By ChatGPT</p><p>è¿™ä¸¤ç§æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºä½ é€‰æ‹©äº†å“ªä¸€ç±»èŠ‚ç‚¹ä¿¡æ¯ä½œä¸ºä¸»è¦çš„æœªçŸ¥é‡ï¼Œä»è€Œå¯¼è‡´äº†å»ºç«‹è¿ç»­æ€§çº¦æŸæ—¶çš„æ–¹ç¨‹å½¢å¼ä¸åŒï¼Œå…·ä½“æ¥è¯´ï¼š</p><ol><li><p><strong>åŸºäºé€Ÿåº¦æ±‚è§£ï¼ˆé€šè¿‡é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡ç³»æ•°ï¼‰ï¼š</strong></p><ul><li><strong>æœªçŸ¥é‡é€‰å–</strong>ï¼šæŠŠå„åˆ†æ®µè¿æ¥å¤„çš„é€Ÿåº¦ï¼ˆå³ä¸€é˜¶å¯¼æ•°ï¼‰ä½œä¸ºä¸»è¦æœªçŸ¥é‡ï¼ˆå·²çŸ¥èµ·å§‹é€Ÿåº¦ $v_0$ å’Œç»“æŸé€Ÿåº¦ $v_n$ï¼Œä¸­é—´é€Ÿåº¦ $v_1, v_2, \ldots, v_{n-1}$ å¾…æ±‚ï¼‰ã€‚</li><li><strong>æ„é€ çº¦æŸæ¡ä»¶</strong>ï¼šåˆ©ç”¨ä½ç½®è¿ç»­ã€é€Ÿåº¦è¿ç»­å’ŒåŠ é€Ÿåº¦è¿ç»­æ¡ä»¶ï¼Œåˆ©ç”¨æ¯æ®µå¤šé¡¹å¼åœ¨èµ·ç‚¹å’Œç»ˆç‚¹å¤„å¿…é¡»æ»¡è¶³ä½ç½®å’Œä¸€é˜¶å¯¼æ•°çš„åŒ¹é…ï¼Œä»è€Œå¯ä»¥ç”¨å…¬å¼ï¼ˆ3ï¼‰æ¨å¯¼å‡ºæ¯æ®µçš„ç³»æ•°ï¼Œå¹¶ä¸”åˆ©ç”¨ç›¸é‚»æ®µåœ¨è¿æ¥å¤„åŠ é€Ÿåº¦çš„è¿ç»­æ€§ï¼ˆå…¬å¼ï¼ˆ5ï¼‰ï¼‰å¾—åˆ°ä¸€ä¸ªå…³äºä¸­é—´é€Ÿåº¦çš„ä¸‰å¯¹è§’çº¿æ€§ç³»ç»Ÿï¼ˆå…¬å¼ï¼ˆ6ï¼‰å’ŒçŸ©é˜µå½¢å¼ï¼ˆ7ï¼‰ï¼‰ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šå½“ä½ èƒ½è¾ƒå¥½åœ°ä¼°è®¡æˆ–ç»™å‡ºè¾¹ç•Œé€Ÿåº¦æ—¶ï¼Œç›´æ¥ä»¥é€Ÿåº¦ä½œä¸ºæœªçŸ¥é‡å¯ä»¥æ¯”è¾ƒç›´è§‚åœ°æ§åˆ¶æ›²çº¿çš„æ–œç‡ï¼ˆæ–¹å‘ï¼‰ï¼Œè®¡ç®—è¿‡ç¨‹ç®€å•ï¼Œæ„é€ çš„ä¸‰å¯¹è§’ç³»ç»Ÿç»“æ„ä¹Ÿç›¸å¯¹ç®€å•ã€‚</li></ul></li><li><p><strong>åŸºäºåŠ é€Ÿåº¦æ±‚è§£ï¼ˆé€šè¿‡åŠ é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡ç³»æ•°ï¼‰ï¼š</strong></p><ul><li><strong>æœªçŸ¥é‡é€‰å–</strong>ï¼šå°†å„èŠ‚ç‚¹å¤„çš„åŠ é€Ÿåº¦ï¼ˆå³äºŒé˜¶å¯¼æ•°ï¼‰ä½œä¸ºä¸»è¦æœªçŸ¥é‡ï¼ˆåœ¨èŠ‚ç‚¹å¤„çš„åŠ é€Ÿåº¦ $ \omega_0, \omega_1, \ldots, \omega_n $ ä¸­ï¼Œé€šå¸¸ç»™å‡ºè¾¹ç•ŒåŠ é€Ÿåº¦ï¼Œè€Œä¸­é—´çš„å¾…æ±‚ï¼‰ã€‚</li><li><strong>æ„é€ çº¦æŸæ¡ä»¶</strong>ï¼šé¦–å…ˆå‡è®¾æ¯æ®µå†…åŠ é€Ÿåº¦åœ¨åŒºé—´ä¸Šçº¿æ€§å˜åŒ–ï¼ˆå…¬å¼ï¼ˆ8ï¼‰ï¼‰ï¼Œç„¶åç§¯åˆ†å¾—åˆ°é€Ÿåº¦ï¼ˆå…¬å¼ï¼ˆ9ï¼‰ï¼‰å’Œä½ç½®ï¼Œæ¥ç€åˆ©ç”¨è¿æ¥ç‚¹å¤„çš„é€Ÿåº¦è¿ç»­æ€§ä»¥åŠåŠ é€Ÿåº¦åœ¨èŠ‚ç‚¹å¤„çš„å®šä¹‰ï¼ˆå…¬å¼ï¼ˆ10ï¼‰ï¼‰æ„é€ æ–¹ç¨‹ï¼Œå†åŠ ä¸Šç«¯ç‚¹å¤„ç”±ç»™å®šè¾¹ç•Œæ¡ä»¶ï¼ˆå…¬å¼ï¼ˆ12ï¼‰å’Œï¼ˆ13ï¼‰ï¼‰æ¨å¯¼å‡ºçš„é™„åŠ å…³ç³»ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå…³äºåŠ é€Ÿåº¦çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼ˆå…¬å¼ï¼ˆ14ï¼‰ä¸­ $A$ ä¸ $c$ çš„æ„é€ ï¼‰ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šè¿™ç§æ–¹æ³•æŠŠé‡ç‚¹æ”¾åœ¨äº†æ›²çº¿çš„æ›²ç‡ï¼ˆåŠ é€Ÿåº¦ï¼‰ä¸Šï¼Œèƒ½å¤Ÿæ›´è‡ªç„¶åœ°åæ˜ æ›²çº¿çš„å¼¯æ›²æ€§è´¨ï¼ŒåŒæ—¶å…è®¸åœ¨æ›²çº¿ç«¯ç‚¹åŒæ—¶ç»™å®šé€Ÿåº¦å’ŒåŠ é€Ÿåº¦ï¼ˆä¸ºæ­¤é€šå¸¸éœ€è¦é€šè¿‡æ’å…¥é¢å¤–çš„è¾…åŠ©ç‚¹æ¥æ„é€ åˆé€‚çš„èŠ‚ç‚¹åºåˆ—ï¼‰ã€‚</li><li><strong>ä¼˜ç‚¹ä¸åº”ç”¨</strong>ï¼šåœ¨æŸäº›åº”ç”¨ä¸­ï¼ˆæ¯”å¦‚éœ€è¦æ§åˆ¶è¿åŠ¨çš„å¹³æ»‘æ€§æˆ–å—åŠ›åˆ†æï¼‰ï¼ŒåŠ é€Ÿåº¦ä¿¡æ¯å¯èƒ½æ›´ä¸ºå…³é”®ï¼›å¦å¤–ï¼Œå¦‚æœä½ å¸Œæœ›æ˜ç¡®åœ°çº¦æŸæ›²ç‡å˜åŒ–ï¼Œé‚£ä¹ˆä½¿ç”¨åŠ é€Ÿåº¦ä½œä¸ºæœªçŸ¥é‡æ›´ç›´è§‚ã€‚</li></ul></li></ol><p><strong>æ€»ç»“å¯¹æ¯”ï¼š</strong></p><ul><li><p><strong>æœªçŸ¥é‡çš„ä¸åŒ</strong>ï¼š</p><ul><li>é€Ÿåº¦æ³•ï¼šä»¥ä¸­é—´èŠ‚ç‚¹çš„é€Ÿåº¦ $v_1,\ldots,v_{n-1}$ ä¸ºæœªçŸ¥é‡ï¼›</li><li>åŠ é€Ÿåº¦æ³•ï¼šä»¥èŠ‚ç‚¹å¤„çš„åŠ é€Ÿåº¦ $\omega_0, \omega_1, \ldots, \omega_n$ ä¸ºæœªçŸ¥é‡ï¼ˆä¸ºåŒæ—¶æ»¡è¶³ç»™å®šçš„ç«¯ç‚¹é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ï¼Œéœ€è¦åœ¨ç¬¬ä¸€æ®µå’Œæœ€åä¸€æ®µæ’å…¥è¾…åŠ©èŠ‚ç‚¹ï¼‰ã€‚</li></ul></li><li><p><strong>æ„é€ æ–¹ç¨‹çš„ä¸åŒ</strong>ï¼š</p><ul><li>é€Ÿåº¦æ³•ç›´æ¥åˆ©ç”¨ä½ç½®ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çš„è¿ç»­æ€§å¾—åˆ°å…³äºé€Ÿåº¦çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼›</li><li>åŠ é€Ÿåº¦æ³•åˆ™å…ˆå‡å®šåŠ é€Ÿåº¦åœ¨æ¯æ®µå†…å‘ˆçº¿æ€§å˜åŒ–ï¼Œé€šè¿‡ç§¯åˆ†æ„é€ é€Ÿåº¦ä¸ä½ç½®è¡¨è¾¾å¼ï¼Œå†åˆ©ç”¨è¿ç»­æ€§æ¡ä»¶å»ºç«‹å…³äºåŠ é€Ÿåº¦çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼Œå…¶ç³»æ•°è¡¨è¾¾å¼ä¸­ä¼šæ¶‰åŠåˆ°æ—¶é—´é—´éš”çš„æ¯”å€¼ç­‰æ›´å¤æ‚çš„å½¢å¼ã€‚</li></ul></li><li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>å¦‚æœåªç»™å®šè¾¹ç•Œé€Ÿåº¦ï¼Œä¸”ä½ å¯¹ä¸­é—´ç‚¹çš„é€Ÿåº¦æ²¡æœ‰é¢å¤–è¦æ±‚ï¼Œé€Ÿåº¦æ³•è¾ƒä¸ºç®€å•é«˜æ•ˆï¼›</li><li>å¦‚æœå¸Œæœ›åœ¨ç«¯ç‚¹åŒæ—¶çº¦æŸé€Ÿåº¦å’ŒåŠ é€Ÿåº¦ï¼Œæˆ–è€…å¯¹æ›²çº¿çš„å¼¯æ›²ï¼ˆæ›²ç‡ï¼‰è¦æ±‚æ›´é«˜ï¼Œåˆ™éœ€è¦é‡‡ç”¨åŠ é€Ÿåº¦æ³•ï¼ˆå¹¶ä¸”é€šå¸¸éœ€è¦æ’å…¥è¾…åŠ©èŠ‚ç‚¹ä»¥æ¶ˆé™¤è¿‡å®šæ€§ï¼‰ã€‚</li></ul></li></ul><p>å› æ­¤ï¼Œä¸¤ç§æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº†ç›¸åŒçš„æ ·æ¡è¿ç»­æ€§è¦æ±‚ï¼Œä½†ä¾§é‡ç‚¹ä¸åŒï¼šä¸€ç§ä¾§é‡äºæ§åˆ¶ä¸€é˜¶å¯¼æ•°ï¼ˆæ–œç‡ï¼‰ï¼Œå¦ä¸€ç§ä¾§é‡äºæ§åˆ¶äºŒé˜¶å¯¼æ•°ï¼ˆæ›²ç‡ï¼‰ï¼Œè¿™ç›´æ¥å½±å“äº†æ‰€æ„é€ çš„æ–¹ç¨‹å½¢å¼ä»¥åŠæœ€ç»ˆæ±‚å¾—çš„æ ·æ¡æ›²çº¿çš„æ€§è´¨ã€‚</p><h2 id=ä¸‰ç»™å®šçº¦æŸå‘¨æœŸä¸‰æ¬¡æ ·æ¡>ä¸‰ã€ç»™å®šçº¦æŸï¼šå‘¨æœŸä¸‰æ¬¡æ ·æ¡</h2><p>å‘¨æœŸä¸‰æ¬¡æ ·æ¡ä¸ºèµ·å§‹ä½ç½® $q_0$ ä¸ç»“æŸä½ç½® $q_n$ ç›¸ç­‰ï¼ˆæ•°æ®éœ€æ»¡è¶³çš„ç‰¹æ€§ï¼Œéç®—æ³•çº¦æŸæ¡ä»¶ï¼‰ï¼Œèµ·å§‹é€Ÿåº¦ $v_0$ ä¸ç»“æŸé€Ÿåº¦ $v_n$ ç›¸ç­‰ï¼Œèµ·å§‹åŠ é€Ÿåº¦ $\mathrm{a}_0$ ä¸ç»“æŸåŠ é€Ÿåº¦ $\mathrm{a}_{\mathrm{n}}$ ç›¸ç­‰ã€‚</p><p>å¯¹äºå‘¨æœŸä¸‰æ¬¡æ ·æ¡ï¼Œèµ·å§‹é€Ÿåº¦ $v_0$ ï¼Œç»“æŸé€Ÿåº¦ $v_n$ ï¼Œèµ·å§‹åŠ é€Ÿåº¦ $a_0$ ï¼Œç»“æŸåŠ é€Ÿåº¦ $a_n$ ä¸å¯ä»¥ä»»æ„æŒ‡å®šï¼Œéœ€æ»¡è¶³çº¦æŸï¼š</p>$$
\mathrm{v}_0=\dot{\mathrm{q}}_0\left(\mathrm{t}_0\right)=\dot{\mathrm{q}}_{\mathrm{n}-1}\left(\mathrm{t}_{\mathrm{n}}\right)=\mathrm{v}_{\mathrm{n}} \tag{18}
$$$$
\ddot{\mathrm{q}}_0\left(\mathrm{t}_0\right)=2 \mathrm{a}_{0,2}=2 \mathrm{a}_{\mathrm{n}-1,2}+6 \mathrm{a}_{\mathrm{n}-1,3} \mathrm{~T}_{\mathrm{n}-1}=\ddot{\mathrm{q}}_{\mathrm{n}-1}\left(\mathrm{t}_{\mathrm{n}}\right) \tag{19}
$$<p>ç»“åˆå¼ï¼ˆ4ï¼‰ï¼ˆ7ï¼‰å¯å¾—çŸ©é˜µæ–¹ç¨‹ï¼š</p>$$
\begin{gathered}
{\left[\begin{array}{cccccc}
2\left(\mathrm{~T}_{\mathrm{n}-1}+\mathrm{T}_0\right) & \mathrm{T}_{\mathrm{n}-1} & 0 & \cdots & 0 & \mathrm{~T}_0 \\
\mathrm{~T}_1 & 2\left(\mathrm{~T}_0+\mathrm{T}_1\right) & \mathrm{T}_0 & 0 & \vdots & 0 \\
0 & & \ddots & & \vdots \\
\vdots & 0 & & \mathrm{~T}_{\mathrm{n}-2} & 2\left(\mathrm{~T}_{\mathrm{n}-3}+\mathrm{T}_{\mathrm{n}-2}\right) & \mathrm{T}_{\mathrm{n}-3} \\
\mathrm{~T}_{\mathrm{n}-2} & 0 & \cdots & 0 & \mathrm{~T}_{\mathrm{n}-1} \\
0 & 2\left(\mathrm{~T}_{\mathrm{n}-2}+\mathrm{T}_{\mathrm{n}-1}\right)
\end{array}\right]\left[\begin{array}{c}
\mathrm{v}_0 \\
\mathrm{v}_1 \\
\mathrm{v}_2 \\
\vdots \\
\mathrm{v}_{\mathrm{n}-2} \\
\mathrm{v}_{\mathrm{n}-1}
\end{array}\right]} \\
\quad=\left[\begin{array}{c}
3\left[\mathrm{~T}_{\mathrm{n}-1}^2\left(\mathrm{q}_1-\mathrm{q}_0\right)+\mathrm{T}_0^2\left(\mathrm{q}_{\mathrm{n}-1}-\mathrm{q}_{\mathrm{n}-2}\right)\right] /\left(\mathrm{T}_{\mathrm{n}-1} \mathrm{~T}_0\right) \\
3\left[\mathrm{~T}_0^2\left(\mathrm{q}_2-\mathrm{q}_1\right)+\mathrm{T}_1^2\left(\mathrm{q}_1-\mathrm{q}_0\right)\right] /\left(\mathrm{T}_0 \mathrm{~T}_1\right) \\
3\left[\mathrm{~T}_1^2\left(\mathrm{q}_3-\mathrm{q}_2\right)+\mathrm{T}_2^2\left(\mathrm{q}_2-\mathrm{q}_1\right)\right] /\left(\mathrm{T}_1 \mathrm{~T}_2\right) \\
\vdots \\
3\left[\mathrm{~T}_{\mathrm{n}-3}^2 3\left(\mathrm{q}_{\mathrm{n}-1}-\mathrm{q}_{\mathrm{n}-2}\right)+\mathrm{T}_{\mathrm{n}-2}^2\left(\mathrm{q}_{\mathrm{n}-2}-\mathrm{q}_{\mathrm{n}-3}\right)\right] /\left(\mathrm{T}_{\mathrm{n}-3} \mathrm{~T}_{\mathrm{n}-2}\right) \\
3\left[\mathrm{~T}_{\mathrm{n}-2}^2\left(\mathrm{q}_{\mathrm{n}}-\mathrm{q}_{\mathrm{n}-1}\right)+\mathrm{T}_{\mathrm{n}-1}^2\left(\mathrm{q}_{\mathrm{n}-1}-\mathrm{q}_{\mathrm{n}-2}\right)\right] /\left(\mathrm{T}_{\mathrm{n}-2} \mathrm{~T}_{\mathrm{n}-1}\right)
\end{array}\right]
\end{gathered} \tag{20}
$$<p>å¼ï¼ˆ20ï¼‰ä¸ºå¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹ï¼Œå¯ä»¥åˆ©ç”¨Shermanï¼Morrison å…¬å¼å¿«é€Ÿä¸”ç¨³å®šåœ°æ±‚è§£ï¼Œè€Œæ— éœ€æ±‚è§£çŸ©é˜µçš„é€†ã€‚å‚è€ƒé™„å½•ä¸€ï¼šä¸‰å¯¹è§’æ–¹ç¨‹ä¸å¾ªç¯ä¸‰å¯¹è§’æ–¹ç¨‹æ•°å€¼è§£</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>clc;
</span></span><span style=display:flex><span>clear;
</span></span><span style=display:flex><span>close all;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>]<span style=color:#f92672>&#39;</span>; <span style=color:#75715e>%é€’å¢æ—¶é—´åºåˆ—</span>
</span></span><span style=display:flex><span>q = [<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>3</span>]<span style=color:#f92672>&#39;</span>; <span style=color:#75715e>%é¦–å°¾æ•°æ®ä¸€è‡´</span>
</span></span><span style=display:flex><span>deltaT = <span style=color:#ae81ff>0.001</span>; <span style=color:#75715e>%æ’è¡¥å‘¨æœŸ</span>
</span></span><span style=display:flex><span>forwardPeriodCount = <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>backwardPeriodCount = <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n = length(t);
</span></span><span style=display:flex><span>T = diff(t);
</span></span><span style=display:flex><span>a = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>b = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>c = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>d = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a(<span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) = T(<span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    b(i) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> T(i));
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c(<span style=color:#ae81ff>1</span>) = T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    c(i) = T(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>c(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) = T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(n) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))) <span style=color:#f92672>/</span> (T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    d(i) = <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (T(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>+</span> T(i)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (q(i) <span style=color:#f92672>-</span> q(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))) <span style=color:#f92672>/</span> (T(i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> T(i));
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[v, sta] = solve_cyclic_tridiagonal_matrix_equation(a, b, c, d, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> sta <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    error(<span style=color:#e6db74>&#39;å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹æ±‚è§£å‡ºé”™!&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>v = [v; v(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>time = [];
</span></span><span style=display:flex><span>pos = [];
</span></span><span style=display:flex><span>vel = [];
</span></span><span style=display:flex><span>acc = [];
</span></span><span style=display:flex><span>time = [time; t(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>pos = [pos; q(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>vel = [vel; v(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> v(<span style=color:#ae81ff>2</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    tt = (t(i) <span style=color:#f92672>+</span> deltaT : deltaT : t(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>    a0 = q(i);
</span></span><span style=display:flex><span>    a1 = v(i);
</span></span><span style=display:flex><span>    a2 = (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v(i) <span style=color:#f92672>-</span> v(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i);
</span></span><span style=display:flex><span>    a3 = (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (q(i) <span style=color:#f92672>-</span> q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>+</span> v(i) <span style=color:#f92672>+</span> v(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i)^<span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    time = [time; tt];
</span></span><span style=display:flex><span>    pos = [pos; a0 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (a1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (a2 <span style=color:#f92672>+</span> a3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))))];
</span></span><span style=display:flex><span>    vel = [vel; a1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> a2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> a3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i)))];
</span></span><span style=display:flex><span>    acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> a2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> a3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> abs(time(<span style=color:#66d9ef>end</span>) <span style=color:#f92672>-</span> t(n)) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1.0e-8</span>
</span></span><span style=display:flex><span>    a2 = (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q(n) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> v(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    a3 = (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> v(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> v(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    time = [time; t(n)];
</span></span><span style=display:flex><span>    pos = [pos; q(n)];
</span></span><span style=display:flex><span>    vel = [vel; v(n)];
</span></span><span style=display:flex><span>    acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> a2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> a3 <span style=color:#f92672>.*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>period = time(<span style=color:#66d9ef>end</span>) <span style=color:#f92672>-</span> time(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>figure(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>plot(time, pos, <span style=color:#e6db74>&#39;k&#39;</span>);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot(t, q, <span style=color:#e6db74>&#39;ko&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : forwardPeriodCount
</span></span><span style=display:flex><span>    plot(time <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> period, pos, <span style=color:#e6db74>&#39;--&#39;</span>);
</span></span><span style=display:flex><span>    plot(t <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> period, q, <span style=color:#e6db74>&#39;bo&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : backwardPeriodCount
</span></span><span style=display:flex><span>    plot(time <span style=color:#f92672>-</span> i <span style=color:#f92672>*</span> period, pos, <span style=color:#e6db74>&#39;--&#39;</span>);
</span></span><span style=display:flex><span>    plot(t <span style=color:#f92672>-</span> i <span style=color:#f92672>*</span> period, q, <span style=color:#e6db74>&#39;bo&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;pos&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>plot(time, vel, <span style=color:#e6db74>&#39;k&#39;</span>);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : forwardPeriodCount
</span></span><span style=display:flex><span>    plot(time <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> period, vel, <span style=color:#e6db74>&#39;--&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : backwardPeriodCount
</span></span><span style=display:flex><span>    plot(time <span style=color:#f92672>-</span> i <span style=color:#f92672>*</span> period, vel, <span style=color:#e6db74>&#39;--&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;vel&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>plot(time, acc, <span style=color:#e6db74>&#39;k&#39;</span>);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : forwardPeriodCount
</span></span><span style=display:flex><span>    plot(time <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> period, acc, <span style=color:#e6db74>&#39;--&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : backwardPeriodCount
</span></span><span style=display:flex><span>    plot(time <span style=color:#f92672>-</span> i <span style=color:#f92672>*</span> period, acc, <span style=color:#e6db74>&#39;--&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;acc&#39;</span>)</span></span></code></pre></div><p><img src=https://cdn.mathpix.com/snip/images/3rovKvFqWLEv_gTpFPGyi-WAIYT1MMWTKoniFPMmkAc.original.fullsize.png alt="fig z" width=500 style=height:auto></p><h2 id=å››ç»™å®šçº¦æŸç»™å®šèµ·å§‹é€Ÿåº¦--ç»“æŸé€Ÿåº¦--èµ·å§‹åŠ é€Ÿåº¦--ç»“æŸåŠ é€Ÿåº¦>å››ã€ç»™å®šçº¦æŸï¼šç»™å®šèµ·å§‹é€Ÿåº¦ $\mathrm{v}_0$ ã€ç»“æŸé€Ÿåº¦ $\mathrm{v}_{\mathrm{n}}$ ï¼Œèµ·å§‹åŠ é€Ÿåº¦ $\mathrm{a}_0$ ã€ç»“æŸåŠ é€Ÿåº¦ $\mathrm{a}_{\mathrm{n}}$</h2><p>å¯¹äºä¸‰æ¬¡æ ·æ¡ï¼Œä¸€èˆ¬æ— æ³•åŒæ—¶æŒ‡å®šèµ·å§‹é€Ÿåº¦ä¸åŠ é€Ÿåº¦ï¼Œç»“æŸé€Ÿåº¦ä¸åŠ é€Ÿåº¦ã€‚ç„¶è€Œå¯ä»¥é€šè¿‡åœ¨ç¬¬ä¸€æ®µä»¥åŠæœ€åä¸€æ®µæ ·æ¡æ’å…¥ä¸¤ä¸ªé¢å¤–ç‚¹ä»¥å®ç°ã€‚å‡è®¾æ ·æ¡æ’å€¼æœ‰ $\mathrm{n}-1$ ä¸ªç‚¹åºåˆ—ï¼š</p>$$
\left\{\begin{array}{l}
\mathbf{t}=\left[\mathrm{t}_0, \mathrm{t}_2, \mathrm{t}_3, \ldots, \mathrm{t}_{\mathrm{n}-3}, \mathrm{t}_{\mathrm{n}-2}, \mathrm{t}_{\mathrm{n}}\right]^{\mathrm{T}} \\
\boldsymbol{q}=\left[\begin{array}{lllllll}
q_0, & q_2, & q_3, & \ldots & q_{n-3}, & q_{n-2}, & q_n
\end{array}\right]^T
\end{array}\right. \tag{21}
$$<p>åœ¨ç¬¬ä¸€æ®µä»¥åŠæœ€åä¸€æ®µæ ·æ¡æ’å…¥ä¸¤ä¸ªé¢å¤–ç‚¹ï¼š$\left(\overline{\mathrm{t}}_1, \overline{\mathrm{q}}_1\right),\left(\overline{\mathrm{t}}_{\mathrm{n}-1}, \overline{\mathrm{q}}_{\mathrm{n}-1}\right)$ ï¼Œä¸å¦¨å–å…¶ä¸ºç›¸é‚»ä¸¤ä¸ªç‚¹çš„ä¸­ç‚¹ã€‚æ–°çš„ç‚¹åºåˆ—ï¼š</p>$$
\left\{\begin{array}{l}
\overline{\mathbf{t}}=\left[\mathrm{t}_0, \overline{\mathrm{t}}_1, \mathrm{t}_2, \mathrm{t}_3, \ldots, \mathrm{t}_{\mathrm{n}-3}, \mathrm{t}_{\mathrm{n}-2}, \overline{\mathrm{t}}_{\mathrm{n}-1}, \mathrm{t}_{\mathrm{n}}\right]^{\mathrm{T}} \\
\overline{\mathbf{q}}=\left[\mathrm{q}_0, \overline{\mathrm{q}}_1, \mathrm{q}_2, \mathrm{q}_3, \ldots, \mathrm{q}_{\mathrm{n}-3}, \mathrm{q}_{\mathrm{n}-2}, \overline{\mathrm{q}}_{\mathrm{n}-1}, \mathrm{q}_{\mathrm{n}}\right]^{\mathrm{T}}
\end{array}\right. \tag{22}
$$<p>æ ¹æ®å¼ï¼ˆ12ï¼‰ï¼ˆ13ï¼‰å¯å¾—ï¼š</p>$$
\left\{\begin{array}{l}
\mathrm{q}_1=\mathrm{q}_0+\mathrm{T}_0 \mathrm{v}_0+\mathrm{T}_0^2 \mathrm{a}_0 / 3+\mathrm{T}_0^2 \omega_1 / 6 \\
\mathrm{q}_{\mathrm{n}-1}=\mathrm{q}_{\mathrm{n}}-\mathrm{T}_{\mathrm{n}-1} \mathrm{v}_{\mathrm{n}}+\mathrm{T}_{\mathrm{n}-1}^2 \mathrm{a}_{\mathrm{n}} / 3+\mathrm{T}_{\mathrm{n}-1}^2 \omega_{\mathrm{n}-1} / 6
\end{array}\right. \tag{23}
$$<p>æ ¹æ®å¼ï¼ˆ15ï¼‰ï¼ˆ16ï¼‰ï¼ˆ23ï¼‰å¯å¾—çŸ©é˜µæ–¹ç¨‹ï¼š</p>$$
\mathrm{A} \omega=\mathrm{c} \tag{24}
$$<p>å…¶ä¸­ï¼š</p>$$
\boldsymbol{A}=\left[\begin{array}{ccccc}
2 T_1+T_0\left(3+\frac{T_0}{T_1}\right) & T_1 & 0 & \cdots & \\
T_1-\frac{T_0^2}{T_1} & 2\left(T_1+T_2\right) & T_2 & & 0 \\
0 & T_2 & 2\left(T_2+T_3\right) & T_3 & \\
\vdots & \vdots & & \\
\vdots & & T_{n-3} & 2\left(T_{n-3}+T_{n-2}\right) & T_{n-2}-\frac{T_n^2}{T_{n-1}} \\
0 & \cdots & 0 & T_{n-2} & 2 T_{n-2}+T_{n-1}\left(3+\frac{T_n-1}{T_{n-2}}\right.
\end{array}\right] \tag{25}
$$$$
c=\left[\begin{array}{c}
6\left(\frac{q_2-q_0}{T_1}-\mathrm{v}_0\left(1+\frac{T_0}{T_1}\right)-\mathrm{a}_0\left(\frac{1}{2}+\frac{T_0}{3 T_1}\right) T_0\right) \\
6\left(\frac{q_3-q_2}{T_2}-\frac{q_2-q_0}{T_1}+\mathrm{v}_0 \frac{T_0}{T_1}+\mathrm{a}_0 \frac{T_0^2}{3 T_1}\right) \\
6\left(\frac{q_4-q_3}{T_3}-\frac{q_3-q_2}{T_2}\right) \\
\vdots \\
6 \\
6\left(\frac{q_n-q_{n-2}}{T_{n-2}}-\frac{q_{n-2}-q_{n-3}}{T_{n-3}}-\mathrm{v}_n \frac{T_{n-1}}{T_{n-2}}+\mathrm{a}_n \frac{T_{n-1}^2}{3 T_{n-2}}\right) \\
6\left(\frac{q_{n-2}-q_{n-3}}{T_{n-3}-q_n} T_{n-2}+\mathrm{v}_n\left(1+\frac{T_{n-1}}{T_{n-2}}\right)-\mathrm{a}_n\left(\frac{1}{2}+\frac{T_{n-1}}{3 T_{n-2}}\right) T_{n-1}\right)
\end{array}\right] \tag{26}
$$<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>clc;
</span></span><span style=display:flex><span>clear;
</span></span><span style=display:flex><span>close all;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>]<span style=color:#f92672>&#39;</span>; <span style=color:#75715e>%é€’å¢æ—¶é—´åºåˆ—</span>
</span></span><span style=display:flex><span>q = [<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>]<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>v0 = <span style=color:#ae81ff>2</span>; <span style=color:#75715e>%èµ·å§‹é€Ÿåº¦</span>
</span></span><span style=display:flex><span>vn = <span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>; <span style=color:#75715e>%ç»“æŸé€Ÿåº¦</span>
</span></span><span style=display:flex><span>a0 = <span style=color:#ae81ff>0</span>; <span style=color:#75715e>%èµ·å§‹åŠ é€Ÿåº¦</span>
</span></span><span style=display:flex><span>an = <span style=color:#ae81ff>0</span>; <span style=color:#75715e>%ç»“æŸåŠ é€Ÿåº¦</span>
</span></span><span style=display:flex><span>deltaT = <span style=color:#ae81ff>0.001</span>; <span style=color:#75715e>%æ’è¡¥å‘¨æœŸ</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>%å‰ä¸¤ä¸ªæ—¶é—´ä¹‹é—´ã€åä¸¤ä¸ªæ—¶é—´ä¹‹é—´æ’å…¥æ—¶é—´</span>
</span></span><span style=display:flex><span>n = length(t); <span style=color:#75715e>% n &gt;= 4</span>
</span></span><span style=display:flex><span>t2 = <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> (t(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> t(<span style=color:#ae81ff>2</span>));
</span></span><span style=display:flex><span>t_n_1 = <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> (t(n) <span style=color:#f92672>+</span> t(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>t = [t(<span style=color:#ae81ff>1</span>); t2; t(<span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>); t_n_1; t(n)];
</span></span><span style=display:flex><span>q = [q(<span style=color:#ae81ff>1</span>); <span style=color:#ae81ff>0.0</span>; q(<span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>); <span style=color:#ae81ff>0.0</span>; q(n)];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n = n <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>T = diff(t);
</span></span><span style=display:flex><span>a = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>b = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>c = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>d = zeros(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a(<span style=color:#ae81ff>2</span>) = T(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> T(<span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>3</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    a(i) = T(i);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>2</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>2</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    b(i) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T(i) <span style=color:#f92672>+</span> T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>b(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) = <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>    c(i) = T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>c(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>) = T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d(<span style=color:#ae81ff>1</span>) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(<span style=color:#ae81ff>3</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> v0 <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>2</span>)) <span style=color:#f92672>-</span> a0 <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>2</span>))) <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>d(<span style=color:#ae81ff>2</span>) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(<span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>3</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>3</span>) <span style=color:#f92672>-</span> (q(<span style=color:#ae81ff>3</span>) <span style=color:#f92672>-</span> q(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> v0 <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> T(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> a0 <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T(<span style=color:#ae81ff>2</span>)));
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>3</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>    d(i) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> T(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>/</span> T(i));
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>d(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(n) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> (q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>-</span> vn <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> an <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>)));
</span></span><span style=display:flex><span>d(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) = <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> q(n)) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>+</span> vn <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>)) <span style=color:#f92672>-</span> an <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>))) <span style=color:#f92672>*</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[w, sta] = solve_tridiagonal_matrix_equation(a, b, c, d, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> sta <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    error(<span style=color:#e6db74>&#39;ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹æ±‚è§£å‡ºé”™!&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>w = [a0; w; an];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>q(<span style=color:#ae81ff>2</span>) = q(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> v0 <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> a0 <span style=color:#f92672>/</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> T(<span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> w(<span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>q(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) = q(n) <span style=color:#f92672>-</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> vn <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> an <span style=color:#f92672>/</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> T(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)^<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> w(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>time = [];
</span></span><span style=display:flex><span>pos = [];
</span></span><span style=display:flex><span>vel = [];
</span></span><span style=display:flex><span>acc = [];
</span></span><span style=display:flex><span>time = [time; t(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>pos = [pos; q(<span style=color:#ae81ff>1</span>)];
</span></span><span style=display:flex><span>vel = [vel; v0];
</span></span><span style=display:flex><span>acc = [acc; a0];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i = <span style=color:#ae81ff>1</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    tt = (t(i) <span style=color:#f92672>+</span> deltaT : deltaT : t(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))<span style=color:#f92672>&#39;</span>;
</span></span><span style=display:flex><span>    b0 = q(i);
</span></span><span style=display:flex><span>    b1 = (q(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> q(i)) <span style=color:#f92672>/</span> T(i) <span style=color:#f92672>-</span> T(i) <span style=color:#f92672>*</span> (w(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> w(i)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>    b2 = <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> w(i);
</span></span><span style=display:flex><span>    b3 = (w(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> w(i)) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> T(i));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    time = [time; tt];
</span></span><span style=display:flex><span>    pos = [pos; b0 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (b1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (b2 <span style=color:#f92672>+</span> b3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))))];
</span></span><span style=display:flex><span>    vel = [vel; b1 <span style=color:#f92672>+</span> (tt <span style=color:#f92672>-</span> t(i)) <span style=color:#f92672>.*</span> (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> b2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> b3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i)))];
</span></span><span style=display:flex><span>    acc = [acc; <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> b2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> b3 <span style=color:#f92672>.*</span> (tt <span style=color:#f92672>-</span> t(i))];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> abs(time(<span style=color:#66d9ef>end</span>) <span style=color:#f92672>-</span> t(n)) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1.0e-8</span>
</span></span><span style=display:flex><span>    time = [time; t(n)];
</span></span><span style=display:flex><span>    pos = [pos; q(n)];
</span></span><span style=display:flex><span>    vel = [vel; vn];
</span></span><span style=display:flex><span>    acc = [acc; an];
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>figure(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>plot(time, pos);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot(t([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, n]), q([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span> : n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>, n]), <span style=color:#e6db74>&#39;ro&#39;</span>);
</span></span><span style=display:flex><span>plot(t([<span style=color:#ae81ff>2</span>, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]), q([<span style=color:#ae81ff>2</span>, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]), <span style=color:#e6db74>&#39;bs&#39;</span>);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;pos&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>plot(time, vel);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot(t([<span style=color:#ae81ff>1</span>, n]), [v0, vn], <span style=color:#e6db74>&#39;ro&#39;</span>);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;vel&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subplot(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>plot(time, acc);
</span></span><span style=display:flex><span>hold on
</span></span><span style=display:flex><span>plot(t([<span style=color:#ae81ff>1</span>, n]), [a0, an], <span style=color:#e6db74>&#39;ro&#39;</span>);
</span></span><span style=display:flex><span>xlabel(<span style=color:#e6db74>&#39;t&#39;</span>)
</span></span><span style=display:flex><span>ylabel(<span style=color:#e6db74>&#39;acc&#39;</span>)</span></span></code></pre></div><p><img src=https://cdn.mathpix.com/snip/images/i0BR4rg3x9bojg9Ss-biAlxqCOglplh5SlQiZvRg-QE.original.fullsize.png alt="fig z" width=500 style=height:auto></p><h2 id=äº”å‚è€ƒæ–‡çŒ®>äº”ã€å‚è€ƒæ–‡çŒ®</h2><p>ã€ŠTrajectory Planning for Automatic Machines and Robotsã€‹
4.4 Cubic Splin
A.5 Numerical Solution of Tridiagonal Systems</p><hr><h2 id=é™„å½•-1--ä¸‰å¯¹è§’æ–¹ç¨‹ä¸å¾ªç¯ä¸‰å¯¹è§’æ–¹ç¨‹æ•°å€¼è§£>é™„å½• 1. ä¸‰å¯¹è§’æ–¹ç¨‹ä¸å¾ªç¯ä¸‰å¯¹è§’æ–¹ç¨‹æ•°å€¼è§£</h2><p>ä¸‹é¢ä»‹ç»ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹å’Œå¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£æ–¹æ³•ï¼Œé‡ç‚¹è®¨è®º Thomas ç®—æ³•ï¼ˆè¿½èµ¶æ³•ï¼‰ä»¥åŠå¦‚ä½•å¤„ç†å¾ªç¯ï¼ˆå‘¨æœŸæ€§ï¼‰è¾¹ç•Œæ¡ä»¶çš„é—®é¢˜ã€‚</p><hr><h3 id=1-ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£>1. ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£</h3><p>è€ƒè™‘å½¢å¦‚</p>$$
a_i\, x_{i-1} + b_i\, x_i + c_i\, x_{i+1} = d_i,\quad i=1,2,\ldots,n,
$$<p>å…¶ä¸­çº¦å®š $a_1=0$ï¼ˆç¬¬ä¸€è¡Œæ²¡æœ‰å·¦ä¾§é¡¹ï¼‰å’Œ $c_n=0$ï¼ˆæœ€åä¸€è¡Œæ²¡æœ‰å³ä¾§é¡¹ï¼‰ã€‚è¿™ç§å½¢å¼å¯¹åº”äºä¸€ä¸ªä¸‰å¯¹è§’çŸ©é˜µç³»ç»Ÿã€‚</p><h4 id=thomas-ç®—æ³•è¿½èµ¶æ³•>Thomas ç®—æ³•ï¼ˆè¿½èµ¶æ³•ï¼‰</h4><p>Thomas ç®—æ³•æ˜¯ä¸€ç§ä¸“é—¨é’ˆå¯¹ä¸‰å¯¹è§’ç³»ç»Ÿçš„é«˜æ•ˆè§£æ³•ï¼Œå…¶åŸºæœ¬æ€è·¯ä¸ºåˆ©ç”¨å‰å‘æ¶ˆå»å°†åŸç³»ç»ŸåŒ–ä¸ºä¸Šä¸‰è§’ç³»ç»Ÿï¼Œå†é‡‡ç”¨å›ä»£æ±‚è§£ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><strong>å‰å‘æ¶ˆå»</strong></p><p>å¯¹äº $i=2,3,\ldots,n$ï¼š</p><ul><li>è®¡ç®—æ¶ˆå…ƒå› å­
$$
m_i = \frac{a_i}{b_{i-1}}.
$$</li><li>æ›´æ–°ä¸»å¯¹è§’å…ƒå’Œå³ç«¯é¡¹ï¼š
$$
b_i \leftarrow b_i - m_i\, c_{i-1},\qquad d_i \leftarrow d_i - m_i\, d_{i-1}.
$$</li></ul><p>æ­¤è¿‡ç¨‹æ¶ˆå»äº†æ‰€æœ‰ $a_i$ é¡¹ï¼Œä»è€Œå°†çŸ©é˜µå˜ä¸ºä¸Šä¸‰è§’å½¢ã€‚</p></li><li><p><strong>å›ä»£æ±‚è§£</strong></p><p>å…ˆæ±‚æœ€åä¸€ä¸ªæœªçŸ¥æ•°ï¼š</p>$$
x_n = \frac{d_n}{b_n}.
$$<p>ç„¶åå¯¹äº $i=n-1,\,n-2,\ldots,1$ ä¾æ¬¡è®¡ç®—ï¼š</p>$$
x_i = \frac{d_i - c_i\, x_{i+1}}{b_i}.
$$</li></ol><p>è¯¥æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ï¼Œåœ¨çŸ©é˜µå¯¹è§’å ä¼˜æˆ–æ­£å®šæ—¶å…·æœ‰è‰¯å¥½çš„æ•°å€¼ç¨³å®šæ€§ï¼Œé¿å…äº†ç›´æ¥æ±‚çŸ©é˜µé€†å¸¦æ¥çš„é«˜è®¡ç®—ä»£ä»·å’Œå¯èƒ½çš„ä¸ç¨³å®šæ€§ã€‚</p><hr><h3 id=2-å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£>2. å¾ªç¯ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹çš„æ•°å€¼æ±‚è§£</h3><h4 id=é—®é¢˜æè¿°>é—®é¢˜æè¿°</h4><p>å¾ªç¯ï¼ˆæˆ–å‘¨æœŸæ€§ï¼‰ä¸‰å¯¹è§’ç³»ç»Ÿä¸æ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿçš„åŒºåˆ«åœ¨äºï¼Œé™¤äº†ä¼ ç»Ÿçš„ä¸‰å¯¹è§’éƒ¨åˆ†ï¼Œè¿˜å­˜åœ¨é¢å¤–çš„è¾¹ç•Œè€¦åˆé¡¹ï¼Œå³ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œä¹‹é—´å­˜åœ¨éé›¶è¿æ¥ã€‚å¸¸è§çš„å†™æ³•ä¸ºï¼š</p>$$
\begin{aligned}
b_1\, x_1 + c_1\, x_2 + r\, x_n &= d_1,\\
a_i\, x_{i-1} + b_i\, x_i + c_i\, x_{i+1} &= d_i,\quad i=2,\ldots,n-1,\\
p\, x_1 + a_n\, x_{n-1} + b_n\, x_n &= d_n,
\end{aligned}
$$<p>å…¶ä¸­ $r$ å’Œ $p$ è¡¨ç¤ºè¿æ¥é¦–å°¾çš„éé›¶å…ƒç´ ã€‚</p><p>ç”±äº Thomas ç®—æ³•ä¸èƒ½ç›´æ¥å¤„ç†è¿™ä¸¤ä¸ªâ€œå¾ªç¯é¡¹â€ï¼Œå› æ­¤éœ€è¦é‡‡ç”¨ç‰¹æ®Šæ–¹æ³•å°†é—®é¢˜è½¬åŒ–ä¸ºæ ‡å‡†ä¸‰å¯¹è§’é—®é¢˜æ±‚è§£ã€‚</p><h4 id=æ–¹æ³•ä¸€åˆ©ç”¨-sherman-morrison-å…¬å¼>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨ Sherman-Morrison å…¬å¼</h4><p>è¯¥æ–¹æ³•çš„åŸºæœ¬æ€è·¯æ˜¯å°†åŸçŸ©é˜µåˆ†è§£ä¸ºä¸€ä¸ªæ ‡å‡†ä¸‰å¯¹è§’çŸ©é˜µåŠ ä¸Šä¸€ä¸ªä½ç§©ä¿®æ­£é¡¹ã€‚è®¾</p>$$
A = T + u\, v^T,
$$<p>å…¶ä¸­ï¼š</p><ul><li>$T$ ä¸ºå°†å¾ªç¯é¡¹ï¼ˆå³è§’å…ƒç´ ï¼‰ç½®é›¶åçš„ä¸‰å¯¹è§’çŸ©é˜µï¼Œ</li><li>$u$ å’Œ $v$ æ˜¯é€‰å–åˆé€‚çš„å‘é‡ï¼Œé€šå¸¸å¯ä»¥å–
$$
u = \begin{bmatrix} r \\ 0 \\ \vdots \\ 0 \\ p \end{bmatrix},\qquad v = \begin{bmatrix} 1 \\ 0 \\ \vdots \\ 0 \\ 1 \end{bmatrix}.
$$</li></ul><p>åˆ©ç”¨ Sherman-Morrison å…¬å¼ï¼Œè®¾å…ˆè§£ä¸¤ç»„ä¸‰å¯¹è§’ç³»ç»Ÿï¼š</p><ol><li>æ±‚è§£
$$
T\, z = d,
$$
å¾—åˆ°åˆæ­¥è§£ $z$ã€‚</li><li>æ±‚è§£
$$
T\, y = u,
$$
å¾—åˆ°è¾…åŠ©è§£ $y$ã€‚</li></ol><p>æœ€åï¼Œåˆ©ç”¨å…¬å¼</p>$$
x = z - \frac{v^T z}{1 + v^T y}\, y,
$$<p>å¾—åˆ°åŸç³»ç»Ÿ $A x = d$ çš„è§£ã€‚ç”±äº $T$ æ˜¯æ ‡å‡†ä¸‰å¯¹è§’çŸ©é˜µï¼Œå¯ä»¥ä½¿ç”¨ Thomas ç®—æ³•é«˜æ•ˆæ±‚è§£è¿™ä¸¤ä¸ªç³»ç»Ÿã€‚</p><h4 id=æ–¹æ³•äºŒåˆ†è§£æ³•è¡¥å……è§£æ³•>æ–¹æ³•äºŒï¼šåˆ†è§£æ³•ï¼ˆè¡¥å……è§£æ³•ï¼‰</h4><p>å¦ä¸€ç§å¸¸è§æ€è·¯æ˜¯å°†å¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿæ‹†åˆ†ä¸ºä¸¤ä¸ªæ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿã€‚æ­¥éª¤æ¦‚æ‹¬å¦‚ä¸‹ï¼š</p><ol><li><p><strong>æ„é€ è¾…åŠ©é—®é¢˜</strong></p><p>å…ˆå°†åŸç³»ç»Ÿä¸­å¾ªç¯é¡¹æš‚æ—¶å¿½ç•¥ï¼Œå³æ„é€ ä¸ä¹‹å¯¹åº”çš„ä¸‰å¯¹è§’ç³»ç»Ÿ</p>$$
T\, y = d,
$$<p>å¹¶æ±‚å‡ºè§£ $y$ã€‚</p></li><li><p><strong>è€ƒè™‘å¾ªç¯ä¿®æ­£</strong></p><p>è®¾åŸè§£å¯è¡¨ç¤ºä¸º</p>$$
x = y + \alpha\, z,
$$<p>å…¶ä¸­ $z$ æ˜¯ä¸€ä¸ªéœ€è¦è¡¥å……çš„ä¿®æ­£å‘é‡ï¼Œæ»¡è¶³ç›¸åº”çš„æ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿ</p>$$
T\, z = w,
$$<p>æ­¤å¤„ $w$ ä¸å¾ªç¯é¡¹ç›¸å…³ï¼ˆä¾‹å¦‚å¯ä»¥å– $w = [r, 0, \ldots, 0, p]^T$ï¼‰ã€‚</p></li><li><p><strong>ç¡®å®šç³»æ•° $\alpha$</strong></p><p>å°† $x = y + \alpha\, z$ ä»£å›åŸæ¥çš„å¾ªç¯è¾¹ç•Œæ¡ä»¶ï¼Œæ±‚è§£å‡ºç³»æ•° $\alpha$ã€‚</p></li><li><p><strong>å¾—åˆ°æœ€ç»ˆè§£</strong></p><p>å°† $\alpha$ å¸¦å›ï¼Œå³å¯å¾—åˆ°ç³»ç»Ÿçš„è§£ $x$ã€‚</p></li></ol><p>è¿™ç§æ–¹æ³•åŒæ ·å°†é—®é¢˜å½’çº¦ä¸ºæ±‚è§£ä¸¤ä¸ªæ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿï¼Œç„¶åé€šè¿‡è°ƒæ•´è¡¥å……è§£æ¥æ»¡è¶³å‘¨æœŸæ€§æ¡ä»¶ã€‚</p><hr><h4 id=æ€»ç»“>æ€»ç»“</h4><ul><li><strong>æ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿ</strong>ï¼šåˆ©ç”¨ Thomas ç®—æ³•ï¼Œé€šè¿‡å‰å‘æ¶ˆå»å’Œå›ä»£æ³•ä»¥ $O(n)$ æ—¶é—´æ±‚è§£ï¼Œé€‚ç”¨äºå¯¹è§’å ä¼˜æˆ–æ­£å®šçš„æƒ…å†µï¼Œæ•°å€¼ä¸Šè¾ƒä¸ºç¨³å®šã€‚</li><li><strong>å¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿ</strong>ï¼šç”±äºå­˜åœ¨é¢å¤–çš„è¾¹ç•Œè€¦åˆé¡¹ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯å°†åŸé—®é¢˜åˆ†è§£ä¸ºä¸€ä¸ªæ ‡å‡†ä¸‰å¯¹è§’é—®é¢˜åŠ ä¸Šä½ç§©ä¿®æ­£ã€‚å¸¸è§çš„æŠ€æœ¯åŒ…æ‹¬åˆ©ç”¨ Sherman-Morrison å…¬å¼æˆ–åˆ†è§£æ³•ï¼Œä»è€Œå°†å¾ªç¯ç³»ç»Ÿè½¬åŒ–ä¸ºä¸¤ä¸ªæ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿæ±‚è§£ã€‚</li></ul><p>è¿™ä¸¤ç§æ–¹æ³•å‡é¿å…äº†ç›´æ¥æ±‚çŸ©é˜µé€†ï¼Œä»è€Œå¤§å¤§é™ä½äº†è®¡ç®—é‡ï¼Œå¹¶æé«˜äº†è§£æ³•çš„ç¨³å®šæ€§ã€‚</p><h3 id=3-c-ç¤ºä¾‹ä»£ç >3. C++ ç¤ºä¾‹ä»£ç </h3><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•çš„å¼€æº C++ ç¤ºä¾‹ä»£ç ï¼ŒåŒ…å«äº†åˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£æ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿå’Œåˆ©ç”¨ Sherman-Morrison å…¬å¼æ±‚è§£å¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿçš„å®ç°ã€‚ä½ å¯ä»¥å°†ä¸‹é¢çš„ä»£ç ä½œä¸ºå‚è€ƒï¼Œæ ¹æ®å®é™…é—®é¢˜è¿›è¡Œä¿®æ”¹å’Œæ‰©å±•ã€‚</p><hr><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£ä¸‰å¯¹è§’ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ç³»ç»Ÿå½¢å¼ï¼š a[i]*x[i-1] + b[i]*x[i] + c[i]*x[i+1] = d[i] ï¼Œå…¶ä¸­ i=0,...,n-1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æ³¨æ„ï¼ša[0] å’Œ c[n-1] ä¸ä½¿ç”¨ï¼ˆå¯ä»¥ç½®ä¸º0ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> thomasSolver(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> a, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> b, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> c, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> d) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> d.size();
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> c_star(n, <span style=color:#ae81ff>0.0</span>), d_star(n, <span style=color:#ae81ff>0.0</span>), x(n, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> b_mod <span style=color:#f92672>=</span> b;  <span style=color:#75715e>// å¤åˆ¶ä¸€ä»½bï¼Œå› ä¸ºéœ€è¦åœ¨å‰å‘æ¶ˆå»è¿‡ç¨‹ä¸­ä¿®æ”¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¬¬ä¸€æ­¥ï¼šå‰å‘æ¶ˆå»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    c_star[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> c[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b_mod[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    d_star[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> d[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b_mod[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> m <span style=color:#f92672>=</span> b_mod[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> c_star[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ›´æ–° c_star
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>&lt;</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            c_star[i] <span style=color:#f92672>=</span> c[i] <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>        d_star[i] <span style=color:#f92672>=</span> (d[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> d_star[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¬¬äºŒæ­¥ï¼šå›ä»£æ±‚è§£
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    x[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> d_star[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; i<span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        x[i] <span style=color:#f92672>=</span> d_star[i] <span style=color:#f92672>-</span> c_star[i] <span style=color:#f92672>*</span> x[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ©ç”¨ Sherman-Morrison å…¬å¼æ±‚è§£å¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ç³»ç»Ÿå½¢å¼ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e>//    b[0]*x[0] + c[0]*x[1] + r*x[n-1] = d[0]
</span></span></span><span style=display:flex><span><span style=color:#75715e>//    a[i]*x[i-1] + b[i]*x[i] + c[i]*x[i+1] = d[i], i = 1,...,n-2
</span></span></span><span style=display:flex><span><span style=color:#75715e>//    p*x[0] + a[n-1]*x[n-2] + b[n-1]*x[n-1] = d[n-1]
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>// å…¶ä¸­ r å’Œ p åˆ†åˆ«ä¸ºç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œä¸­é¢å¤–çš„å¾ªç¯é¡¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> cyclicThomasSolver(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> a, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> b, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> c,
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> d, <span style=color:#66d9ef>double</span> r, <span style=color:#66d9ef>double</span> p) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> d.size();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ±‚è§£ T*z = dï¼Œå…¶ä¸­ T ä¸ºå»é™¤å¾ªç¯é¡¹åçš„ä¸‰å¯¹è§’çŸ©é˜µ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> z <span style=color:#f92672>=</span> thomasSolver(a, b, c, d);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ„é€ å‘é‡ u å¯¹åº”å¾ªç¯é¡¹ u = [r, 0, ..., 0, p]^T
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> u(n, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    u[<span style=color:#ae81ff>0</span>]     <span style=color:#f92672>=</span> r;
</span></span><span style=display:flex><span>    u[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> p;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ±‚è§£ T*y = u
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> y <span style=color:#f92672>=</span> thomasSolver(a, b, c, u);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—ä¿®æ­£ç³»æ•° alpha = (z[0] + z[n-1]) / (1 + y[0] + y[n-1])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> numerator   <span style=color:#f92672>=</span> z[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> z[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> denominator <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>+</span> y[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> y[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> alpha       <span style=color:#f92672>=</span> numerator <span style=color:#f92672>/</span> denominator;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æœ€ç»ˆè§£ï¼š x = z - alpha * y
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> x(n, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        x[i] <span style=color:#f92672>=</span> z[i] <span style=color:#f92672>-</span> alpha <span style=color:#f92672>*</span> y[i];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹ï¼šæ±‚è§£ä¸€ä¸ªä¸‰å¯¹è§’ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// ç³»æ•°æ•°ç»„è¦æ±‚ï¼ša[0] å’Œ c[n-1]ç½®0ï¼Œä¸å‚ä¸è®¡ç®—
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// ä¾‹å¦‚ï¼Œå¯¹äºæ–¹ç¨‹ç»„ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//   4*x0 + 1*x1             = 7
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//   1*x0 + 4*x1 + 1*x2        = 8
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//           1*x1 + 4*x2      = 7
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>};      <span style=color:#75715e>// ä¸‹å¯¹è§’ï¼ˆa[0]ä¸ä½¿ç”¨ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> b <span style=color:#f92672>=</span> {<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>};        <span style=color:#75715e>// ä¸»å¯¹è§’
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> c <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>};        <span style=color:#75715e>// ä¸Šå¯¹è§’ï¼ˆc[n-1]ä¸ä½¿ç”¨ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> d <span style=color:#f92672>=</span> {<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>7</span>};        <span style=color:#75715e>// å³ä¾§å¸¸æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> sol <span style=color:#f92672>=</span> thomasSolver(a, b, c, d);
</span></span><span style=display:flex><span>    cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;ä¸‰å¯¹è§’ç³»ç»Ÿçš„è§£:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>double</span> x : sol) {
</span></span><span style=display:flex><span>        cout <span style=color:#f92672>&lt;&lt;</span> x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; &#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹ï¼šæ±‚è§£ä¸€ä¸ªå¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// åœ¨ä¸Šä¾‹çš„åŸºç¡€ä¸Šï¼Œå‡è®¾ç¬¬ä¸€è¡Œå¤šäº†ä¸€ä¸ª r é¡¹ï¼Œæœ€åä¸€è¡Œå¤šäº†ä¸€ä¸ª p é¡¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> r <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;  <span style=color:#75715e>// ç¬¬ä¸€è¡Œæœ«å°¾çš„å¾ªç¯é¡¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> p <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>;  <span style=color:#75715e>// æœ€åä¸€è¡Œé¦–éƒ¨çš„å¾ªç¯é¡¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> cyclicSol <span style=color:#f92672>=</span> cyclicThomasSolver(a, b, c, d, r, p);
</span></span><span style=display:flex><span>    cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;å¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿçš„è§£:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>double</span> x : cyclicSol) {
</span></span><span style=display:flex><span>        cout <span style=color:#f92672>&lt;&lt;</span> x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; &#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h4 id=ä»£ç è¯´æ˜>ä»£ç è¯´æ˜</h4><ol><li><p><strong>Thomas ç®—æ³•éƒ¨åˆ†</strong></p><ul><li>å‡½æ•° <code>thomasSolver</code> å®ç°äº†æ ‡å‡†ä¸‰å¯¹è§’ç³»ç»Ÿçš„å‰å‘æ¶ˆå»å’Œå›ä»£è¿‡ç¨‹ã€‚</li><li>æ•°ç»„ <code>a</code>ã€<code>b</code>ã€<code>c</code> åˆ†åˆ«ä»£è¡¨ä¸‹å¯¹è§’ã€ä¸»å¯¹è§’å’Œä¸Šå¯¹è§’ï¼Œå…¶ä¸­ <code>a[0]</code> å’Œ <code>c[n-1]</code>ä¸ä½¿ç”¨ï¼›<code>d</code> ä¸ºå³ä¾§å¸¸æ•°å‘é‡ã€‚</li></ul></li><li><p><strong>å¾ªç¯ä¸‰å¯¹è§’ç³»ç»Ÿéƒ¨åˆ†</strong></p><ul><li>åˆ©ç”¨ Sherman-Morrison å…¬å¼ï¼Œå°†å¸¦æœ‰å¾ªç¯é¡¹çš„çŸ©é˜µåˆ†è§£ä¸ºå»é™¤å¾ªç¯é¡¹çš„ä¸‰å¯¹è§’çŸ©é˜µ T åŠ ä¸Šä½ç§©ä¿®æ­£ã€‚</li><li>åˆ†åˆ«è°ƒç”¨ <code>thomasSolver</code> æ±‚è§£ä¸¤ä¸ªè¾…åŠ©ç³»ç»Ÿï¼Œæœ€ååˆ©ç”¨ä¿®æ­£ç³»æ•° $ \alpha $ å¾—åˆ°æœ€ç»ˆè§£ã€‚</li></ul></li></ol><p>è¯¥ä»£ç ä»…ä¸ºç¤ºä¾‹ï¼Œä½ å¯ä»¥åœ¨ GitHub æˆ–å…¶ä»–å¼€æºå¹³å°ä¸Šæ‰¾åˆ°æ›´å¤šæˆç†Ÿçš„å®ç°ã€‚ä»£ç å‘å¸ƒæ—¶é‡‡ç”¨äº†å®½æ¾çš„å¼€æºè®¸å¯è¯ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œä¿®æ”¹å’Œä½¿ç”¨ã€‚</p><h2 id=é™„å½•-2--ç»™å®šèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼cç¤ºä¾‹>é™„å½• 2. ç»™å®šèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼C++ç¤ºä¾‹</h2><p>ç†è®ºä¸Šï¼Œå¯¹äºåªç”¨é€Ÿåº¦è¾¹ç•Œæ¡ä»¶çš„å¸¸è§„ä¸‰æ¬¡æ ·æ¡æ¥è¯´ï¼Œè‹¥åªæœ‰ä¸€æ®µï¼ˆå³åªæœ‰ä¸¤ä¸ªä½ç½®ç‚¹ï¼‰ï¼Œ4ä¸ªçº¦æŸï¼ˆä¸¤ä¸ªä½ç½®ã€ä¸¤ä¸ªç«¯ç‚¹é€Ÿåº¦ï¼‰å°±è¶³ä»¥å”¯ä¸€ç¡®å®šä¸€ä¸ªä¸‰æ¬¡å¤šé¡¹å¼ï¼›ä½†å½“ä½¿ç”¨å¤šæ®µæ ·æ¡ä¸”è¦æ±‚ä¸­é—´æ®µäºŒé˜¶è¿ç»­æ—¶ï¼Œä¸€èˆ¬éœ€è¦è‡³å°‘3ä¸ªä½ç½®ç‚¹æ‰èƒ½æ„é€ è¿ç»­æ›²çº¿ã€‚</p><p>è€Œåœ¨åŒæ—¶è¦æ±‚ç»™å®šèµ·å§‹é€Ÿåº¦ä¸åŠ é€Ÿåº¦ã€ä»¥åŠç»“æŸé€Ÿåº¦ä¸åŠ é€Ÿåº¦çš„æƒ…å½¢ä¸‹ï¼ˆå³æ¨¡å‹ä¸­æ‰€è®¨è®ºçš„é€šè¿‡åœ¨ç¬¬ä¸€æ®µå’Œæœ€åä¸€æ®µæ’å…¥è¾…åŠ©ç‚¹æ¥å®ç°åŒé‡ç«¯ç‚¹çº¦æŸçš„æ–¹æ¡ˆï¼‰ï¼ŒåŸå§‹çš„æ’å€¼ç‚¹æ•°å¿…é¡»è¶³å¤Ÿå¤šï¼Œä»¥ä¾¿ç»è¿‡æ‰©å±•åèƒ½å¤Ÿæ„é€ å‡ºæ»¡è¶³æ‰€æœ‰çº¦æŸçš„ç³»ç»Ÿã€‚é€šå¸¸è¿™ç§æ¨¡å‹è‡³å°‘è¦æ±‚åŸå§‹ä½ç½®ç‚¹æ•°ä¸å°‘äº4ä¸ªï¼ˆå³è‡³å°‘4ä¸ªé‡‡æ ·ç‚¹ï¼‰ï¼Œè¿™æ ·ç»è¿‡åœ¨ç¬¬ä¸€æ®µå’Œæœ€åä¸€æ®µåˆ†åˆ«æ’å…¥ä¸€ä¸ªè¾…åŠ©ç‚¹åï¼Œæ€»èŠ‚ç‚¹æ•°æ‰è¶³å¤Ÿå»ºç«‹æ±‚è§£è¾…åŠ©å˜é‡ï¼ˆåŠ é€Ÿåº¦ï¼‰çš„ä¸‰å¯¹è§’æ–¹ç¨‹ï¼Œå¹¶è¿›è€Œç¡®å®šæ‰€æœ‰åˆ†æ®µå¤šé¡¹å¼çš„ç³»æ•°ã€‚</p><p>å› æ­¤ï¼Œæ ¹æ®è¯¥æ¨¡å‹å¦‚æœåŒæ—¶ç»™å®šç«¯ç‚¹é€Ÿåº¦ä¸åŠ é€Ÿåº¦ï¼Œè‡³å°‘éœ€è¦4ä¸ªä½ç½®ç‚¹ã€‚</p><h3 id=1ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—>1ã€ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡é€Ÿåº¦è®¡ç®—</h3><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªæ¨¡å—åŒ–çš„ C++ ä»£ç ç¤ºä¾‹ï¼Œè¯¥ä»£ç å®ç°äº†åŸºäºç»™å®šèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ï¼Œå†…éƒ¨åˆ©ç”¨ Thomas ç®—æ³•ï¼ˆè¿½èµ¶æ³•ï¼‰æ±‚è§£å¯¹è§’å ä¼˜çš„ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹ï¼Œè®¡ç®—å„æ®µæ ·æ¡çš„ç³»æ•°ï¼Œå¹¶æä¾›äº†åœ¨ä»»æ„æ—¶åˆ»å¤„è¿›è¡Œæ’å€¼ï¼ˆåŠæ±‚å¯¼ã€æ±‚äºŒé˜¶å¯¼ï¼‰çš„æ¥å£ã€‚ä»£ç ç»“æ„ä¸ºä¸€ä¸ªç±» â€œCubicSplineâ€ï¼Œä¾¿äºè°ƒç”¨ä¸é›†æˆã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><hr><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdexcept&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;algorithm&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Thomas ç®—æ³•ï¼šæ±‚è§£ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æ±‚è§£æ–¹ç¨‹ç»„ï¼š a[i]*x[i-1] + b[i]*x[i] + c[i]*x[i+1] = d[i] , i = 0,...,n-1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æ³¨æ„ï¼ša[0] ä¸ c[n-1]ä¸ä½¿ç”¨ï¼ˆåº”ç½® 0ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> solveTridiagonal(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> a, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> b,
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> c, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> d) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> d.size();
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> cp(n, <span style=color:#ae81ff>0.0</span>), dp(n, <span style=color:#ae81ff>0.0</span>), x(n, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(n <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    cp[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> c[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    dp[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> d[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> m <span style=color:#f92672>=</span> b[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> cp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>&lt;</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            cp[i] <span style=color:#f92672>=</span> c[i] <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>        dp[i] <span style=color:#f92672>=</span> (d[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> dp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    x[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> dp[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; <span style=color:#f92672>--</span>i)
</span></span><span style=display:flex><span>        x[i] <span style=color:#f92672>=</span> dp[i] <span style=color:#f92672>-</span> cp[i] <span style=color:#f92672>*</span> x[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// CubicSpline ç±»ï¼šå®ç°åŸºäºé€Ÿåº¦çº¦æŸçš„ä¸‰æ¬¡æ ·æ¡æ’å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ç»™å®šèŠ‚ç‚¹ (t_i, q_i) ä»¥åŠç«¯ç‚¹é€Ÿåº¦ v0 ä¸ vn åï¼Œè®¡ç®—æ¯æ®µæ ·æ¡çš„ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æ”¯æŒåœ¨ä»»æ„ t å†…æŸ¥è¯¢æ ·æ¡å€¼ã€é€Ÿåº¦ï¼ˆ1é˜¶å¯¼ï¼‰ä¸åŠ é€Ÿåº¦ï¼ˆ2é˜¶å¯¼ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CubicSpline</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®èŠ‚ç‚¹æ•°æ®ï¼ˆè¦æ±‚ t ä¸ºä¸¥æ ¼é€’å¢åºåˆ—ï¼Œq ä¸ t æ•°é‡ç›¸åŒï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> setPoints(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> t, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> q) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t.size() <span style=color:#f92672>!=</span> q.size() <span style=color:#f92672>||</span> t.size() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> invalid_argument(<span style=color:#e6db74>&#34;ç‚¹æ•°ä¸åŒ¹é…æˆ–å°‘äºä¸¤ä¸ªç‚¹!&#34;</span>);
</span></span><span style=display:flex><span>        t_ <span style=color:#f92672>=</span> t;
</span></span><span style=display:flex><span>        q_ <span style=color:#f92672>=</span> q;
</span></span><span style=display:flex><span>        n_ <span style=color:#f92672>=</span> t_.size();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®èµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setBoundaryVelocities</span>(<span style=color:#66d9ef>double</span> v0, <span style=color:#66d9ef>double</span> vn) {
</span></span><span style=display:flex><span>        v0_ <span style=color:#f92672>=</span> v0;
</span></span><span style=display:flex><span>        vn_ <span style=color:#f92672>=</span> vn;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ ¹æ®å…¬å¼ï¼ˆè§è¯´æ˜ï¼‰è®¡ç®—ä¸‰æ¬¡æ ·æ¡å„æ®µç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// æ¨¡å‹å‚è€ƒï¼šç»™å®šèµ·å§‹é€Ÿåº¦ä¸ç»“æŸé€Ÿåº¦ï¼Œåˆ©ç”¨ä½ç½®ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦è¿ç»­æ€§æ¡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>computeSpline</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_.empty() <span style=color:#f92672>||</span> q_.empty() <span style=color:#f92672>||</span> n_ <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;æ•°æ®æœªè®¾ç½®æˆ–ç‚¹æ•°ä¸è¶³!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—å„æ®µæ—¶é—´é—´éš”ï¼š T[i] = t_[i+1] - t_[i], i = 0,...,n_-2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        T_.resize(n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            T_[i] <span style=color:#f92672>=</span> t_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(T_[i] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;æ—¶é—´èŠ‚ç‚¹å¿…é¡»ä¸¥æ ¼é€’å¢!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ ¹æ®åŠ é€Ÿåº¦è¿ç»­æ€§æ¡ä»¶å¯æ„é€ å¯¹è§’å ä¼˜çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼ŒæœªçŸ¥é‡ä¸ºä¸­é—´å„èŠ‚ç‚¹é€Ÿåº¦ v[1]...v[n_-2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// å¯¹åº”æ–¹ç¨‹ï¼ˆå‚è§æ–‡çŒ®æˆ–è¯´æ˜ï¼‰ï¼šå¯¹äº k = 0,..., n_-3ï¼Œ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   T_[k+1] * v_[k] + 2*(T_[k] + T_[k+1])* v_[k+1] + T_[k] * v_[k+2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//     = 3*(T_[k]^2*(q_[k+2]-q_[k+1]) + T_[k+1]^2*(q_[k+1]-q_[k]))/(T_[k]*T_[k+1])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// å¯¹äº k = 0 ä¸ k = n_-2ï¼ˆå¯¹åº”é¦–ã€å°¾æ–¹ç¨‹ï¼‰è¦å¼•å…¥è¾¹ç•Œå·²çŸ¥é‡ v0_ ä¸ vn_
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t m <span style=color:#f92672>=</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// ä¸­é—´æœªçŸ¥é€Ÿåº¦ä¸ªæ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a_tridiag(m, <span style=color:#ae81ff>0.0</span>), b_tridiag(m, <span style=color:#ae81ff>0.0</span>), c_tridiag(m, <span style=color:#ae81ff>0.0</span>), d_tridiag(m, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// ç¬¬ 1 ä¸ªæ–¹ç¨‹ (i = 0ï¼Œå¯¹åº” k = 0)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            a_tridiag[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;  <span style=color:#75715e>// ç¬¬ä¸€è¡Œæ— ä¸‹å¯¹è§’
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            b_tridiag[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                c_tridiag[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> T_[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            d_tridiag[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> ( T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>(q_[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> q_[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>*</span>T_[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>*</span>(q_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[<span style=color:#ae81ff>0</span>]) )
</span></span><span style=display:flex><span>                           <span style=color:#f92672>/</span> (T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>-</span> T_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> v0_;
</span></span><span style=display:flex><span>            <span style=color:#75715e>// ä¸­é—´æ–¹ç¨‹ï¼š i = 1, 2, ..., m-2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>                a_tridiag[i] <span style=color:#f92672>=</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                b_tridiag[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T_[i] <span style=color:#f92672>+</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>                c_tridiag[i] <span style=color:#f92672>=</span> T_[i];
</span></span><span style=display:flex><span>                d_tridiag[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> ( T_[i]<span style=color:#f92672>*</span>T_[i]<span style=color:#f92672>*</span>(q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>+</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]<span style=color:#f92672>*</span>T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]<span style=color:#f92672>*</span>(q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[i]) )
</span></span><span style=display:flex><span>                               <span style=color:#f92672>/</span> (T_[i] <span style=color:#f92672>*</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#75715e>// æœ€åä¸€ä¸ªæ–¹ç¨‹ï¼š i = m-1ï¼Œå¯¹åº” k = n_-2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                size_t i <span style=color:#f92672>=</span> m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                a_tridiag[i] <span style=color:#f92672>=</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]; <span style=color:#75715e>// æ³¨æ„ï¼ši+1 = m = n_-1ï¼Œæ­£å¥½æ˜¯ T_ çš„æœ€åä¸€ä¸ªå…ƒç´ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                b_tridiag[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T_[i] <span style=color:#f92672>+</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>                <span style=color:#75715e>// æœ€åä¸€è¡Œæ— ä¸Šå¯¹è§’ï¼Œæ•… c_tridiag[i] ä¿æŒä¸º 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                d_tridiag[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> ( T_[i]<span style=color:#f92672>*</span>T_[i]<span style=color:#f92672>*</span>(q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>+</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]<span style=color:#f92672>*</span>T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]<span style=color:#f92672>*</span>(q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[i]) )
</span></span><span style=display:flex><span>                               <span style=color:#f92672>/</span> (T_[i] <span style=color:#f92672>*</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>-</span> T_[i] <span style=color:#f92672>*</span> vn_;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ±‚è§£ä¸‰å¯¹è§’æ–¹ç¨‹ï¼ˆè‹¥ m==0 åˆ™è¡¨ç¤ºåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œä¸éœ€æ’å€¼ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> v_interior;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            v_interior <span style=color:#f92672>=</span> solveTridiagonal(a_tridiag, b_tridiag, c_tridiag, d_tridiag);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ„é€ å®Œæ•´çš„é€Ÿåº¦å‘é‡ï¼š v_[0] = v0_, v_[1..n_-2] ä¸ºæ±‚å¾—çš„è§£ï¼Œ v_[n_-1] = vn_
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        v_.resize(n_);
</span></span><span style=display:flex><span>        v_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> v0_;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> m; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            v_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> v_interior[i];
</span></span><span style=display:flex><span>        v_[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> vn_;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ ¹æ®å…¬å¼ï¼ˆè§è¯´æ˜ï¼‰ï¼Œè®¡ç®—å„æ®µæ ·æ¡çš„ç³»æ•°ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// è®¾ç¬¬ i æ®µ (i = 0,..., n_-2) å¤šé¡¹å¼ä¸ºï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   q_i(t) = a0_[i] + a1_[i]*(t - t_[i]) + a2_[i]*(t - t_[i])^2 + a3_[i]*(t - t_[i])^3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// å…¶ä¸­ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a0_[i] = q_[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a1_[i] = v_[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a2_[i] = [3*(q_[i+1]-q_[i])/T_[i] - 2*v_[i] - v_[i+1]] / T_[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a3_[i] = [2*(q_[i]-q_[i+1])/T_[i] + v_[i] + v_[i+1]] / (T_[i]*T_[i])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        a0_.resize(n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        a1_.resize(n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        a2_.resize(n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        a3_.resize(n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            a0_[i] <span style=color:#f92672>=</span> q_[i];
</span></span><span style=display:flex><span>            a1_[i] <span style=color:#f92672>=</span> v_[i];
</span></span><span style=display:flex><span>            a2_[i] <span style=color:#f92672>=</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> (q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[i]) <span style=color:#f92672>/</span> T_[i] <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> v_[i] <span style=color:#f92672>-</span> v_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> T_[i];
</span></span><span style=display:flex><span>            a3_[i] <span style=color:#f92672>=</span> (<span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (q_[i] <span style=color:#f92672>-</span> q_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> T_[i] <span style=color:#f92672>+</span> v_[i] <span style=color:#f92672>+</span> v_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> (T_[i] <span style=color:#f92672>*</span> T_[i]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        computed_ <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åœ¨ä»»æ„ t_query å¤„è®¡ç®—æ ·æ¡æ’å€¼å€¼ï¼ˆä½ç½®ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluate</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline() è®¡ç®—æ ·æ¡ç³»æ•°!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_query <span style=color:#f92672>&lt;</span> t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºæ ·æ¡æ’å€¼èŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findInterval(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a0_[i] <span style=color:#f92672>+</span> a1_[i]<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> a2_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> a3_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—æ ·æ¡åœ¨ t_query å¤„çš„ä¸€é˜¶å¯¼æ•°ï¼ˆé€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluateDerivative</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline() è®¡ç®—æ ·æ¡ç³»æ•°!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_query <span style=color:#f92672>&lt;</span> t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºæ ·æ¡æ’å€¼èŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findInterval(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a1_[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>a2_[i]<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span><span style=color:#f92672>*</span>a3_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—æ ·æ¡åœ¨ t_query å¤„çš„äºŒé˜¶å¯¼æ•°ï¼ˆåŠ é€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluateSecondDerivative</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline() è®¡ç®—æ ·æ¡ç³»æ•°!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_query <span style=color:#f92672>&lt;</span> t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºæ ·æ¡æ’å€¼èŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findInterval(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>a2_[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span><span style=color:#f92672>*</span>a3_[i]<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// äºŒåˆ†æŸ¥æ‰¾ï¼šæ‰¾åˆ°æ»¡è¶³ t_[i] &lt;= t_query &lt;= t_[i+1] çš„åŒºé—´ i
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    size_t findInterval(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> it <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>upper_bound(t_.begin(), t_.end(), t_query);
</span></span><span style=display:flex><span>        size_t idx <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>distance(t_.begin(), it);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(idx <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(idx <span style=color:#f92672>&gt;=</span> t_.size())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> t_.size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> idx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> t_;     <span style=color:#75715e>// èŠ‚ç‚¹æ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> q_;     <span style=color:#75715e>// èŠ‚ç‚¹ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> T_;     <span style=color:#75715e>// å„æ®µæ—¶é—´é—´éš” T[i] = t_[i+1] - t_[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> v_;     <span style=color:#75715e>// å„èŠ‚ç‚¹é€Ÿåº¦ï¼ˆv0 ä¸ vn ä¸ºè¾¹ç•Œç»™å®šï¼Œå…¶ä½™ç”±ä¸‰å¯¹è§’æ–¹ç¨‹æ±‚å¾—ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a0_, a1_, a2_, a3_; <span style=color:#75715e>// æ¯æ®µå¤šé¡¹å¼ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> v0_, vn_;       <span style=color:#75715e>// èµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    size_t n_;             <span style=color:#75715e>// èŠ‚ç‚¹æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>bool</span> computed_ <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ä¸»å‡½æ•°ï¼šæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ CubicSpline ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹æ•°æ®ï¼Œä¸æ­£æ–‡ä¸­ MATLAB ç¤ºä¾‹ä¸€è‡´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> t <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>};
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> q <span style=color:#f92672>=</span> {<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>};
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> v0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span>;   <span style=color:#75715e>// èµ·å§‹é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> vn <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>3.0</span>;  <span style=color:#75715e>// ç»“æŸé€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ„é€ æ ·æ¡å¯¹è±¡ï¼Œè®¾ç½®æ•°æ®ã€è¾¹ç•Œé€Ÿåº¦ï¼Œå¹¶è®¡ç®—æ ·æ¡ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    CubicSpline spline;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        spline.setPoints(t, q);
</span></span><span style=display:flex><span>        spline.setBoundaryVelocities(v0, vn);
</span></span><span style=display:flex><span>        spline.computeSpline();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// åœ¨ [t.front(), t.back()] å†…ä»¥ä¸€å®šæ­¥é•¿è¿›è¡Œæ’å€¼ï¼ˆæ­¤å¤„ dt = 0.001ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.001</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>double</span> time <span style=color:#f92672>=</span> t.front(); time <span style=color:#f92672>&lt;=</span> t.back(); time <span style=color:#f92672>+=</span> dt) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> pos <span style=color:#f92672>=</span> spline.evaluate(time);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> vel <span style=color:#f92672>=</span> spline.evaluateDerivative(time);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> acc <span style=color:#f92672>=</span> spline.evaluateSecondDerivative(time);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// ä¸ºäº†å‡å°‘è¾“å‡ºé‡ï¼Œæ¯éš” 1 ç§’æ‰“å°ä¸€æ¬¡ç»“æœ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (fabs(fmod(time, <span style=color:#ae81ff>1.0</span>)) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1e-6</span>)
</span></span><span style=display:flex><span>                cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;t = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> time <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, pos = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> pos 
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, vel = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> vel <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, acc = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> acc <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>const</span> exception <span style=color:#f92672>&amp;</span>e) {
</span></span><span style=display:flex><span>        cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;é”™è¯¯: &#34;</span> <span style=color:#f92672>&lt;&lt;</span> e.what() <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h4 id=ä»£ç è¯´æ˜-1>ä»£ç è¯´æ˜</h4><ol><li><p><strong>Thomas ç®—æ³•</strong><br>å‡½æ•° <code>solveTridiagonal</code> å®ç°äº†æ ‡å‡†çš„è¿½èµ¶æ³•ï¼Œç”¨äºæ±‚è§£å½¢å¦‚<br></p>$$
a_i\,x_{i-1} + b_i\,x_i + c_i\,x_{i+1} = d_i
$$<p>çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼ˆå…¶ä¸­è¦æ±‚ $a_0=0,\, c_{n-1}=0$ï¼‰ã€‚</p></li><li><p><strong>CubicSpline ç±»</strong></p><ul><li><strong>æ•°æ®è®¾ç½®</strong>ï¼šé€šè¿‡ <code>setPoints</code> è®¾ç½®èŠ‚ç‚¹ $t_i$ ä¸ä½ç½® $q_i$ï¼›é€šè¿‡ <code>setBoundaryVelocities</code> ç»™å‡ºèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦ã€‚</li><li><strong>ç³»æ•°è®¡ç®—</strong>ï¼š<code>computeSpline</code> å†…éƒ¨å…ˆæ„é€ å‡ºå„åŒºé—´æ—¶é—´é—´éš”ï¼Œå†æ ¹æ®åŠ é€Ÿåº¦è¿ç»­æ€§æ¡ä»¶æ„é€ å‡ºä¸‰å¯¹è§’ç³»ç»Ÿæ±‚è§£å†…éƒ¨èŠ‚ç‚¹é€Ÿåº¦ï¼Œæœ€ååˆ©ç”¨å…¬å¼ï¼ˆ4ï¼‰è®¡ç®—æ¯æ®µçš„å¤šé¡¹å¼ç³»æ•°ã€‚</li><li><strong>æ’å€¼æ¥å£</strong>ï¼š<code>evaluate</code>ã€<code>evaluateDerivative</code>ã€<code>evaluateSecondDerivative</code> åˆ†åˆ«ç”¨äºè®¡ç®—æ ·æ¡åœ¨ä»»æ„æ—¶åˆ»å¤„çš„ä½ç½®ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ã€‚</li></ul></li><li><p><strong>ä¸»å‡½æ•°</strong><br>æ¼”ç¤ºäº†å¦‚ä½•æ„é€  CubicSpline å¯¹è±¡ã€è®¾ç½®æ•°æ®ã€è®¡ç®—æ ·æ¡ç³»æ•°ä»¥åŠä»¥ 0.001 ç§’çš„æ­¥é•¿è¿›è¡Œæ’å€¼ï¼ˆæ­¤å¤„ä»…æ¯éš” 1 ç§’æ‰“å°ä¸€æ¬¡ç»“æœï¼‰ã€‚</p></li></ol><p>è¯¥ä»£ç æ¨¡å—åŒ–ç¨‹åº¦è¾ƒé«˜ï¼Œä¾¿äºé›†æˆåˆ°å…¶ä»–å·¥ç¨‹ä¸­ä½¿ç”¨ï¼Œä¹Ÿå¯æ ¹æ®éœ€è¦æ‰©å±•å…¶å®ƒè¾¹ç•Œæ¡ä»¶æˆ–æ’å€¼æ–¹æ³•ã€‚</p><p>å½“å‰æä¾›çš„ä»£ç åªå®ç°äº†<strong>åŸºäºé€Ÿåº¦çº¦æŸ</strong>æ±‚è§£ä¸‰æ¬¡æ ·æ¡ç³»æ•°çš„æ–¹æ³•ï¼Œå³åˆ©ç”¨å·²çŸ¥çš„èµ·å§‹é€Ÿåº¦ $v_0$ å’Œç»ˆæ­¢é€Ÿåº¦ $v_n$ï¼Œé€šè¿‡æ„é€ æ»¡è¶³ä½ç½®ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦è¿ç»­æ€§æ¡ä»¶çš„ä¸‰å¯¹è§’çŸ©é˜µï¼ˆè§å…¬å¼ (6) å’Œ (7)ï¼‰ï¼Œæ±‚è§£ä¸­é—´èŠ‚ç‚¹çš„é€Ÿåº¦ï¼Œç„¶ååˆ©ç”¨å…¬å¼</p>$$
\begin{aligned}
a_{k,0} &= q_k, \\
a_{k,1} &= v_k, \\
a_{k,2} &= \frac{3\,(q_{k+1}-q_k)/T_k - 2\,v_k - v_{k+1}}{T_k}, \\
a_{k,3} &= \frac{2\,(q_k-q_{k+1})/T_k + v_k + v_{k+1}}{T_k^2},
\end{aligned}
$$<p>è®¡ç®—æ¯æ®µå¤šé¡¹å¼çš„ç³»æ•°ã€‚è¿™æ­£æ˜¯åŸºäºé€Ÿåº¦çš„æ–¹æ³•ï¼Œå¯¹åº”æ–‡ä¸­<strong>é€šè¿‡é€Ÿåº¦è®¡ç®—ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ‰€æœ‰çº¦æŸ</strong>çš„éƒ¨åˆ†ã€‚</p><p>è€Œå¦ä¸€ç§æ–¹æ³•â€”â€”<strong>åŸºäºåŠ é€Ÿåº¦æ±‚è§£</strong>çš„æ–¹æ¡ˆï¼ˆå¯¹åº”æ–‡ä¸­å…¬å¼ (8)-(17)ï¼‰éœ€è¦æ„é€ ä¸€ä¸ªä¸åŒçš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼ˆå…¶ä¸­æœªçŸ¥é‡ä¸ºå„èŠ‚ç‚¹çš„åŠ é€Ÿåº¦ $\omega$ï¼‰ï¼Œå†é€šè¿‡å¯¹åº”å…¬å¼è®¡ç®—å¤šé¡¹å¼ç³»æ•°ï¼Œç›®å‰ä»£ç ä¸­å¹¶æ²¡æœ‰ä½“ç°è¿™ä¸€éƒ¨åˆ†ã€‚å½“å‰ä»£ç ä»…ä½“ç°äº†åŸºäºé€Ÿåº¦çš„æ±‚è§£æ–¹æ³•ï¼Œä»¥ä¸‹åˆ™ä¸ºåˆ©ç”¨åŠ é€Ÿåº¦æ±‚è§£ä¸‰æ¬¡æ ·æ¡ç³»æ•°çš„æ–¹æ¡ˆã€‚</p><h3 id=2ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—>2ã€ä¸‰æ¬¡æ ·æ¡çš„ç³»æ•°é€šè¿‡åŠ é€Ÿåº¦è®¡ç®—</h3><p>ä¸‹é¢ç»™å‡ºä¸€ä»½å®Œæ•´çš„ C++ ç¤ºä¾‹ä»£ç ï¼Œè¯¥ä»£ç å®ç°äº†åŸºäºåŠ é€Ÿåº¦æ–¹æ³•çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ã€‚ä»£ç ä¸­åˆ©ç”¨åŠ é€Ÿåº¦è¿ç»­æ€§å’Œè¾¹ç•Œé€Ÿåº¦æ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿï¼ˆè§å…¬å¼ (12)-(16)ï¼‰ï¼Œåˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£å„èŠ‚ç‚¹çš„åŠ é€Ÿåº¦ï¼Œç„¶åæ ¹æ®å…¬å¼ (17) è®¡ç®—æ¯æ®µå¤šé¡¹å¼çš„ç³»æ•°ã€‚æœ€ç»ˆï¼Œä»£ç æä¾›äº†åœ¨ä»»æ„æ—¶åˆ»å¤„è®¡ç®—ä½ç½®ã€é€Ÿåº¦ä¸åŠ é€Ÿåº¦çš„æ¥å£ï¼Œä¾¿äºè°ƒç”¨ä¸é›†æˆã€‚</p><hr><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdexcept&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;algorithm&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Thomas ç®—æ³•ï¼šæ±‚è§£ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æ±‚è§£æ–¹ç¨‹ç»„ï¼š a[i]*x[i-1] + b[i]*x[i] + c[i]*x[i+1] = d[i] , i = 0,...,n-1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// è¦æ±‚ a[0] = 0, c[n-1] = 0
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> solveTridiagonal(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> a, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> b,
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> c, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> d) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> d.size();
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> cp(n, <span style=color:#ae81ff>0.0</span>), dp(n, <span style=color:#ae81ff>0.0</span>), x(n, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(n <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    cp[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> c[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    dp[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> d[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> m <span style=color:#f92672>=</span> b[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> cp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>&lt;</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            cp[i] <span style=color:#f92672>=</span> c[i] <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>        dp[i] <span style=color:#f92672>=</span> (d[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> dp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    x[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> dp[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; <span style=color:#f92672>--</span>i)
</span></span><span style=display:flex><span>        x[i] <span style=color:#f92672>=</span> dp[i] <span style=color:#f92672>-</span> cp[i] <span style=color:#f92672>*</span> x[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// CubicSplineAcceleration ç±»ï¼šåŸºäºåŠ é€Ÿåº¦æ–¹æ³•çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ç»™å®šèŠ‚ç‚¹ (t_i, q_i) ä»¥åŠè¾¹ç•Œé€Ÿåº¦ v0 ä¸ vnï¼Œå…ˆæ±‚åŠ é€Ÿåº¦ Ï‰_i (i=0,...,n-1)
</span></span></span><span style=display:flex><span><span style=color:#75715e>// å†è®¡ç®—æ¯æ®µå¤šé¡¹å¼ç³»æ•°ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   a0 = q[i],
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   a1 = (q[i+1]-q[i])/T[i] - T[i]*(Ï‰[i+1] + 2Ï‰[i])/6,
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   a2 = Ï‰[i] / 2,
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   a3 = (Ï‰[i+1]-Ï‰[i])/(6*T[i])
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CubicSplineAcceleration</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®èŠ‚ç‚¹æ•°æ®ï¼ˆè¦æ±‚ t ä¸ºä¸¥æ ¼é€’å¢åºåˆ—ï¼Œq ä¸ t æ•°é‡ç›¸åŒï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> setPoints(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> t, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> q) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t.size() <span style=color:#f92672>!=</span> q.size() <span style=color:#f92672>||</span> t.size() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> invalid_argument(<span style=color:#e6db74>&#34;ç‚¹æ•°ä¸åŒ¹é…æˆ–å°‘äºä¸¤ä¸ªç‚¹!&#34;</span>);
</span></span><span style=display:flex><span>        t_ <span style=color:#f92672>=</span> t;
</span></span><span style=display:flex><span>        q_ <span style=color:#f92672>=</span> q;
</span></span><span style=display:flex><span>        n_ <span style=color:#f92672>=</span> t_.size();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®è¾¹ç•Œé€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setBoundaryVelocities</span>(<span style=color:#66d9ef>double</span> v0, <span style=color:#66d9ef>double</span> vn) {
</span></span><span style=display:flex><span>        v0_ <span style=color:#f92672>=</span> v0;
</span></span><span style=display:flex><span>        vn_ <span style=color:#f92672>=</span> vn;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ ¹æ®åŠ é€Ÿåº¦æ–¹æ³•è®¡ç®—ä¸‰æ¬¡æ ·æ¡å„æ®µç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// è¿‡ç¨‹ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 1. è®¡ç®—å„æ®µæ—¶é—´é—´éš” T[i] = t[i+1]-t[i], i = 0,...,n_-2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 2. æ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿ A*Ï‰ = d, å…¶ä¸­ Ï‰ çš„ç»´æ•°ä¸º n_ï¼ˆèŠ‚ç‚¹ä¸ªæ•°ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//    A çš„æ„é€ ï¼ˆ0-indexedï¼‰ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//      row0:    A[0,0] = 2*T[0],    A[0,1] = T[0]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//      row i (1&lt;= i &lt;= n_-2): A[i,i-1] = T[i-1], A[i,i] = 2*(T[i-1]+T[i]), A[i,i+1] = T[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//      row n_-1: A[n_-1, n_-2] = T[n_-2], A[n_-1, n_-1] = 2*T[n_-2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//    d çš„æ„é€ ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//      d[0] = 6*((q[1]-q[0])/T[0] - v0)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//      d[i] = 6*((q[i+1]-q[i])/T[i] - (q[i]-q[i-1])/T[i-1])  (i=1,...,n_-2)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//      d[n_-1] = 6*(vn - (q[n_-1]-q[n_-2])/T[n_-2])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 3. åˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£ Ï‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 4. æ ¹æ® Ï‰ è®¡ç®—å„æ®µæ ·æ¡å¤šé¡¹å¼ç³»æ•°ï¼ˆæ¯æ®µ [t[i], t[i+1]]ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>computeSpline</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_.empty() <span style=color:#f92672>||</span> q_.empty() <span style=color:#f92672>||</span> n_ <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;æ•°æ®æœªè®¾ç½®æˆ–ç‚¹æ•°ä¸è¶³!&#34;</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 1. è®¡ç®—å„æ®µæ—¶é—´é—´éš” T
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        T_.resize(n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            T_[i] <span style=color:#f92672>=</span> t_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(T_[i] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;æ—¶é—´èŠ‚ç‚¹å¿…é¡»ä¸¥æ ¼é€’å¢!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 2. æ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿ A*Ï‰ = dï¼Œå…¶ä¸­ Ï‰ çš„ç»´æ•°ä¸º n_
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// a, b, c ä¸ºä¸‰å¯¹è§’çŸ©é˜µçš„ä¸‹å¯¹è§’ã€ä¸»å¯¹è§’ã€ä¸Šå¯¹è§’ï¼Œå‡å¤§å°ä¸º n_
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a(n_, <span style=color:#ae81ff>0.0</span>), b(n_, <span style=color:#ae81ff>0.0</span>), c(n_, <span style=color:#ae81ff>0.0</span>), d_vec(n_, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸‹å¯¹è§’ï¼šå¯¹äº i = 1,..., n_-1, a[i] = T_[i-1]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        a[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n_; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            a[i] <span style=color:#f92672>=</span> T_[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸»å¯¹è§’ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// row0: b[0] = 2*T_[0]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// row i (1&lt;=i&lt;=n_-2): b[i] = 2*(T_[i-1] + T_[i])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// row n_-1: b[n_-1] = 2*T_[n_-2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        b[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            b[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T_[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> T_[i]);
</span></span><span style=display:flex><span>        b[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T_[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸Šå¯¹è§’ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// å¯¹äº i = 0,..., n_-2, c[i] = T_[i]ï¼›æœ€åä¸€è¡Œæ— ä¸Šå¯¹è§’ï¼Œc[n_-1]=0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            c[i] <span style=color:#f92672>=</span> T_[i];
</span></span><span style=display:flex><span>        c[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å³ç«¯é¡¹ d_vec:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// d[0] = 6*((q[1]-q[0])/T_[0] - v0)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        d_vec[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> v0_);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å¯¹äº i = 1,..., n_-2:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            d_vec[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ((q_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[i]) <span style=color:#f92672>/</span> T_[i] <span style=color:#f92672>-</span> (q_[i] <span style=color:#f92672>-</span> q_[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> T_[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// d[n_-1] = 6*(vn - (q[n_-1]-q[n_-2])/T_[n_-2])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        d_vec[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> (vn_ <span style=color:#f92672>-</span> (q_[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]) <span style=color:#f92672>/</span> T_[n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 3. æ±‚è§£ä¸‰å¯¹è§’ç³»ç»Ÿ A*Ï‰ = d_vecï¼Œå¾—åˆ° Ï‰ï¼ˆåŠ é€Ÿåº¦å‘é‡ï¼Œå¤§å°ä¸º n_ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        omega_ <span style=color:#f92672>=</span> solveTridiagonal(a, b, c, d_vec);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 4. æ ¹æ® Ï‰ è®¡ç®—æ¯æ®µå¤šé¡¹å¼ç³»æ•°ï¼ˆåŒºé—´ i=0,..., n_-2ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// æ¯æ®µå¤šé¡¹å¼å½¢å¼ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   q_i(t) = a0[i] + a1[i]*(t-t[i]) + a2[i]*(t-t[i])^2 + a3[i]*(t-t[i])^3, t in [t[i], t[i+1]]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// å…¶ä¸­ï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a0[i] = q_[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a1[i] = (q_[i+1]-q_[i])/T_[i] - T_[i]*(omega_[i+1] + 2*omega_[i]) / 6
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a2[i] = omega_[i] / 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//   a3[i] = (omega_[i+1]-omega_[i]) / (6*T_[i])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t segs <span style=color:#f92672>=</span> n_ <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        a0_.resize(segs);
</span></span><span style=display:flex><span>        a1_.resize(segs);
</span></span><span style=display:flex><span>        a2_.resize(segs);
</span></span><span style=display:flex><span>        a3_.resize(segs);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> segs; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            a0_[i] <span style=color:#f92672>=</span> q_[i];
</span></span><span style=display:flex><span>            a1_[i] <span style=color:#f92672>=</span> (q_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> q_[i]) <span style=color:#f92672>/</span> T_[i] <span style=color:#f92672>-</span> T_[i] <span style=color:#f92672>*</span> (omega_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> omega_[i]) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>            a2_[i] <span style=color:#f92672>=</span> omega_[i] <span style=color:#f92672>/</span> <span style=color:#ae81ff>2.0</span>;
</span></span><span style=display:flex><span>            a3_[i] <span style=color:#f92672>=</span> (omega_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> omega_[i]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> T_[i]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        computed_ <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åœ¨ä»»æ„ t_query å¤„è®¡ç®—æ ·æ¡æ’å€¼å€¼ï¼ˆä½ç½®ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluate</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline() è®¡ç®—æ ·æ¡ç³»æ•°!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_query <span style=color:#f92672>&lt;</span> t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºæ ·æ¡æ’å€¼èŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findInterval(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a0_[i] <span style=color:#f92672>+</span> a1_[i]<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> a2_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> a3_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—æ ·æ¡åœ¨ t_query å¤„çš„ä¸€é˜¶å¯¼æ•°ï¼ˆé€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluateDerivative</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline() è®¡ç®—æ ·æ¡ç³»æ•°!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_query <span style=color:#f92672>&lt;</span> t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºæ ·æ¡æ’å€¼èŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findInterval(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a1_[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>a2_[i]<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span><span style=color:#f92672>*</span>a3_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—æ ·æ¡åœ¨ t_query å¤„çš„äºŒé˜¶å¯¼æ•°ï¼ˆåŠ é€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluateSecondDerivative</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline() è®¡ç®—æ ·æ¡ç³»æ•°!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t_query <span style=color:#f92672>&lt;</span> t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºæ ·æ¡æ’å€¼èŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findInterval(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>a2_[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span><span style=color:#f92672>*</span>a3_[i]<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// äºŒåˆ†æŸ¥æ‰¾ï¼šæ‰¾åˆ°æ»¡è¶³ t_[i] &lt;= t_query &lt;= t_[i+1] çš„åŒºé—´ i
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    size_t findInterval(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> it <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>upper_bound(t_.begin(), t_.end(), t_query);
</span></span><span style=display:flex><span>        size_t idx <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>distance(t_.begin(), it);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(idx <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(idx <span style=color:#f92672>&gt;=</span> t_.size())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> t_.size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> idx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> t_;          <span style=color:#75715e>// èŠ‚ç‚¹æ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> q_;          <span style=color:#75715e>// èŠ‚ç‚¹ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> T_;          <span style=color:#75715e>// å„æ®µæ—¶é—´é—´éš” T[i] = t[i+1] - t[i]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> omega_;      <span style=color:#75715e>// å„èŠ‚ç‚¹åŠ é€Ÿåº¦ï¼ˆç”±ä¸‰å¯¹è§’ç³»ç»Ÿæ±‚å¾—ï¼‰ï¼Œå¤§å°ä¸º n_
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a0_, a1_, a2_, a3_; <span style=color:#75715e>// æ¯æ®µå¤šé¡¹å¼ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> v0_, vn_;            <span style=color:#75715e>// è¾¹ç•Œï¼ˆèµ·å§‹ã€ç»ˆæ­¢ï¼‰é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    size_t n_;                  <span style=color:#75715e>// èŠ‚ç‚¹æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>bool</span> computed_ <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ä¸»å‡½æ•°ï¼šæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ CubicSplineAcceleration ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹æ•°æ®ï¼ˆä¸ MATLAB ç¤ºä¾‹ç±»ä¼¼ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> t <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>};
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> q <span style=color:#f92672>=</span> {<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>};
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> v0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span>;   <span style=color:#75715e>// èµ·å§‹é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> vn <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>3.0</span>;  <span style=color:#75715e>// ç»“æŸé€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ„é€ æ ·æ¡å¯¹è±¡ï¼Œè®¾ç½®æ•°æ®ä¸è¾¹ç•Œé€Ÿåº¦ï¼Œè®¡ç®—æ ·æ¡ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    CubicSplineAcceleration spline;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        spline.setPoints(t, q);
</span></span><span style=display:flex><span>        spline.setBoundaryVelocities(v0, vn);
</span></span><span style=display:flex><span>        spline.computeSpline();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// åœ¨ [t.front(), t.back()] å†…ä»¥ä¸€å®šæ­¥é•¿è¿›è¡Œæ’å€¼ï¼ˆæ­¤å¤„ dt = 0.001ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.001</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>double</span> time <span style=color:#f92672>=</span> t.front(); time <span style=color:#f92672>&lt;=</span> t.back(); time <span style=color:#f92672>+=</span> dt) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> pos <span style=color:#f92672>=</span> spline.evaluate(time);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> vel <span style=color:#f92672>=</span> spline.evaluateDerivative(time);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> acc <span style=color:#f92672>=</span> spline.evaluateSecondDerivative(time);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// ä¸ºäº†å‡å°‘è¾“å‡ºé‡ï¼Œæ¯éš” 1 ç§’æ‰“å°ä¸€æ¬¡ç»“æœ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (fabs(fmod(time, <span style=color:#ae81ff>1.0</span>)) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1e-6</span>)
</span></span><span style=display:flex><span>                cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;t = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> time <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, pos = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> pos 
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, vel = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> vel <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, acc = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> acc <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>const</span> exception <span style=color:#f92672>&amp;</span>e) {
</span></span><span style=display:flex><span>        cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;é”™è¯¯: &#34;</span> <span style=color:#f92672>&lt;&lt;</span> e.what() <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h4 id=ä»£ç è¯´æ˜-2>ä»£ç è¯´æ˜</h4><ol><li><p><strong>Thomas ç®—æ³•å‡½æ•°</strong><br>å‡½æ•° <code>solveTridiagonal</code> å®ç°äº†æ ‡å‡†è¿½èµ¶æ³•ï¼Œç”¨äºæ±‚è§£å½¢å¦‚<br></p>$$
a_i\,\omega_{i-1} + b_i\,\omega_i + c_i\,\omega_{i+1} = d_i
$$<p>çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼Œå…¶ä¸­è¦æ±‚ <code>a[0]=0</code>ã€<code>c[n-1]=0</code>ã€‚</p></li><li><p><strong>CubicSplineAcceleration ç±»</strong></p><ul><li><strong>æ•°æ®è®¾ç½®</strong>ï¼šé€šè¿‡ <code>setPoints</code> è®¾ç½®èŠ‚ç‚¹ $t_i$ ä¸ä½ç½® $q_i$ï¼›é€šè¿‡ <code>setBoundaryVelocities</code> ç»™å®šèµ·å§‹ä¸ç»ˆæ­¢é€Ÿåº¦ã€‚</li><li><strong>ç³»æ•°è®¡ç®—</strong>ï¼š<code>computeSpline</code> å†…éƒ¨é¦–å…ˆè®¡ç®—å„æ®µæ—¶é—´é—´éš”ï¼Œå†æ„é€ åŠ é€Ÿåº¦æ³•å¯¹åº”çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼ˆå‚è€ƒå…¬å¼ (12)-(16)ï¼‰ï¼Œåˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£å„èŠ‚ç‚¹çš„åŠ é€Ÿåº¦ Ï‰ï¼Œæœ€ååˆ©ç”¨å…¬å¼ (17) è®¡ç®—æ¯æ®µå¤šé¡¹å¼çš„ç³»æ•°ã€‚</li><li><strong>æ’å€¼æ¥å£</strong>ï¼š<code>evaluate</code>ã€<code>evaluateDerivative</code>ã€<code>evaluateSecondDerivative</code> åˆ†åˆ«ç”¨äºè®¡ç®—æ ·æ¡åœ¨ä»»æ„æ—¶åˆ»å¤„çš„ä½ç½®ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ã€‚</li></ul></li><li><p><strong>ä¸»å‡½æ•°</strong><br>æ¼”ç¤ºå¦‚ä½•æ„é€  CubicSplineAcceleration å¯¹è±¡ã€è®¾ç½®æ•°æ®ä¸è¾¹ç•Œé€Ÿåº¦ã€è®¡ç®—æ ·æ¡ç³»æ•°ï¼Œå¹¶ä»¥ 0.001 ç§’çš„æ­¥é•¿è¿›è¡Œæ’å€¼ï¼ˆæ­¤å¤„æ¯éš” 1 ç§’è¾“å‡ºä¸€æ¬¡ç»“æœï¼‰ã€‚</p></li></ol><p>è¯¥ä»£ç ç‹¬ç«‹å®ç°äº†åˆ©ç”¨åŠ é€Ÿåº¦æ±‚è§£ä¸‰æ¬¡æ ·æ¡ç³»æ•°çš„æ–¹æ³•ï¼Œä¾¿äºä¸åŸºäºé€Ÿåº¦çš„æ–¹æ³•ä¸€èµ·é›†æˆä¸æ¯”è¾ƒã€‚</p><h2 id=é™„å½•-3-ç»™å®šèµ·å§‹ä¸ç»“æŸçš„é€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼>é™„å½• 3. ç»™å®šèµ·å§‹ä¸ç»“æŸçš„é€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼</h2><p>ä¸‹é¢ C++ ç¤ºä¾‹ä»£ç ï¼Œå®ç°äº†åœ¨åŒæ—¶çº¦æŸèµ·å§‹é€Ÿåº¦ä¸åŠ é€Ÿåº¦ã€ç»“æŸé€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼ã€‚</p><p>è¯¥æ–¹æ³•çš„åŸºæœ¬æ€è·¯æ˜¯ï¼š</p><ol><li><p>å¯¹åŸå§‹èŠ‚ç‚¹åºåˆ—<br></p>$$
t = [t_0,\,t_1,\,t_2,\ldots,t_{n-1}],\quad q = [q_0,\,q_1,\,\ldots,q_{n-1}]
$$<p>æ’å…¥ä¸¤ä¸ªâ€œè¾…åŠ©â€ç‚¹ï¼ˆåˆ†åˆ«æ’åœ¨ç¬¬ä¸€æ®µä¸æœ€åä¸€æ®µï¼‰ï¼š<br></p>$$
\bar t_1=0.5\,(t_0+t_1),\quad \bar t_{n-1}=0.5\,(t_{n-2}+t_{n-1})
$$<p>åŒæ—¶æ„é€ æ–°çš„èŠ‚ç‚¹åºåˆ—<br></p>$$
\bar t = [\,t_0,\;\bar t_1,\;t_1,t_2,\ldots,t_{n-2},\;\bar t_{n-1},\;t_{n-1}\,]
$$<p>å¯¹åº”ä½ç½®å€¼ä¸­è¾…åŠ©ç‚¹åˆå€¼å…ˆç½®é›¶ï¼Œåé¢åˆ©ç”¨è¾¹ç•Œæ¡ä»¶æ¢å¤ï¼ˆè§ä¸‹é¢å…¬å¼ï¼‰ã€‚</p></li><li><p>è®¾æ–°çš„èŠ‚ç‚¹æ•°ä¸º $N=n+2$ï¼›è®¡ç®—å„æ®µæ—¶é—´é—´éš”<br></p>$$
T_i=\bar t_{i+1}-\bar t_{i},\quad i=0,\ldots,N-2.
$$</li><li><p>æ„é€ ä¸€ä¸ªå¯¹è§’å ä¼˜çš„ä¸‰å¯¹è§’ç³»ç»Ÿæ¥æ±‚è§£å„èŠ‚ç‚¹â€œåŠ é€Ÿåº¦â€ $ \omega $ï¼ˆæ³¨æ„ï¼šè¿™é‡Œçš„ $\omega$ ä¸ºè¾…åŠ©å˜é‡ï¼Œåç»­ç”¨æ¥è®¡ç®—å¤šé¡¹å¼ç³»æ•°ï¼‰ã€‚ç³»ç»Ÿçš„å¤§å°ä¸º $N-2$ï¼ˆå¯¹åº”å»æ‰ç¬¬ä¸€ä¸æœ€åä¸€èŠ‚ç‚¹ï¼Œå…¶å€¼ç”±ç»™å®šæ¡ä»¶ç¡®å®šï¼‰ï¼š</p><p>å¯¹åº” MATLAB ä»£ç ä¸­ï¼ˆå¼ï¼ˆ25ï¼‰â€“ï¼ˆ26ï¼‰ï¼‰çš„ç³»æ•°ï¼Œåœ¨ C++ä¸­æˆ‘ä»¬é‡‡ç”¨ä¸‹è¿°ï¼ˆ0â€ç´¢å¼•ï¼‰æ–¹å¼å¡«å†™ç³»ç»Ÿçš„ä¸‰ä¸ªå¯¹è§’çº¿å’Œå³ç«¯é¡¹ $d$</p><ul><li>ä¸‹å¯¹è§’ $a$ï¼ˆé•¿åº¦ $m=N-2$ï¼‰ï¼š<ul><li>$ a[0] = 0 $</li><li>$ a[1] = T[1]-T[0]^2/T[1] $</li><li>å¯¹ $ i=2,\ldots,m-1$ï¼š $ a[i] = T[i] $</li></ul></li><li>ä¸»å¯¹è§’ $b$ï¼ˆé•¿åº¦ $m$ï¼‰ï¼š<ul><li>$ b[0]= 2\,T[1] + T[0]\Bigl(3+\frac{T[0]}{T[1]}\Bigr) $</li><li>å¯¹ $ i=1,\ldots,m-2$ï¼š $ b[i] = 2\Bigl(T[i]+T[i+1]\Bigr) $</li><li>$ b[m-1]= 2\,T[m-1] + T[m]\Bigl(3+\frac{T[m]}{T[m-1]}\Bigr) $</li></ul></li><li>ä¸Šå¯¹è§’ $c$ï¼ˆé•¿åº¦ $m$ï¼‰ï¼š<ul><li>å¯¹ $ i=0,\ldots,m-2$ï¼š $ c[i] = T[i+1] $</li><li>$ c[m-1]= T[m] - \dfrac{T[m]^2}{T[m-1]} $</li></ul></li><li>å³ç«¯é¡¹ $d$ï¼ˆé•¿åº¦ $m$ï¼‰ï¼š<ul><li>$ d[0] = 6\Bigl[\dfrac{\bar q[2]-\bar q[0]}{T[1]} - v_0\Bigl(1+\frac{T[0]}{T[1]}\Bigr) - a_0\Bigl(\frac{1}{2}+\frac{T[0]}{3\,T[1]}\Bigr)T[0]\Bigr] $</li><li>$ d[1] = 6\Bigl[\dfrac{\bar q[3]-\bar q[2]}{T[2]} - \dfrac{\bar q[2]-\bar q[0]}{T[1]} + v_0\,\dfrac{T[0]}{T[1]} + a_0\,\dfrac{T[0]^2}{3\,T[1]}\Bigr] $</li><li>å¯¹ $ i=2,\ldots,m-3$ï¼š<br>$$
d[i]=6\Bigl[\dfrac{\bar q[i+2]-\bar q[i+1]}{T[i+1]}-\dfrac{\bar q[i+1]-\bar q[i]}{T[i]}\Bigr]
$$</li><li>å€’æ•°ç¬¬äºŒæ–¹ç¨‹ï¼š<br>$$
d[m-2]=6\Bigl[\dfrac{\bar q[N-1]-\bar q[N-3]}{T[N-2]}-\dfrac{\bar q[N-3]-\bar q[N-4]}{T[N-3]}-v_n\,\frac{T[N-2]}{T[N-3]}+a_n\,\frac{T[N-2]^2}{3\,T[N-3]}\Bigr]
$$</li><li>æœ€åä¸€æ–¹ç¨‹ï¼š<br>$$
d[m-1]=6\Bigl[\dfrac{\bar q[N-3]-\bar q[N-1]}{T[N-2]}+v_n\Bigl(1+\frac{T[N-2]}{T[N-3]}\Bigr)-a_n\Bigl(\frac{1}{2}+\frac{T[N-2]}{3\,T[N-3]}\Bigr)T[N-2]\Bigr]
$$</li></ul></li></ul><p>ï¼ˆè¿™é‡Œï¼š$N=$æ‰©å±•åèŠ‚ç‚¹æ•°ï¼›ä¸‹æ ‡å«ä¹‰ï¼šä¾‹å¦‚ $T[0]$ å¯¹åº” $\mathrm{T}_0$ï¼Œ$T[1]$ å¯¹åº” $\mathrm{T}_1$ï¼Œâ€¦â€¦ï¼›åŒç† $\bar q[i]$ ä¸ºæ‰©å±•åçš„ä½ç½®å€¼ã€‚ï¼‰</p></li><li><p>åˆ©ç”¨ Thomas ç®—æ³•æ±‚è§£ä¸‰å¯¹è§’ç³»ç»Ÿï¼Œå¾—åˆ°å†…éƒ¨èŠ‚ç‚¹çš„ $\omega$ï¼ˆè®°ä¸º $w$ï¼‰ï¼›å†æ„é€ å®Œæ•´çš„ $\omega$ å‘é‡<br></p>$$
\omega = [\,a_0,\;w_1,\;w_2,\ldots,w_{N-2},\;a_n\,]
$$</li><li><p>æ ¹æ®è¾¹ç•Œæ¡ä»¶é‡æ–°â€œä¿®æ­£â€ä¸¤ä¸ªè¾…åŠ©ç‚¹çš„ä½ç½®å€¼ï¼š<br></p>$$
\begin{aligned}
\bar q_1 &= q_0 + T_0\,v_0 + \frac{T_0^2\,a_0}{3} + \frac{T_0^2\,\omega_1}{6}, \\
\bar q_{N-2} &= q_{n-1} - T_{N-2}\,v_n + \frac{T_{N-2}^2\,a_n}{3} + \frac{T_{N-2}^2\,\omega_{N-2}}{6}\,.
\end{aligned}
$$</li><li><p>å¯¹æ¯ä¸€æ®µ $[\,\bar t_i,\bar t_{i+1}]$ï¼ˆ$i=0,\ldots,N-2$ï¼‰ï¼Œåˆ©ç”¨æ±‚å¾—çš„ $\omega$ è®¡ç®—ä¸‰æ¬¡å¤šé¡¹å¼ç³»æ•°<br>å¯¹ç¬¬ $i$ æ®µè®¾<br></p>$$
q_i(t)=b_{0,i}+b_{1,i}(t-\bar t_i)+b_{2,i}(t-\bar t_i)^2+b_{3,i}(t-\bar t_i)^3\,,
$$<p>å…¶ä¸­<br></p>$$
\begin{aligned}
b_{0,i}&=\bar q_i, \\
   b_{1,i}&=\frac{\bar q_{i+1}-\bar q_i}{T_i}-\frac{T_i}{6}\Bigl(\omega_{i+1}+2\,\omega_i\Bigr), \\
b_{2,i}&=\frac{\omega_i}{2}, \\
   b_{3,i}&=\frac{\omega_{i+1}-\omega_i}{6\,T_i}\,.
\end{aligned}
$$</li><li><p>åˆ©ç”¨ä¸Šè¿°å¤šé¡¹å¼å¯åœ¨ä»»æ„æ—¶åˆ»è¿›è¡Œä½ç½®ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦çš„æŸ¥è¯¢ã€‚</p></li></ol><p>ä¸‹é¢çš„ä»£ç ç»™å‡ºäº†ä¸€ä¸ªæ¨¡å—åŒ–çš„ C++ å®ç°ï¼Œå…¶ä¸­ Thomas ç®—æ³•å‡½æ•°ä¸ç±» <code>CubicSplineBoundary</code> å‡å·²å®ç°ï¼Œå¯æ–¹ä¾¿è°ƒç”¨ä¸é›†æˆã€‚</p><hr><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdexcept&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;algorithm&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Thomas ç®—æ³•ï¼šæ±‚è§£ä¸‰å¯¹è§’çŸ©é˜µæ–¹ç¨‹
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æ±‚è§£æ–¹ç¨‹ç»„ï¼š a[i]*x[i-1] + b[i]*x[i] + c[i]*x[i+1] = d[i],  i=0,...,n-1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// è¦æ±‚ a[0] = 0, c[n-1] = 0
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> solveTridiagonal(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> a, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> b,
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> c, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> d) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> d.size();
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> cp(n, <span style=color:#ae81ff>0.0</span>), dp(n, <span style=color:#ae81ff>0.0</span>), x(n, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(n <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    cp[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> c[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    dp[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> d[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> b[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> m <span style=color:#f92672>=</span> b[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> cp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(i <span style=color:#f92672>&lt;</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            cp[i] <span style=color:#f92672>=</span> c[i] <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>        dp[i] <span style=color:#f92672>=</span> (d[i] <span style=color:#f92672>-</span> a[i] <span style=color:#f92672>*</span> dp[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    x[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> dp[n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; <span style=color:#f92672>--</span>i)
</span></span><span style=display:flex><span>        x[i] <span style=color:#f92672>=</span> dp[i] <span style=color:#f92672>-</span> cp[i] <span style=color:#f92672>*</span> x[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// CubicSplineBoundary ç±»ï¼šåœ¨åŒæ—¶çº¦æŸèµ·å§‹/ç»“æŸé€Ÿåº¦ä¸åŠ é€Ÿåº¦æ¡ä»¶ä¸‹çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e>// å†…éƒ¨å…ˆåœ¨ç¬¬ä¸€æ®µä¸æœ€åä¸€æ®µæ’å…¥è¾…åŠ©ç‚¹ï¼Œæ„é€ æ‰©å±•çš„èŠ‚ç‚¹åºåˆ—ï¼Œç„¶åæ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿæ±‚è§£è¾…åŠ©å˜é‡ Ï‰ï¼Œ
</span></span></span><span style=display:flex><span><span style=color:#75715e>// æœ€åè®¡ç®—å„æ®µä¸‰æ¬¡å¤šé¡¹å¼çš„ç³»æ•°ï¼Œå¹¶æä¾›åœ¨ä»»æ„æ—¶åˆ»å¤„è®¡ç®—ä½ç½®ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦çš„æ¥å£ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CubicSplineBoundary</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®åŸå§‹èŠ‚ç‚¹æ•°æ®ï¼ˆè¦æ±‚ t ä¸ºä¸¥æ ¼é€’å¢åºåˆ—ï¼Œq ä¸ t æ•°é‡ç›¸åŒï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> setPoints(<span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> t, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;&amp;</span> q) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(t.size() <span style=color:#f92672>!=</span> q.size() <span style=color:#f92672>||</span> t.size() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> invalid_argument(<span style=color:#e6db74>&#34;ç‚¹æ•°ä¸åŒ¹é…æˆ–å°‘äºä¸¤ä¸ªç‚¹!&#34;</span>);
</span></span><span style=display:flex><span>        orig_t_ <span style=color:#f92672>=</span> t;
</span></span><span style=display:flex><span>        orig_q_ <span style=color:#f92672>=</span> q;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®è¾¹ç•Œæ¡ä»¶ï¼šèµ·å§‹é€Ÿåº¦ v0 ä¸åŠ é€Ÿåº¦ a0ï¼Œç»“æŸé€Ÿåº¦ vn ä¸åŠ é€Ÿåº¦ an
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setBoundaryConditions</span>(<span style=color:#66d9ef>double</span> v0, <span style=color:#66d9ef>double</span> vn, <span style=color:#66d9ef>double</span> a0, <span style=color:#66d9ef>double</span> an) {
</span></span><span style=display:flex><span>        v0_ <span style=color:#f92672>=</span> v0;
</span></span><span style=display:flex><span>        vn_ <span style=color:#f92672>=</span> vn;
</span></span><span style=display:flex><span>        a0_ <span style=color:#f92672>=</span> a0;
</span></span><span style=display:flex><span>        an_ <span style=color:#f92672>=</span> an;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—æ‰©å±•èŠ‚ç‚¹ã€æ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿæ±‚è§£ Ï‰ï¼Œå†è®¡ç®—æ¯æ®µå¤šé¡¹å¼ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>computeSpline</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 1. æ„é€ æ‰©å±•èŠ‚ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t nOrig <span style=color:#f92672>=</span> orig_t_.size();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ‰©å±•åèŠ‚ç‚¹æ•°ï¼š N = nOrig + 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t N <span style=color:#f92672>=</span> nOrig <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>        ext_t_.resize(N);
</span></span><span style=display:flex><span>        ext_q_.resize(N);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ç¬¬ä¸€ä¸ªç‚¹ä¸å˜
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        ext_t_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> orig_t_[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>        ext_q_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> orig_q_[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ’å…¥è¾…åŠ©ç‚¹ 1ï¼šå–åŸ t0 ä¸ t1 çš„ä¸­ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        ext_t_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> (orig_t_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> orig_t_[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        ext_q_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>; <span style=color:#75715e>// å¾…æ±‚ï¼ˆåé¢æ›´æ–°ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// ä¸­é—´éƒ¨åˆ†ï¼šåŸ t[1] ... t[nOrig-2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;</span> N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            ext_t_[i] <span style=color:#f92672>=</span> orig_t_[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]; <span style=color:#75715e>// æ³¨æ„ä¸‹æ ‡è½¬æ¢
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            ext_q_[i] <span style=color:#f92672>=</span> orig_q_[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ’å…¥è¾…åŠ©ç‚¹ 2ï¼šå–åŸ t[nOrig-2] ä¸ t[nOrig-1] çš„ä¸­ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        ext_t_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> (orig_t_[nOrig <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> orig_t_[nOrig <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>; <span style=color:#75715e>// å¾…æ±‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// æœ€åä¸€ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        ext_t_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> orig_t_[nOrig <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> orig_q_[nOrig <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 2. è®¡ç®—å„æ®µæ—¶é—´é—´éš” T, å…± N-1 ä¸ª
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t M_T <span style=color:#f92672>=</span> N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        T_.resize(M_T);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> M_T; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            T_[i] <span style=color:#f92672>=</span> ext_t_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> ext_t_[i];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (T_[i] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;æ—¶é—´èŠ‚ç‚¹å¿…é¡»ä¸¥æ ¼é€’å¢!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 3. æ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿæ¥æ±‚è§£å†…éƒ¨ Ï‰ï¼ˆè¾…åŠ©å˜é‡ï¼‰ï¼Œç³»ç»Ÿè§„æ¨¡ m = N - 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t m <span style=color:#f92672>=</span> N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a(m, <span style=color:#ae81ff>0.0</span>), b(m, <span style=color:#ae81ff>0.0</span>), c(m, <span style=color:#ae81ff>0.0</span>), d(m, <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸‹å¯¹è§’ aï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        a[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            a[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> T_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> (T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>T_[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;</span> m; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            a[i] <span style=color:#f92672>=</span> T_[i];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸»å¯¹è§’ bï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        b[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            b[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> (T_[i] <span style=color:#f92672>+</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        b[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span> <span style=color:#f92672>*</span> T_[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> T_[m] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> T_[m] <span style=color:#f92672>/</span> T_[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸Šå¯¹è§’ cï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            c[i] <span style=color:#f92672>=</span> T_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        c[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> T_[m] <span style=color:#f92672>-</span> (T_[m]<span style=color:#f92672>*</span>T_[m]) <span style=color:#f92672>/</span> T_[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å³ç«¯é¡¹ dï¼š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// d[0] å¯¹åº”è¾…åŠ©ç‚¹ 1çš„æ–¹ç¨‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        d[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ( (ext_q_[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> ext_q_[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>                      <span style=color:#f92672>-</span> v0_ <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>                      <span style=color:#f92672>-</span> a0_ <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>1</span>])) <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>0</span>] );
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            d[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ( (ext_q_[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> ext_q_[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                          <span style=color:#f92672>-</span> (ext_q_[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> ext_q_[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>                          <span style=color:#f92672>+</span> v0_ <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> T_[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>                          <span style=color:#f92672>+</span> a0_ <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>T_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T_[<span style=color:#ae81ff>1</span>]) );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;</span> m <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            d[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ( (ext_q_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> ext_q_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> T_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>                          <span style=color:#f92672>-</span> (ext_q_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> ext_q_[i]) <span style=color:#f92672>/</span> T_[i] );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(m <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// å€’æ•°ç¬¬äºŒæ–¹ç¨‹ï¼šæ³¨æ„ä¸‹æ ‡è½¬æ¢
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            d[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ( (ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>]) <span style=color:#f92672>/</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                              <span style=color:#f92672>-</span> (ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>]) <span style=color:#f92672>/</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>                              <span style=color:#f92672>-</span> vn_ <span style=color:#f92672>*</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>/</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>                              <span style=color:#f92672>+</span> an_ <span style=color:#f92672>*</span> (T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]<span style=color:#f92672>*</span>T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>]) );
</span></span><span style=display:flex><span>            <span style=color:#75715e>// æœ€åä¸€æ–¹ç¨‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            d[m <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> ( (ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                              <span style=color:#f92672>+</span> vn_ <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>+</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>/</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>                              <span style=color:#f92672>-</span> an_ <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>3.0</span> <span style=color:#f92672>*</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span>])) <span style=color:#f92672>*</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 4. æ±‚è§£ä¸‰å¯¹è§’ç³»ç»Ÿï¼Œå¾—åˆ°å†…éƒ¨ Ï‰ï¼ˆè®°ä¸º w_interiorï¼‰ï¼Œå†æ„é€ å®Œæ•´ Ï‰ å‘é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> w_interior <span style=color:#f92672>=</span> solveTridiagonal(a, b, c, d);
</span></span><span style=display:flex><span>        w_.resize(N);
</span></span><span style=display:flex><span>        w_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> a0_;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> m; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>            w_[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> w_interior[i];
</span></span><span style=display:flex><span>        w_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> an_;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5. æ ¹æ®è¾¹ç•Œæ¡ä»¶â€œä¿®æ­£â€ä¸¤ä¸ªè¾…åŠ©ç‚¹çš„ q å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        ext_q_[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> ext_q_[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>v0_ <span style=color:#f92672>+</span> (T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>a0_) <span style=color:#f92672>/</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> (T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>T_[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span>w_[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>        ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> ext_q_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]<span style=color:#f92672>*</span>vn_ <span style=color:#f92672>+</span> (T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]<span style=color:#f92672>*</span>T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]<span style=color:#f92672>*</span>an_) <span style=color:#f92672>/</span> <span style=color:#ae81ff>3.0</span> <span style=color:#f92672>+</span> (T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]<span style=color:#f92672>*</span>T_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]<span style=color:#f92672>*</span>w_[N <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>]) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 6. å¯¹æ¯ä¸€æ®µ [ext_t_[i], ext_t_[i+1]] è®¡ç®—ä¸‰æ¬¡å¤šé¡¹å¼ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        size_t segs <span style=color:#f92672>=</span> N <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        a0_coef_.resize(segs);
</span></span><span style=display:flex><span>        a1_coef_.resize(segs);
</span></span><span style=display:flex><span>        a2_coef_.resize(segs);
</span></span><span style=display:flex><span>        a3_coef_.resize(segs);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> segs; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            a0_coef_[i] <span style=color:#f92672>=</span> ext_q_[i];
</span></span><span style=display:flex><span>            a1_coef_[i] <span style=color:#f92672>=</span> (ext_q_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> ext_q_[i]) <span style=color:#f92672>/</span> T_[i] <span style=color:#f92672>-</span> T_[i]<span style=color:#f92672>*</span>(w_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>w_[i]) <span style=color:#f92672>/</span> <span style=color:#ae81ff>6.0</span>;
</span></span><span style=display:flex><span>            a2_coef_[i] <span style=color:#f92672>=</span> w_[i] <span style=color:#f92672>/</span> <span style=color:#ae81ff>2.0</span>;
</span></span><span style=display:flex><span>            a3_coef_[i] <span style=color:#f92672>=</span> (w_[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> w_[i]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>6.0</span> <span style=color:#f92672>*</span> T_[i]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        computed_ <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åœ¨ä»»æ„æŸ¥è¯¢æ—¶é—´ t_query å†…è®¡ç®—æ ·æ¡æ’å€¼ï¼ˆä½ç½®ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluate</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline()!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (t_query <span style=color:#f92672>&lt;</span> ext_t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> ext_t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºèŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findSegment(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> ext_t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a0_coef_[i] <span style=color:#f92672>+</span> a1_coef_[i]<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> a2_coef_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> a3_coef_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä¸€é˜¶å¯¼ï¼ˆé€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluateDerivative</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline()!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (t_query <span style=color:#f92672>&lt;</span> ext_t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> ext_t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºèŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findSegment(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> ext_t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a1_coef_[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>a2_coef_[i]<span style=color:#f92672>*</span>dt <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.0</span><span style=color:#f92672>*</span>a3_coef_[i]<span style=color:#f92672>*</span>dt<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// äºŒé˜¶å¯¼ï¼ˆåŠ é€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>evaluateSecondDerivative</span>(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>computed_)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> runtime_error(<span style=color:#e6db74>&#34;è¯·å…ˆè°ƒç”¨ computeSpline()!&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (t_query <span style=color:#f92672>&lt;</span> ext_t_.front() <span style=color:#f92672>||</span> t_query <span style=color:#f92672>&gt;</span> ext_t_.back())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> out_of_range(<span style=color:#e6db74>&#34;æŸ¥è¯¢æ—¶é—´è¶…å‡ºèŒƒå›´!&#34;</span>);
</span></span><span style=display:flex><span>        size_t i <span style=color:#f92672>=</span> findSegment(t_query);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> t_query <span style=color:#f92672>-</span> ext_t_[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>a2_coef_[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span><span style=color:#f92672>*</span>a3_coef_[i]<span style=color:#f92672>*</span>dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// äºŒåˆ†æŸ¥æ‰¾ï¼šè¿”å›æ»¡è¶³ ext_t_[i] &lt;= t_query &lt;= ext_t_[i+1] çš„åŒºé—´ä¸‹æ ‡ i
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    size_t findSegment(<span style=color:#66d9ef>double</span> t_query) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> it <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>upper_bound(ext_t_.begin(), ext_t_.end(), t_query);
</span></span><span style=display:flex><span>        size_t idx <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>distance(ext_t_.begin(), it);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (idx <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (idx <span style=color:#f92672>&gt;=</span> ext_t_.size())
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ext_t_.size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> idx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åŸå§‹æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> orig_t_, orig_q_;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ‰©å±•åçš„èŠ‚ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> ext_t_, ext_q_;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å„æ®µé—´éš” T
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> T_;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è¾¹ç•Œæ¡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> v0_, vn_, a0_, an_;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ±‚è§£å¾—åˆ°çš„è¾…åŠ©å˜é‡ Ï‰ï¼ˆé•¿åº¦ = æ‰©å±•èŠ‚ç‚¹æ•°ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> w_;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ¯æ®µä¸‰æ¬¡å¤šé¡¹å¼ç³»æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> a0_coef_, a1_coef_, a2_coef_, a3_coef_;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>bool</span> computed_ <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ä¸»å‡½æ•°ï¼šæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ CubicSplineBoundary ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e>//======================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ç¤ºä¾‹æ•°æ®ï¼ˆä¸æ–‡ä¸­ MATLAB ç¤ºä¾‹ç±»ä¼¼ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> t <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>18</span>};  <span style=color:#75715e>// åŸå§‹æ—¶é—´èŠ‚ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> q <span style=color:#f92672>=</span> {<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>};   <span style=color:#75715e>// åŸå§‹ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> v0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span>;   <span style=color:#75715e>// èµ·å§‹é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> vn <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>3.0</span>;  <span style=color:#75715e>// ç»“æŸé€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> a0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;   <span style=color:#75715e>// èµ·å§‹åŠ é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> an <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;   <span style=color:#75715e>// ç»“æŸåŠ é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> deltaT <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.001</span>;  <span style=color:#75715e>// æ’å€¼æ­¥é•¿
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        CubicSplineBoundary spline;
</span></span><span style=display:flex><span>        spline.setPoints(t, q);
</span></span><span style=display:flex><span>        spline.setBoundaryConditions(v0, vn, a0, an);
</span></span><span style=display:flex><span>        spline.computeSpline();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ç¤ºä¾‹ï¼šä»¥ 0.01 ç§’æ­¥é•¿è¾“å‡ºéƒ¨åˆ†æ’å€¼ç»“æœ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> t_start <span style=color:#f92672>=</span> spline.evaluate( t.front() ); <span style=color:#75715e>// ä»…ä¸ºç¤ºä¾‹ï¼Œå®é™…åº”åœ¨ [ext_t[0], ext_t.back()]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;éƒ¨åˆ†æ ·æ¡æ’å€¼ç»“æœï¼š&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>double</span> time <span style=color:#f92672>=</span> t.front(); time <span style=color:#f92672>&lt;=</span> t.back(); time <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.01</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> pos <span style=color:#f92672>=</span> spline.evaluate(time);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> vel <span style=color:#f92672>=</span> spline.evaluateDerivative(time);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>double</span> acc <span style=color:#f92672>=</span> spline.evaluateSecondDerivative(time);
</span></span><span style=display:flex><span>            cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;t = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> time <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, pos = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> pos
</span></span><span style=display:flex><span>                 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, vel = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> vel <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, acc = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> acc <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span> (<span style=color:#66d9ef>const</span> exception <span style=color:#f92672>&amp;</span>e) {
</span></span><span style=display:flex><span>        cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;é”™è¯¯: &#34;</span> <span style=color:#f92672>&lt;&lt;</span> e.what() <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h3 id=ä»£ç è¯´æ˜-3>ä»£ç è¯´æ˜</h3><ol><li><p><strong>Thomas ç®—æ³•å‡½æ•°</strong><br>å‡½æ•° <code>solveTridiagonal</code> å®ç°äº†æ ‡å‡†è¿½èµ¶æ³•ï¼Œç”¨äºæ±‚è§£å½¢å¦‚<br></p>$$
a_i\,x_{i-1}+b_i\,x_i+c_i\,x_{i+1}=d_i
$$<p>çš„ä¸‰å¯¹è§’ç³»ç»Ÿï¼ˆè¦æ±‚ $a[0]=0,\; c[n-1]=0$ï¼‰ã€‚</p></li><li><p><strong>ç±» CubicSplineBoundary</strong></p><ul><li><strong>æ•°æ®æ‰©å±•</strong>ï¼šåœ¨åŸå§‹èŠ‚ç‚¹åºåˆ—ä¸­ï¼Œåœ¨ç¬¬ä¸€æ®µä¸æœ€åä¸€æ®µåˆ†åˆ«æ’å…¥è¾…åŠ©ç‚¹ï¼ˆå–ç›¸é‚»ç‚¹çš„ä¸­ç‚¹ï¼‰ï¼Œæ„é€ æ‰©å±•åçš„æ—¶é—´ä¸ä½ç½®å‘é‡ã€‚</li><li><strong>æ„é€ ä¸‰å¯¹è§’ç³»ç»Ÿ</strong>ï¼šæ ¹æ®ç»™å®šçš„è¾¹ç•Œé€Ÿåº¦ $v_0, v_n$ åŠåŠ é€Ÿåº¦ $a_0, a_n$ ï¼Œæ„é€ ç³»ç»Ÿæ±‚è§£å†…éƒ¨è¾…åŠ©å˜é‡ $\omega$ï¼ˆè®°ä¸º wï¼‰ï¼Œè¯¦ç»†ç³»æ•°å‚è€ƒæ³¨é‡Šã€‚</li><li><strong>è®¡ç®—å¤šé¡¹å¼ç³»æ•°</strong>ï¼šåˆ©ç”¨æ±‚å¾—çš„ $\omega$ åŠæ‰©å±•èŠ‚ç‚¹ï¼Œè®¡ç®—æ¯æ®µå¤šé¡¹å¼çš„ 4 ä¸ªç³»æ•°ã€‚</li><li><strong>æ’å€¼æ¥å£</strong>ï¼š<code>evaluate</code>ã€<code>evaluateDerivative</code>ã€<code>evaluateSecondDerivative</code> åˆ†åˆ«ç”¨äºè®¡ç®—ç»™å®šæ—¶åˆ»å¤„çš„ä½ç½®ã€é€Ÿåº¦ä¸åŠ é€Ÿåº¦ã€‚</li></ul></li><li><p><strong>ä¸»å‡½æ•°</strong><br>æ¼”ç¤ºå¦‚ä½•è®¾ç½®æ•°æ®ã€è¾¹ç•Œæ¡ä»¶å¹¶è°ƒç”¨ <code>computeSpline()</code> åï¼Œåœ¨æ•´ä¸ªæ—¶é—´åŒºé—´å†…ä»¥ä¸€å®šæ­¥é•¿è¾“å‡ºæ’å€¼ç»“æœã€‚</p></li></ol><p>è¯¥ä»£ç ä¸ºæ¨¡å—åŒ–å®ç°ï¼Œå¯æ ¹æ®éœ€è¦é›†æˆåˆ°å…¶å®ƒå·¥ç¨‹ä¸­ï¼›å¦‚éœ€ç»˜å›¾ï¼Œå¯å°†æ’å€¼æ•°æ®å¯¼å‡ºæˆ–åˆ©ç”¨å›¾å½¢åº“è¿›è¡Œæ˜¾ç¤ºã€‚</p><footer class=footline><i class='fa-fw fas fa-calendar'></i> 2025-05-21</footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo href=/index.html><img src=/images/logo.png alt="FlitSoft Docs" style=width:80px;height:auto></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class=default-animation><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li class=parent data-nav-id=/uas/index.html><a class=padding href=/uas/index.html>UAS</a><ul id=R-subsections-50d6e18f3c774adcdf96c62beb3fb9ae class=collapsible-menu><li class=alwaysopen data-nav-id=/uas/fix_wing_uav_flight_sim/index.html><a class=padding href=/uas/fix_wing_uav_flight_sim/index.html>Aerodynamics</a><ul id=R-subsections-7b1f39252932eb84ff7bebd53dbcc7d4 class=collapsible-menu></ul></li><li class=alwaysopen data-nav-id=/uas/path-searching/index.html><a class=padding href=/uas/path-searching/index.html>Path Searching</a><ul id=R-subsections-a2b409e9d066676ed37742c4805a3eb9 class=collapsible-menu></ul></li><li class=alwaysopen data-nav-id=/uas/formation-control/index.html><a class=padding href=/uas/formation-control/index.html>Formation Control</a><ul id=R-subsections-e4f6444dc383e8d177ba6adc0bda1264 class=collapsible-menu></ul></li><li class=alwaysopen data-nav-id=/uas/velocity_plan/index.html><a class=padding href=/uas/velocity_plan/index.html>Velocity Planning</a><ul id=R-subsections-60d9350f137676e977a8a40fa195d7e5 class=collapsible-menu></ul></li><li class="parent alwaysopen" data-nav-id=/uas/trajectory_planning/index.html><a class=padding href=/uas/trajectory_planning/index.html>Trajectory Planning</a><ul id=R-subsections-abf2bea1fe96559e28880644014fc77f class=collapsible-menu><li class=alwaysopen data-nav-id=/uas/trajectory_planning/kappa-trajectories/index.html><a class=padding href=/uas/trajectory_planning/kappa-trajectories/index.html>kappa-trajectories</a><ul id=R-subsections-c34eb329cf91796dd769d884d1459d57 class=collapsible-menu></ul></li><li class="parent alwaysopen" data-nav-id=/uas/trajectory_planning/cubic-polynomial-curve/index.html><a class=padding href=/uas/trajectory_planning/cubic-polynomial-curve/index.html>Cubic Polynomial Spline</a><ul id=R-subsections-95972cb64a08a1e88f5026ae53f843fa class=collapsible-menu><li class=active data-nav-id=/uas/trajectory_planning/cubic-polynomial-curve/cubic-polynomial-curve-trajectory/index.html><a class=padding href=/uas/trajectory_planning/cubic-polynomial-curve/cubic-polynomial-curve-trajectory/index.html>ç”¨äºè½¨è¿¹è§„åˆ’çš„ä¸‰æ¬¡æ ·æ¡æ’å€¼</a></li></ul></li><li class=alwaysopen data-nav-id=/uas/trajectory_planning/-b-spline/index.html><a class=padding href=/uas/trajectory_planning/-b-spline/index.html>B-Spline</a><ul id=R-subsections-80147b129cdcaa696867429ae0fd4a12 class=collapsible-menu></ul></li><li data-nav-id=/uas/trajectory_planning/key-of-trajectory-manage/index.html><a class=padding href=/uas/trajectory_planning/key-of-trajectory-manage/index.html>è½¨è¿¹ç®¡ç†çš„å‡ ä¸ªå…³é”®é—®é¢˜</a></li></ul></li></ul></li><li data-nav-id=/em/index.html><a class=padding href=/em/index.html>EM</a><ul id=R-subsections-5221d921411ef33ede36c0310590339e class=collapsible-menu></ul></li><li data-nav-id=/agi/index.html><a class=padding href=/agi/index.html>AI</a><ul id=R-subsections-b697951847df19851ae8635cac95c15a class=collapsible-menu></ul></li><li data-nav-id=/gaming/index.html><a class=padding href=/gaming/index.html>Gaming</a></li><li data-nav-id=/c2/index.html><a class=padding href=/c2/index.html>C2</a><ul id=R-subsections-e0126222f5f1b52fd67c95ccf5ad1c18 class=collapsible-menu></ul></li><li data-nav-id=/simu/index.html><a class=padding href=/simu/index.html>Simulation</a><ul id=R-subsections-80cfed847676c641fa01f11f3f2904bf class=collapsible-menu></ul></li><li data-nav-id=/visual/index.html><a class=padding href=/visual/index.html>Visualization</a><ul id=R-subsections-080a96fba97ea97926a463e36c9cb108 class=collapsible-menu></ul></li><li data-nav-id=/log/index.html><a class=padding href=/log/index.html>Log</a></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul><li class=R-variantswitcher><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Theme</label>
<select id=R-select-variant><option id=R-select-variant-zen-light value=zen-light selected>Zen Light</option><option id=R-select-variant-zen-dark value=zen-dark>Zen Dark</option></select></div><div class=clear></div></div><script>window.relearn.markVariant()</script></li></ul></div><div id=R-footer><p>Built By FlitSoft</p></div></div></aside><script src=/js/clipboard/clipboard.min.js?1750837026 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1750837026 defer></script><script>window.MathJax=Object.assign(window.MathJax||{},{tex:{inlineMath:[["\\(","\\)"],["$","$"]],displayMath:[["\\[","\\]"],["$$","$$"]]},options:{enableMenu:!1}},JSON.parse("{}"))</script><script id=MathJax-script async src=/js/mathjax/tex-mml-chtml.js?1750837026></script><script src=/js/theme.min.js?1750837026 defer></script></body></html>