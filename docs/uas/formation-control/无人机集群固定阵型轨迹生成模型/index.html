<!doctype html><html lang=zh-cn dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.147.3"><meta name=generator content="Relearn 7.6.1+4407b4364ab6f7477f7671fbd20c0494bade40ee"><meta name=description content="ç”Ÿæˆé›†ç¾¤ä¸­æ¯ä¸ªæ— äººæœºå½¢æˆå›ºå®šé˜µå‹çš„æœŸæœ›è½¨è¿¹"><meta name=author content="ä½ çš„åå­—"><meta name=twitter:card content="summary"><meta name=twitter:title content="æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹ :: FlitSoft Docs"><meta name=twitter:description content="ç”Ÿæˆé›†ç¾¤ä¸­æ¯ä¸ªæ— äººæœºå½¢æˆå›ºå®šé˜µå‹çš„æœŸæœ›è½¨è¿¹"><meta property="og:url" content="https://hill68.github.io/uas/formation-control/%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%9B%86%E7%BE%A4%E5%9B%BA%E5%AE%9A%E9%98%B5%E5%9E%8B%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/index.html"><meta property="og:site_name" content="FlitSoft Docs"><meta property="og:title" content="æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹ :: FlitSoft Docs"><meta property="og:description" content="ç”Ÿæˆé›†ç¾¤ä¸­æ¯ä¸ªæ— äººæœºå½¢æˆå›ºå®šé˜µå‹çš„æœŸæœ›è½¨è¿¹"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="UAS"><meta property="article:published_time" content="2025-05-21T17:07:50+08:00"><meta property="article:modified_time" content="2025-05-21T17:07:50+08:00"><meta itemprop=name content="æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹ :: FlitSoft Docs"><meta itemprop=description content="ç”Ÿæˆé›†ç¾¤ä¸­æ¯ä¸ªæ— äººæœºå½¢æˆå›ºå®šé˜µå‹çš„æœŸæœ›è½¨è¿¹"><meta itemprop=datePublished content="2025-05-21T17:07:50+08:00"><meta itemprop=dateModified content="2025-05-21T17:07:50+08:00"><meta itemprop=wordCount content="4275"><title>æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹ :: FlitSoft Docs</title>
<link href=/images/logo.png?1750251247 rel=icon type=image/png><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1750251247 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1750251247 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1750251247 rel=stylesheet><link href=/css/theme.min.css?1750251247 rel=stylesheet><link href=/css/format-html.min.css?1750251247 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1750251247 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1750251247 defer></script><script src=/js/lunr/lunr.min.js?1750251247 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1750251247 defer></script><script src=/js/lunr/lunr.multi.min.js?1750251247 defer></script><script src=/js/lunr/lunr.zh.min.js?1750251247 defer></script><script src=/js/search.min.js?1750251247 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/uas/formation-control/%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%9B%86%E7%BE%A4%E5%9B%BA%E5%AE%9A%E9%98%B5%E5%9E%8B%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/index.html",window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://hill68.github.io",window.relearn.contentLangs=["zh"],window.relearn.index_js_url="/searchindex.en.js?1750251247",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.relearn.themevariants=["zen-light","zen-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/css/custom.css?1750251247 rel=stylesheet></head><body class="mobile-support html" data-url=/uas/formation-control/%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%9B%86%E7%BE%A4%E5%9B%BA%E5%AE%9A%E9%98%B5%E5%9E%8B%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#1-æ•°å­¦æ¨¡å‹>1. æ•°å­¦æ¨¡å‹</a><ul><li><a href=#11-ä¸»è¦å˜é‡å®šä¹‰>1.1 ä¸»è¦å˜é‡å®šä¹‰</a></li><li><a href=#12-åŠ¨æ€çº¦æŸæ‰©å±•å¯é€‰>1.2 åŠ¨æ€çº¦æŸæ‰©å±•ï¼ˆå¯é€‰ï¼‰</a></li></ul></li><li><a href=#2-æ¨¡å‹å®ç°æµç¨‹>2. æ¨¡å‹å®ç°æµç¨‹</a><ul><li><a href=#21-æ¨¡å‹æ¡†æ¶>2.1 æ¨¡å‹æ¡†æ¶</a></li><li><a href=#22-ä¼ªä»£ç ç¤ºä¾‹>2.2 ä¼ªä»£ç ç¤ºä¾‹</a></li></ul></li><li><a href=#3-æ¨¡å‹è¯´æ˜>3. æ¨¡å‹è¯´æ˜</a></li><li><a href=#4-cä»£ç å®ç°å‚è€ƒ>4. C++ä»£ç å®ç°å‚è€ƒ</a><ul><li><a href=#41-chatgpt-o3-mini-high>4.1 ChatGPT o3-mini-high</a></li><li><a href=#42-claude-35-sonnet>4.2 Claude 3.5 Sonnet</a></li></ul></li><li><a href=#é™„å½•1-è½¨è¿¹è·Ÿè¸ªå®ç°å‚è€ƒç¤ºä¾‹>é™„å½•1. è½¨è¿¹è·Ÿè¸ªå®ç°å‚è€ƒç¤ºä¾‹</a><ul><li><a href=#1-æŒ‰æ­¥è¿›ä»¿çœŸçš„åŸºæœ¬æµç¨‹>1. æŒ‰æ­¥è¿›ä»¿çœŸçš„åŸºæœ¬æµç¨‹</a></li><li><a href=#2-chatgpt-o3-mini-high-ç¤ºä¾‹ä»£ç c>2. ChatGPT o3-mini-high ç¤ºä¾‹ä»£ç ï¼ˆC++ï¼‰</a></li><li><a href=#3-claude-35-sonnet-ç¤ºä¾‹ä»£ç c>3. Claude 3.5 Sonnet ç¤ºä¾‹ä»£ç ï¼ˆC++ï¼‰</a></li></ul></li><li><a href=#é™„å½•2-é˜µå‹è¿‡æ¸¡è¿‡ç¨‹ä¸­éœ€æ³¨æ„çš„é—®é¢˜>é™„å½•2. é˜µå‹è¿‡æ¸¡è¿‡ç¨‹ä¸­éœ€æ³¨æ„çš„é—®é¢˜</a><ul><li><a href=#1-ä»»åŠ¡åˆ†é…ä¸ç›®æ ‡åŒ¹é…>1. ä»»åŠ¡åˆ†é…ä¸ç›®æ ‡åŒ¹é…</a></li><li><a href=#2-è¿‡æ¸¡è½¨è¿¹ç”Ÿæˆ>2. è¿‡æ¸¡è½¨è¿¹ç”Ÿæˆ</a></li><li><a href=#3-ç¢°æ’é¿å…ç­–ç•¥>3. ç¢°æ’é¿å…ç­–ç•¥</a></li><li><a href=#4-åœ¨çº¿è°ƒæ•´ä¸åé¦ˆæ§åˆ¶>4. åœ¨çº¿è°ƒæ•´ä¸åé¦ˆæ§åˆ¶</a></li></ul></li><li><a href=#é™„å½•3-é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ä¿è¯è·Ÿè¸ªå‰æ–¹çš„è½¨è¿¹ç‚¹>é™„å½•3. é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ä¿è¯è·Ÿè¸ªå‰æ–¹çš„è½¨è¿¹ç‚¹</a><ul><li><a href=#1-æ€»ä½“æ€è·¯>1 æ€»ä½“æ€è·¯</a></li><li><a href=#2-å…·ä½“å®æ–½æ­¥éª¤>2. å…·ä½“å®æ–½æ­¥éª¤</a></li><li><a href=#3-ç¤ºä¾‹å®ç°cä¼ªä»£ç >3. ç¤ºä¾‹å®ç°ï¼ˆC++ä¼ªä»£ç ï¼‰</a></li></ul></li><li><a href=#é™„å½•4-ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨>é™„å½•4. ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨</a><ul><li><a href=#1-åŸºæœ¬åŸç†>1. åŸºæœ¬åŸç†</a></li><li><a href=#2-æ•°å­¦æ¨¡å‹å’Œé¢‘ç‡å“åº”>2. æ•°å­¦æ¨¡å‹å’Œé¢‘ç‡å“åº”</a></li><li><a href=#3-windowsize-çš„é€‰å–>3. windowSize çš„é€‰å–</a></li><li><a href=#4-ä¼˜ç‚¹ä¸ç¼ºç‚¹>4. ä¼˜ç‚¹ä¸ç¼ºç‚¹</a></li><li><a href=#5-åº”ç”¨åœºæ™¯>5. åº”ç”¨åœºæ™¯</a></li><li><a href=#6-c-ä»£ç ç¤ºä¾‹>6. C++ ä»£ç ç¤ºä¾‹</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>FlitSoft Docs</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/uas/index.html><span itemprop=name>UAS</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/uas/formation-control/index.html><span itemprop=name>Formation Control</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/uas/formation-control/%E5%9F%BA%E4%BA%8E%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%E6%8E%A7%E5%88%B6%E7%9A%84%E6%97%A0%E4%BA%BA%E6%9C%BA%E7%BC%96%E9%98%9F%E9%A3%9E%E8%A1%8C/index.html title="åŸºäºéçº¿æ€§æ¨¡å‹é¢„æµ‹æ§åˆ¶çš„æ— äººæœºç¼–é˜Ÿé£è¡Œ (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/uas/formation-control/%E5%9B%BA%E5%AE%9A%E7%BF%BC%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%98%B5%E5%9E%8B%E5%8F%98%E6%8D%A2%E8%BF%87%E6%B8%A1%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90/index.html title="å›ºå®šç¿¼æ— äººæœºé˜µå‹å˜æ¢è¿‡æ¸¡è½¨è¿¹ç”Ÿæˆ (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable uas" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹>æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹</h1><p>ç‰ˆæœ¬ï¼šv2.0</p><h2 id=1-æ•°å­¦æ¨¡å‹>1. æ•°å­¦æ¨¡å‹</h2><h3 id=11-ä¸»è¦å˜é‡å®šä¹‰>1.1 ä¸»è¦å˜é‡å®šä¹‰</h3><ul><li><p><strong>é¢†èˆªæœºçŠ¶æ€</strong></p><ul><li>$ P_L(t) = \begin{bmatrix} x_L(t) \\ y_L(t) \end{bmatrix} $ï¼šé¢†èˆªæœºåœ¨å…¨å±€åæ ‡ä¸‹çš„ä½ç½®ï¼ˆå¯ä»¥æ˜¯ç¦»æ•£æ—¶é—´ç‚¹åºåˆ—æˆ–è¿ç»­å‡½æ•°ï¼‰ã€‚</li><li>$ \theta(t) $ï¼šé¢†èˆªæœºçš„èˆªå‘è§’ã€‚</li></ul></li><li><p><strong>æ—‹è½¬çŸ©é˜µ</strong><br>ä¸ºå°†å±€éƒ¨åç§»è½¬æ¢ä¸ºå…¨å±€åæ ‡ï¼Œå®šä¹‰æ—‹è½¬çŸ©é˜µï¼š</p>$$
R(\theta(t)) = \begin{bmatrix}
\cos \theta(t) & -\sin \theta(t) \\
  \sin \theta(t) & \cos \theta(t)
  \end{bmatrix}.
 $$</li><li><p><strong>å±€éƒ¨åç§»å‘é‡</strong><br>å¯¹äºæ¯ä¸ªè·Ÿéš UAV $i$ï¼Œåœ¨é¢†èˆªæœºå±€éƒ¨åæ ‡ç³»ä¸­é¢„å…ˆè®¾è®¡ä¸€ä¸ªç›¸å¯¹åç§»å‘é‡ï¼š</p>$$
\Delta_i = \begin{bmatrix} \Delta_{i,x} \\ \Delta_{i,y} \end{bmatrix}.
$$<ul><li><p>å¯¹äº<strong>çº¿å‹é˜µå‹</strong>ï¼Œå¯å®šä¹‰ï¼š</p>$$
\Delta_i = \begin{bmatrix} 0 \\ i \times d \end{bmatrix} \quad \text{æˆ–} \quad \Delta_i = \begin{bmatrix} i \times d_x \\ i \times d_y \end{bmatrix},
$$<p>å…¶ä¸­ $d$ï¼ˆæˆ– $d_x, d_y$ï¼‰ä¸ºé¢„è®¾é—´éš”ï¼Œæ­£è´Ÿå·å†³å®šä¾§è¾¹ã€‚</p></li><li><p>å¯¹äº<strong>æ¥”å½¢é˜µå‹</strong>ï¼ˆå·¦å³å¯¹ç§°ï¼‰ï¼š</p>$$
\Delta_{i,\text{å·¦}} = \begin{bmatrix} i\,d_x \\ i\,d_y \end{bmatrix}, \quad
\Delta_{i,\text{å³}} = \begin{bmatrix} i\,d_x \\ -i\,d_y \end{bmatrix}, \quad i=1,2,\ldots
$$</li></ul></li><li><p><strong>è·Ÿéš UAV å…¨å±€æœŸæœ›ä½ç½®</strong><br>æ ¹æ®é¢†èˆªæœºçš„ä½ç½®ä¸èˆªå‘ï¼Œä»¥åŠå±€éƒ¨åç§»ï¼Œå¾—åˆ° UAV $i$ çš„å…¨å±€æœŸæœ›ä½ç½®ï¼š</p>$$
P_i(t) = P_L(t) + R\big(\theta(t)\big) \Delta_i.
$$</li></ul><h3 id=12-åŠ¨æ€çº¦æŸæ‰©å±•å¯é€‰>1.2 åŠ¨æ€çº¦æŸæ‰©å±•ï¼ˆå¯é€‰ï¼‰</h3><p>å¦‚æœéœ€è¦è€ƒè™‘ UAV çš„è¿åŠ¨å­¦ä¸åŠ¨åŠ›å­¦é™åˆ¶ï¼Œå¯å¼•å…¥ UAV çš„çŠ¶æ€å˜é‡å’ŒåŠ¨åŠ›å­¦æ¨¡å‹ã€‚ä»¥ç®€å•çš„å¹³é¢è¿åŠ¨æ¨¡å‹ä¸ºä¾‹ï¼š</p><ul><li>UAV $i$ çŠ¶æ€ï¼š$ X_i = \begin{bmatrix} x_i,\, y_i,\, \theta_i,\, v_i \end{bmatrix}^\top $</li><li>åŠ¨åŠ›å­¦æ¨¡å‹ï¼š
$$
\begin{cases}
\dot{x}_i = v_i \cos \theta_i, \\
\dot{y}_i = v_i \sin \theta_i, \\
\dot{\theta}_i = u_i,
\end{cases}
$$
å…¶ä¸­ $u_i$ ä¸ºæ§åˆ¶è¾“å…¥ï¼ˆè½¬å‘è§’é€Ÿç‡ï¼‰ã€‚è®¾è®¡åˆé€‚çš„è·Ÿè¸ªæ§åˆ¶å™¨ï¼Œä½¿å¾— UAV $i$ èƒ½å¤Ÿè·Ÿè¸ªå‚è€ƒè½¨è¿¹ $P_i(t)$ å¹¶æ»¡è¶³è½¬å¼¯åŠå¾„ã€åŠ é€Ÿåº¦ç­‰çº¦æŸã€‚</li></ul><hr><h2 id=2-æ¨¡å‹å®ç°æµç¨‹>2. æ¨¡å‹å®ç°æµç¨‹</h2><h3 id=21-æ¨¡å‹æ¡†æ¶>2.1 æ¨¡å‹æ¡†æ¶</h3><ol><li><p><strong>è¾“å…¥æ•°æ®</strong></p><ul><li>é¢†èˆªæœºè½¨è¿¹ $ P_L(t) $ å’Œèˆªå‘ $ \theta(t) $ã€‚</li><li>é˜µå‹å‚æ•°ï¼ˆç±»å‹ã€æ— äººæœºæ•°é‡ã€é—´è·å‚æ•°ç­‰ï¼‰ã€‚</li></ul></li><li><p><strong>å±€éƒ¨åç§»ç”Ÿæˆ</strong><br>æ ¹æ®é˜µå‹å‚æ•°ï¼Œä¸ºæ¯ä¸ª UAV $i$ è®¡ç®—å±€éƒ¨åç§» $ \Delta_i $ã€‚<br>ä¾‹å¦‚ï¼š</p><ul><li>çº¿å‹é˜µå‹ï¼š$\Delta_i = \begin{bmatrix} 0 \\ i \times d \end{bmatrix}$</li><li>æ¥”å½¢é˜µå‹ï¼šæ ¹æ®å·¦å³åˆ†æ”¯åˆ†åˆ«è®¡ç®— $\Delta_{i,\text{å·¦}}$ ä¸ $\Delta_{i,\text{å³}}$ã€‚</li></ul></li><li><p><strong>å…¨å±€åæ ‡è½¬æ¢</strong><br>å¯¹äºæ¯ä¸ª UAV $i$ åœ¨æ¯ä¸ªæ—¶åˆ» $t$ï¼Œè®¡ç®—å…¨å±€æœŸæœ›ä½ç½®ï¼š</p>$$
P_i(t) = P_L(t) + R\big(\theta(t)\big) \Delta_i.
$$</li><li><p><strong>è½¨è¿¹å¹³æ»‘ä¸åŠ¨æ€å¯è¡Œæ€§å¤„ç†</strong></p><ul><li>å¯¹ç›´æ¥è®¡ç®—å‡ºçš„ç¦»æ•£è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†ï¼ˆå¦‚æ ·æ¡æ’å€¼ã€BÃ©zier æ›²çº¿æ‹Ÿåˆç­‰ï¼‰ã€‚</li><li>æ ¹æ® UAV çš„è¿åŠ¨å­¦å’ŒåŠ¨åŠ›å­¦çº¦æŸï¼Œé€šè¿‡è½¨è¿¹ä¼˜åŒ–æˆ–é—­ç¯æ§åˆ¶å™¨è¿›è¡Œä¿®æ­£ä¸è·Ÿè¸ªã€‚</li></ul></li><li><p><strong>è¾“å‡º</strong><br>ç”Ÿæˆæ‰€æœ‰ UAV çš„æœŸæœ›è½¨è¿¹ï¼Œç”¨äºä¸‹å±‚è·¯å¾„è·Ÿè¸ªæˆ–æ§åˆ¶å™¨æ‰§è¡Œã€‚</p></li></ol><h3 id=22-ä¼ªä»£ç ç¤ºä¾‹>2.2 ä¼ªä»£ç ç¤ºä¾‹</h3><p>ä¸‹é¢çš„ä¼ªä»£ç æè¿°äº†æ•´ä½“æµç¨‹ï¼Œä¾¿äºæ¨¡å‹ç†è§£ä¸å®ç°ï¼š</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># å‡è®¾å·²è·å¾—é¢†èˆªæœºè½¨è¿¹æ•°æ® leader_traj: list of (x, y, theta) å¯¹</span>
</span></span><span style=display:flex><span><span style=color:#75715e># formation_params åŒ…å«é˜µå‹ç±»å‹å’Œç›¸å…³é—´éš”å‚æ•°</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>compute_rotation_matrix</span>(theta):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [[cos(theta), <span style=color:#f92672>-</span>sin(theta)],
</span></span><span style=display:flex><span>            [sin(theta),  cos(theta)]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>formation_offset</span>(i, formation_params, branch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;center&#39;</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    æ ¹æ®é˜µå‹å‚æ•°è®¡ç®—ç¬¬ i æ¶ UAV çš„å±€éƒ¨åç§»ã€‚
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    branch å‚æ•°ç”¨äºæ¥”å½¢é˜µå‹ï¼š&#39;left&#39; æˆ– &#39;right&#39; è¡¨ç¤ºå·¦å³åˆ†æ”¯ï¼Œ
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;center&#39; å¯ç”¨äºçº¿å‹æˆ–å•è¾¹é˜µå‹ã€‚
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> formation_params[<span style=color:#e6db74>&#39;type&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;line&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># ç¤ºä¾‹ï¼šæ‰€æœ‰ UAV æ²¿ä¸€ä¾§ï¼Œé—´éš” d</span>
</span></span><span style=display:flex><span>        d <span style=color:#f92672>=</span> formation_params[<span style=color:#e6db74>&#39;d&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, i <span style=color:#f92672>*</span> d]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> formation_params[<span style=color:#e6db74>&#39;type&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;wedge&#39;</span>:
</span></span><span style=display:flex><span>        d_x <span style=color:#f92672>=</span> formation_params[<span style=color:#e6db74>&#39;d_x&#39;</span>]
</span></span><span style=display:flex><span>        d_y <span style=color:#f92672>=</span> formation_params[<span style=color:#e6db74>&#39;d_y&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> branch <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;left&#39;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [i <span style=color:#f92672>*</span> d_x, i <span style=color:#f92672>*</span> d_y]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> branch <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;right&#39;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [i <span style=color:#f92672>*</span> d_x, <span style=color:#f92672>-</span>i <span style=color:#f92672>*</span> d_y]
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¯æ‰©å±•å…¶ä»–é˜µå‹</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>smooth_trajectory</span>(traj):
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ ¹æ®éœ€æ±‚å¯¹è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ä¾‹å¦‚ä½¿ç”¨æ ·æ¡æ›²çº¿æ‹Ÿåˆ</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> traj  <span style=color:#75715e># æ­¤å¤„ä¸ºå ä½å‡½æ•°</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ä¸»å‡½æ•°ï¼šç”Ÿæˆæ‰€æœ‰ UAV çš„æœŸæœ›è½¨è¿¹</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_formation_trajectories</span>(leader_traj, formation_params, num_followers):
</span></span><span style=display:flex><span>    formation_trajs <span style=color:#f92672>=</span> {i: [] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, num_followers<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (x_L, y_L, theta) <span style=color:#f92672>in</span> leader_traj:
</span></span><span style=display:flex><span>        <span style=color:#75715e># è®¡ç®—æ—‹è½¬çŸ©é˜µ</span>
</span></span><span style=display:flex><span>        R <span style=color:#f92672>=</span> compute_rotation_matrix(theta)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># éå†æ‰€æœ‰ UAV</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, num_followers<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>            <span style=color:#75715e># æ ¹æ®é˜µå‹ç±»å‹ç¡®å®šå±€éƒ¨åç§»ï¼Œæ­¤å¤„ä»¥çº¿å‹ä¸ºä¾‹ï¼Œ</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># è‹¥ä¸ºæ¥”å½¢é˜µå‹ï¼Œåˆ™éœ€è¦åŒºåˆ†å·¦å³åˆ†æ”¯</span>
</span></span><span style=display:flex><span>            Delta <span style=color:#f92672>=</span> formation_offset(i, formation_params, branch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;center&#39;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># å…¨å±€åæ ‡è½¬æ¢ï¼šP_follower = P_leader + R * Delta</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># è¿™é‡Œå‡è®¾ R ä¸ Delta å‡ä¸ºåˆ—è¡¨æˆ–æ•°ç»„ï¼Œè¿›è¡ŒçŸ©é˜µå‘é‡ä¹˜æ³•</span>
</span></span><span style=display:flex><span>            P_follower <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>                x_L <span style=color:#f92672>+</span> R[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> Delta[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> R[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> Delta[<span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                y_L <span style=color:#f92672>+</span> R[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> Delta[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> R[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> Delta[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            formation_trajs[i]<span style=color:#f92672>.</span>append(P_follower)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¯¹æ¯ä¸ª UAV çš„è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> formation_trajs:
</span></span><span style=display:flex><span>        formation_trajs[i] <span style=color:#f92672>=</span> smooth_trajectory(formation_trajs[i])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> formation_trajs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç¤ºä¾‹è°ƒç”¨</span>
</span></span><span style=display:flex><span>leader_traj <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e># (x, y, theta) åºåˆ—ï¼Œå®é™…æ•°æ®ç”±ä¼ æ„Ÿå™¨æˆ–è§„åˆ’æ¨¡å—æä¾›</span>
</span></span><span style=display:flex><span>    (<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#75715e># ... æ›´å¤šæ•°æ®</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>formation_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;line&#39;</span>, <span style=color:#e6db74>&#39;d&#39;</span>: <span style=color:#ae81ff>5.0</span>}  <span style=color:#75715e># çº¿å‹é˜µå‹ï¼Œæ¯æ¶ UAV é—´éš” 5 å•ä½</span>
</span></span><span style=display:flex><span>num_followers <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>formation_trajectories <span style=color:#f92672>=</span> generate_formation_trajectories(leader_traj, formation_params, num_followers)</span></span></code></pre></div><hr><h2 id=3-æ¨¡å‹è¯´æ˜>3. æ¨¡å‹è¯´æ˜</h2><ul><li><p><strong>æ¨¡å‹é€šç”¨æ€§</strong><br>è¯¥æ¨¡å‹ç»Ÿä¸€é‡‡ç”¨â€œé¢†èˆªæœºè½¨è¿¹ + å±€éƒ¨åç§»â€æ€æƒ³ï¼Œä¸è®ºé˜µå‹å¦‚ä½•å˜åŒ–ï¼ˆçº¿å‹ã€æ¥”å½¢ã€ç”šè‡³æ›´å¤æ‚çš„é˜µå‹ï¼‰ï¼Œåªéœ€è¦åœ¨å±€éƒ¨åæ ‡ç³»ä¸­è®¾è®¡åˆé€‚çš„ $\Delta_i$ å³å¯ã€‚</p></li><li><p><strong>æ‰©å±•æ€§</strong><br>è¯¥æ¨¡å‹å¯ä»¥æ–¹ä¾¿åœ°æ‰©å±•è‡³è€ƒè™‘ UAV çš„è¿åŠ¨å­¦çº¦æŸã€è·¯å¾„å¹³æ»‘å¤„ç†ã€å®æ—¶åé¦ˆæ§åˆ¶ç­‰é—®é¢˜ï¼Œä½¿å¾—ç”Ÿæˆçš„æœŸæœ›è½¨è¿¹æ—¢å…·å¤‡å‡ ä½•é˜Ÿå½¢è¦æ±‚ï¼Œåˆæ»¡è¶³ UAV çš„åŠ¨æ€æ€§èƒ½ã€‚</p></li><li><p><strong>å®ç°ç»†èŠ‚</strong><br>ç¨‹åºå‘˜åœ¨å®é™…å®ç°æ—¶ï¼Œå¯æ ¹æ®å…·ä½“å¹³å°å’Œéœ€æ±‚æ›¿æ¢å¹³æ»‘ç®—æ³•ã€çŸ©é˜µè¿ç®—åº“ã€æ§åˆ¶å™¨è®¾è®¡éƒ¨åˆ†ç­‰ï¼ŒåŒæ—¶å¯ç»“åˆå®é™…é‡‡æ ·æ—¶é—´ç¦»æ•£åŒ–å¤„ç†ã€‚</p></li></ul><hr><h2 id=4-cä»£ç å®ç°å‚è€ƒ>4. C++ä»£ç å®ç°å‚è€ƒ</h2><h3 id=41-chatgpt-o3-mini-high>4.1 ChatGPT o3-mini-high</h3><p>ä¸‹é¢ç»™å‡º C++ ä»£ç ç¤ºä¾‹ï¼Œå°†ä¸Šè¿°æ•°å­¦æ¨¡å‹å°è£…ä¸ºä¸€ä¸ªç±»ï¼Œä¾¿äºé›†æˆåˆ°å·²æœ‰çš„æ— äººæœºé›†ç¾¤æ§åˆ¶ç³»ç»Ÿä¸­ã€‚ä»£ç ä¸­å®šä¹‰äº†åŸºæœ¬æ•°æ®ç»“æ„ï¼ˆä½ç½®ã€å§¿æ€ã€é˜µå‹å‚æ•°ç­‰ï¼‰ã€æ—‹è½¬æ“ä½œã€å±€éƒ¨åç§»è®¡ç®—ä»¥åŠç”Ÿæˆå…¨å±€æœŸæœ›è½¨è¿¹çš„æµç¨‹ã€‚åŒæ—¶ï¼Œé’ˆå¯¹ä¸åŒé˜µå‹ï¼ˆçº¿å‹ä¸æ¥”å½¢ï¼‰ç»™å‡ºä¸åŒçš„å±€éƒ¨åç§»è®¡ç®—æ–¹æ³•ã€‚å¯ä»¥æ ¹æ®éœ€è¦è¿›ä¸€æ­¥æ‰©å±•å¹³æ»‘å¤„ç†æˆ–åŠ å…¥ UAV çš„åŠ¨æ€çº¦æŸã€‚</p><p>ä¸‹é¢æ˜¯å®Œæ•´ç¤ºä¾‹ä»£ç ï¼š</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------------- æ•°æ®ç»“æ„å®šä¹‰ --------------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// ç”¨äºè¡¨ç¤ºå¹³é¢ä½ç½®ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Point</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// è¡¨ç¤ºæ— äººæœºçš„ä½å§¿ï¼ˆä½ç½®å’Œèˆªå‘è§’ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Pose</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> theta; <span style=color:#75715e>// èˆªå‘è§’ï¼ˆå¼§åº¦åˆ¶ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// æšä¸¾ä¸åŒçš„é˜µå‹ç±»å‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormationType</span> {
</span></span><span style=display:flex><span>    LINE,   <span style=color:#75715e>// çº¿å‹é˜µå‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    WEDGE   <span style=color:#75715e>// æ¥”å½¢é˜µå‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// é˜µå‹å‚æ•°å®šä¹‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>FormationParameters</span> {
</span></span><span style=display:flex><span>    FormationType type;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// çº¿å‹é˜µå‹å‚æ•°ï¼šä¸¤æ¶ UAV é—´çš„å›ºå®šé—´éš”ï¼ˆæ²¿å±€éƒ¨ y è½´æ–¹å‘ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> d;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ¥”å½¢é˜µå‹å‚æ•°ï¼šæ²¿èˆªå‘æ–¹å‘é—´éš” d_x åŠæ¨ªå‘é—´éš” d_y
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> d_x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> d_y;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------------- FormationGenerator ç±» --------------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @brief ç”Ÿæˆè·Ÿéš UAV çš„æœŸæœ›è½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e> *
</span></span></span><span style=display:flex><span><span style=color:#75715e> * åˆ©ç”¨é¢†èˆªæœºè½¨è¿¹å’Œé˜µå‹å‚æ•°ï¼Œåœ¨æ¯ä¸ªæ—¶åˆ»è®¡ç®—æ¯æ¶è·Ÿéš UAV çš„å…¨å±€æœŸæœ›ä½ç½®ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormationGenerator</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @brief æ„é€ å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param leaderTrajectory é¢†èˆªæœºè½¨è¿¹ï¼ˆæ¯ä¸ªæ—¶åˆ»çš„ä½å§¿ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param formationParams é˜µå‹å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param numFollowers è·Ÿéš UAV æ•°é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    FormationGenerator(<span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Pose<span style=color:#f92672>&gt;&amp;</span> leaderTrajectory,
</span></span><span style=display:flex><span>                       <span style=color:#66d9ef>const</span> FormationParameters<span style=color:#f92672>&amp;</span> formationParams,
</span></span><span style=display:flex><span>                       <span style=color:#66d9ef>int</span> numFollowers)
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> leaderTrajectory_(leaderTrajectory),
</span></span><span style=display:flex><span>          formationParams_(formationParams),
</span></span><span style=display:flex><span>          numFollowers_(numFollowers) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @brief ç”Ÿæˆæ‰€æœ‰è·Ÿéš UAV çš„è½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return æ¯ä¸ª UAV çš„è½¨è¿¹ï¼Œå¤–å±‚ vector ä¸‹æ ‡å¯¹åº” UAV åºå·ï¼ˆä» 0 å¼€å§‹ï¼‰ï¼Œå†…å±‚ vector ä¸ºè½¨è¿¹ç‚¹åºåˆ—
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&gt;</span> generate();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Pose<span style=color:#f92672>&gt;</span> leaderTrajectory_;
</span></span><span style=display:flex><span>    FormationParameters formationParams_;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> numFollowers_;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @brief å¯¹äºŒç»´å‘é‡ (dx, dy) æ ¹æ®è§’åº¦ theta è¿›è¡Œæ—‹è½¬
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param dx åŸå‘é‡ x åˆ†é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param dy åŸå‘é‡ y åˆ†é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param theta æ—‹è½¬è§’åº¦ï¼ˆå¼§åº¦åˆ¶ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return æ—‹è½¬åçš„å‘é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    Point <span style=color:#a6e22e>rotatePoint</span>(<span style=color:#66d9ef>double</span> dx, <span style=color:#66d9ef>double</span> dy, <span style=color:#66d9ef>double</span> theta) {
</span></span><span style=display:flex><span>        Point rotated;
</span></span><span style=display:flex><span>        rotated.x <span style=color:#f92672>=</span> dx <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>cos(theta) <span style=color:#f92672>-</span> dy <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>sin(theta);
</span></span><span style=display:flex><span>        rotated.y <span style=color:#f92672>=</span> dx <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>sin(theta) <span style=color:#f92672>+</span> dy <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>cos(theta);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> rotated;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @brief æ ¹æ®é˜µå‹å‚æ•°è®¡ç®—å±€éƒ¨åç§»
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * å¯¹äºçº¿å‹é˜µå‹ï¼Œæ‰€æœ‰ UAV æ²¿å›ºå®šä¾§è¾¹ï¼ˆè¿™é‡Œå‡è®¾åœ¨å±€éƒ¨ y æ­£æ–¹å‘ï¼‰æ’åˆ—ï¼›
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * å¯¹äºæ¥”å½¢é˜µå‹ï¼Œåˆ™æ ¹æ®å·¦å³åˆ†æ”¯åˆ†åˆ«è®¡ç®—åç§»ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param followerIndex å½“å‰ UAV çš„ç¼–å·ï¼ˆä» 1 å¼€å§‹ï¼Œçº¿å‹é˜µå‹æ—¶ç›´æ¥ä½¿ç”¨ï¼›æ¥”å½¢é˜µå‹æ—¶ç”¨æ¥è®¡ç®—æ’åï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param branch å¯¹äºæ¥”å½¢é˜µå‹ï¼Œâ€œleftâ€è¡¨ç¤ºå·¦ä¾§åˆ†æ”¯ï¼Œâ€œrightâ€è¡¨ç¤ºå³ä¾§åˆ†æ”¯ï¼›çº¿å‹é˜µå‹æ—¶å¯ä»¥å¿½ç•¥æ­¤å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return å±€éƒ¨åæ ‡ç³»ä¸­çš„åç§»å‘é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    Point <span style=color:#a6e22e>computeLocalOffset</span>(<span style=color:#66d9ef>int</span> followerIndex, <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string<span style=color:#f92672>&amp;</span> branch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;center&#34;</span>) {
</span></span><span style=display:flex><span>        Point offset{<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>};
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (formationParams_.type <span style=color:#f92672>==</span> FormationType<span style=color:#f92672>::</span>LINE) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// çº¿å‹é˜µå‹ï¼šå‡è®¾æ‰€æœ‰ UAV æ²¿å±€éƒ¨ y æ–¹å‘æ­£ä¾§è¾¹æ’åˆ—
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            offset.x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>            offset.y <span style=color:#f92672>=</span> followerIndex <span style=color:#f92672>*</span> formationParams_.d;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (formationParams_.type <span style=color:#f92672>==</span> FormationType<span style=color:#f92672>::</span>WEDGE) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// æ¥”å½¢é˜µå‹ï¼šåˆ†åˆ«è®¡ç®—å·¦å³åˆ†æ”¯çš„å±€éƒ¨åç§»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (branch <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;left&#34;</span>) {
</span></span><span style=display:flex><span>                offset.x <span style=color:#f92672>=</span> followerIndex <span style=color:#f92672>*</span> formationParams_.d_x;
</span></span><span style=display:flex><span>                offset.y <span style=color:#f92672>=</span> followerIndex <span style=color:#f92672>*</span> formationParams_.d_y;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (branch <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;right&#34;</span>) {
</span></span><span style=display:flex><span>                offset.x <span style=color:#f92672>=</span> followerIndex <span style=color:#f92672>*</span> formationParams_.d_x;
</span></span><span style=display:flex><span>                offset.y <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>followerIndex <span style=color:#f92672>*</span> formationParams_.d_y;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> offset;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @brief å¯¹ç”Ÿæˆçš„è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * ç›®å‰ä¸ºå ä½å‡½æ•°ï¼Œå¯æ ¹æ®éœ€è¦æ›¿æ¢ä¸ºæ ·æ¡ã€BÃ©zier æ›²çº¿ç­‰ç®—æ³•
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param traj åŸå§‹è½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return å¹³æ»‘åçš„è½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;</span> smoothTrajectory(<span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&amp;</span> traj) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ­¤å¤„ç›´æ¥è¿”å›åŸå§‹è½¨è¿¹ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚å®ç°å¹³æ»‘ç®—æ³•
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> traj;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------------- FormationGenerator æ–¹æ³•å®ç° --------------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&gt;</span> FormationGenerator<span style=color:#f92672>::</span>generate() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åˆå§‹åŒ–æ¯æ¶è·Ÿéš UAV çš„è½¨è¿¹ï¼ˆç¼–å·ä» 0 åˆ° numFollowers_-1ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&gt;</span> formationTrajectories(numFollowers_);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å¯¹é¢†èˆªæœºè½¨è¿¹ä¸­çš„æ¯ä¸ªæ—¶åˆ»ï¼Œè®¡ç®—æ‰€æœ‰è·Ÿéš UAV çš„æœŸæœ›ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> leaderPose : leaderTrajectory_) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å¯¹äºæ¯æ¶ UAV
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> numFollowers_; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            Point localOffset;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (formationParams_.type <span style=color:#f92672>==</span> FormationType<span style=color:#f92672>::</span>WEDGE) {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// å¯¹äºæ¥”å½¢é˜µå‹ï¼Œå¸¸é‡‡ç”¨å·¦å³å¯¹ç§°çš„æ–¹å¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#75715e>// ä¾‹å¦‚ï¼šå°† UAV åˆ†ä¸ºå·¦å³ä¸¤æ”¯ï¼ŒæŒ‰ç…§ç´¢å¼•äº¤æ›¿åˆ†é…
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#75715e>// æ­¤å¤„è®¡ç®—æ—¶ï¼Œç”¨ (i/2 + 1) ä½œä¸ºè¯¥åˆ†æ”¯ä¸­çš„æ’å
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>int</span> rank <span style=color:#f92672>=</span> i <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                std<span style=color:#f92672>::</span>string branch <span style=color:#f92672>=</span> (i <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;left&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;right&#34;</span>;
</span></span><span style=display:flex><span>                localOffset <span style=color:#f92672>=</span> computeLocalOffset(rank, branch);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// å¯¹äºçº¿å‹é˜µå‹ï¼Œç›´æ¥ä½¿ç”¨ UAV ç¼–å·ï¼ˆä» 1 å¼€å§‹ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                localOffset <span style=color:#f92672>=</span> computeLocalOffset(i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#34;center&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// å°†å±€éƒ¨åç§»è½¬æ¢åˆ°å…¨å±€åæ ‡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            Point rotated <span style=color:#f92672>=</span> rotatePoint(localOffset.x, localOffset.y, leaderPose.theta);
</span></span><span style=display:flex><span>            Point globalPos;
</span></span><span style=display:flex><span>            globalPos.x <span style=color:#f92672>=</span> leaderPose.x <span style=color:#f92672>+</span> rotated.x;
</span></span><span style=display:flex><span>            globalPos.y <span style=color:#f92672>=</span> leaderPose.y <span style=color:#f92672>+</span> rotated.y;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            formationTrajectories[i].push_back(globalPos);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å¯¹æ¯æ¶ UAV çš„è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> traj : formationTrajectories) {
</span></span><span style=display:flex><span>        traj <span style=color:#f92672>=</span> smoothTrajectory(traj);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> formationTrajectories;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------------- ç¤ºä¾‹ä¸»å‡½æ•° --------------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹ï¼šæ„é€ é¢†èˆªæœºè½¨è¿¹æ•°æ®ï¼ˆå‡è®¾æ¯ä¸ªæ—¶åˆ»çš„ä½å§¿ä¿¡æ¯ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Pose<span style=color:#f92672>&gt;</span> leaderTrajectory <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>10.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>20.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>30.0</span>, <span style=color:#ae81ff>0.0</span>, M_PI <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span>},  <span style=color:#75715e>// è½¬å¼¯ç¤ºä¾‹ï¼Œèˆªå‘å˜ä¸º 30 åº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        {<span style=color:#ae81ff>40.0</span>, <span style=color:#ae81ff>5.0</span>, M_PI <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>}
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ... å¯æ ¹æ®å®é™…æƒ…å†µæ‰©å±•æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹1ï¼šçº¿å‹é˜µå‹ï¼Œé—´éš” 5.0 ä¸ªå•ä½
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    FormationParameters lineParams;
</span></span><span style=display:flex><span>    lineParams.type <span style=color:#f92672>=</span> FormationType<span style=color:#f92672>::</span>LINE;
</span></span><span style=display:flex><span>    lineParams.d <span style=color:#f92672>=</span> <span style=color:#ae81ff>5.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä¾‹å¦‚ï¼Œ3 æ¶è·Ÿéš UAV
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> numFollowers <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>    FormationGenerator lineFormationGenerator(leaderTrajectory, lineParams, numFollowers);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> lineTrajectories <span style=color:#f92672>=</span> lineFormationGenerator.generate();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;çº¿å‹é˜µå‹ç”Ÿæˆçš„è·Ÿéš UAV è½¨è¿¹ï¼š&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> numFollowers; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;UAV &#34;</span> <span style=color:#f92672>&lt;&lt;</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; è½¨è¿¹:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> pt : lineTrajectories[i]) {
</span></span><span style=display:flex><span>            std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;(&#34;</span> <span style=color:#f92672>&lt;&lt;</span> pt.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> pt.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;) &#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç¤ºä¾‹2ï¼šæ¥”å½¢é˜µå‹ï¼Œè®¾ç½® d_x = 3.0, d_y = 2.0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    FormationParameters wedgeParams;
</span></span><span style=display:flex><span>    wedgeParams.type <span style=color:#f92672>=</span> FormationType<span style=color:#f92672>::</span>WEDGE;
</span></span><span style=display:flex><span>    wedgeParams.d_x <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.0</span>;
</span></span><span style=display:flex><span>    wedgeParams.d_y <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    FormationGenerator wedgeFormationGenerator(leaderTrajectory, wedgeParams, numFollowers);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> wedgeTrajectories <span style=color:#f92672>=</span> wedgeFormationGenerator.generate();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>æ¥”å½¢é˜µå‹ç”Ÿæˆçš„è·Ÿéš UAV è½¨è¿¹ï¼š&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> numFollowers; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;UAV &#34;</span> <span style=color:#f92672>&lt;&lt;</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; è½¨è¿¹:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> pt : wedgeTrajectories[i]) {
</span></span><span style=display:flex><span>            std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;(&#34;</span> <span style=color:#f92672>&lt;&lt;</span> pt.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> pt.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;) &#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h4 id=ä»£ç è¯´æ˜>ä»£ç è¯´æ˜</h4><ol><li><p><strong>æ•°æ®ç»“æ„å®šä¹‰</strong></p><ul><li><code>Point</code> ä¸ <code>Pose</code> åˆ†åˆ«ç”¨äºè¡¨ç¤ºäºŒç»´ç‚¹å’Œå¸¦èˆªå‘è§’çš„ä½å§¿ã€‚</li><li><code>FormationParameters</code> ä¸­åŒ…å«äº†ä¸¤ç§é˜µå‹çš„ç›¸å…³å‚æ•°ï¼ˆçº¿å‹ä»…ç”¨ <code>d</code>ï¼›æ¥”å½¢åˆ™éœ€è¦ <code>d_x</code> å’Œ <code>d_y</code>ï¼‰ã€‚</li></ul></li><li><p><strong>FormationGenerator ç±»</strong></p><ul><li>æ„é€ æ—¶è¾“å…¥é¢†èˆªæœºè½¨è¿¹ã€é˜µå‹å‚æ•°å’Œè·Ÿéš UAV æ•°é‡ã€‚</li><li>åœ¨ <code>generate()</code> æ–¹æ³•ä¸­ï¼Œéå†æ¯ä¸ªæ—¶åˆ»çš„é¢†èˆªæœºä½å§¿ï¼Œç„¶åå¯¹æ¯æ¶è·Ÿéš UAV æ ¹æ®ä¸åŒé˜µå‹è®¡ç®—å±€éƒ¨åç§»ï¼Œé€šè¿‡æ—‹è½¬è½¬æ¢åˆ°å…¨å±€åæ ‡ç³»ï¼Œæœ€ç»ˆç”Ÿæˆæ¯æ¶ UAV çš„è½¨è¿¹ã€‚</li></ul></li><li><p><strong>é˜µå‹å¤„ç†</strong></p><ul><li>çº¿å‹é˜µå‹ç›´æ¥æŒ‰ç…§ UAV ç¼–å·ï¼ˆä» 1 å¼€å§‹ï¼‰åœ¨å±€éƒ¨ y æ–¹å‘è®¾ç½®åç§»ï¼›</li><li>æ¥”å½¢é˜µå‹åˆ™é‡‡ç”¨å·¦å³åˆ†æ”¯ï¼ˆé€šè¿‡äº¤æ›¿åˆ†é…ï¼‰çš„æ–¹å¼ï¼Œä½¿ç”¨ <code>(i/2+1)</code> ä½œä¸ºåˆ†æ”¯å†…çš„æ’åè®¡ç®—åç§»ã€‚</li></ul></li><li><p><strong>æ‰©å±•ä¸é›†æˆ</strong></p><ul><li>å¹³æ»‘å‡½æ•° <code>smoothTrajectory</code> ç›®å‰ä¸ºå ä½å‡½æ•°ï¼Œå¯æ ¹æ®å…·ä½“éœ€æ±‚æ›¿æ¢ä¸ºæ ·æ¡æˆ– BÃ©zier æ›²çº¿ç­‰ç®—æ³•ï¼›</li><li>è¯¥æ¨¡å—åŒ–ä»£ç è®¾è®¡ä¾¿äºåµŒå…¥åˆ°å·²æœ‰çš„æ— äººæœºé›†ç¾¤æ§åˆ¶æ¨¡å‹ä¸­ï¼Œå¹¶å¯æ ¹æ®éœ€æ±‚è¿›ä¸€æ­¥æ‰©å±•ï¼ˆå¦‚åŠ å…¥ UAV çš„è¿åŠ¨å­¦çº¦æŸã€å®æ—¶æ§åˆ¶ç­‰ï¼‰ã€‚</li></ul></li></ol><p>ä»¥ä¸Šä»£ç å¯æ–¹ä¾¿åœ°å°†ç”Ÿæˆé˜Ÿå½¢è½¨è¿¹çš„æ¨¡å—ä¸å…¶å®ƒæ§åˆ¶ã€è§„åˆ’æ¨¡å—è¿›è¡Œé›†æˆï¼Œä»è€Œå®ç°å¤šæ¶ UAV ååŒé£è¡Œçš„åŠŸèƒ½ã€‚</p><h3 id=42-claude-35-sonnet>4.2 Claude 3.5 Sonnet</h3><p>ä»¥ä¸‹ä¸ºå®Œæ•´çš„C++ä»£ç å®ç°ï¼š</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e>// formation_control.hpp
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#pragma once
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;map&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;memory&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;Eigen/Dense&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> uav {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åŸºç¡€æ•°æ®ç»“æ„
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Point2D</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    Point2D(<span style=color:#66d9ef>double</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>double</span> y <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>:</span> x(x), y(y) {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    Point2D <span style=color:#66d9ef>operator</span><span style=color:#f92672>+</span>(<span style=color:#66d9ef>const</span> Point2D<span style=color:#f92672>&amp;</span> other) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Point2D</span>(x <span style=color:#f92672>+</span> other.x, y <span style=color:#f92672>+</span> other.y);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>UAVState</span> {
</span></span><span style=display:flex><span>    Point2D position;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> heading;  <span style=color:#75715e>// theta
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> velocity;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    UAVState(<span style=color:#66d9ef>const</span> Point2D<span style=color:#f92672>&amp;</span> pos <span style=color:#f92672>=</span> Point2D(), 
</span></span><span style=display:flex><span>             <span style=color:#66d9ef>double</span> h <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>             <span style=color:#66d9ef>double</span> v <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>) 
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> position(pos), heading(h), velocity(v) {}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// é˜µå‹ç±»å‹æšä¸¾
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormationType</span> {
</span></span><span style=display:flex><span>    LINE,
</span></span><span style=display:flex><span>    WEDGE,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å¯æ‰©å±•å…¶ä»–é˜µå‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// é˜µå‹å‚æ•°åŸºç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormationParams</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#f92672>~</span>FormationParams() <span style=color:#f92672>=</span> <span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// çº¿å‹é˜µå‹å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LineFormationParams</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> FormationParams {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> spacing;  <span style=color:#75715e>// UAVé—´è·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>explicit</span> <span style=color:#a6e22e>LineFormationParams</span>(<span style=color:#66d9ef>double</span> d) <span style=color:#f92672>:</span> spacing(d) {}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æ¥”å½¢é˜µå‹å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WedgeFormationParams</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> FormationParams {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> dx;  <span style=color:#75715e>// çºµå‘é—´è·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> dy;  <span style=color:#75715e>// æ¨ªå‘é—´è·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    WedgeFormationParams(<span style=color:#66d9ef>double</span> dx, <span style=color:#66d9ef>double</span> dy) 
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> dx(dx), dy(dy) {}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æ—‹è½¬çŸ©é˜µè®¡ç®—ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RotationMatrix</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> Eigen<span style=color:#f92672>::</span>Matrix2d compute(<span style=color:#66d9ef>double</span> theta) {
</span></span><span style=display:flex><span>        Eigen<span style=color:#f92672>::</span>Matrix2d R;
</span></span><span style=display:flex><span>        R <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>cos(theta), <span style=color:#f92672>-</span>std<span style=color:#f92672>::</span>sin(theta),
</span></span><span style=display:flex><span>             std<span style=color:#f92672>::</span>sin(theta),  std<span style=color:#f92672>::</span>cos(theta);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> R;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å±€éƒ¨åç§»è®¡ç®—ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormationOffset</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> Point2D compute(<span style=color:#66d9ef>int</span> uavIndex, 
</span></span><span style=display:flex><span>                         <span style=color:#66d9ef>const</span> FormationType<span style=color:#f92672>&amp;</span> type,
</span></span><span style=display:flex><span>                         <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>FormationParams<span style=color:#f92672>&gt;&amp;</span> params,
</span></span><span style=display:flex><span>                         <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string<span style=color:#f92672>&amp;</span> branch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;center&#34;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> (type) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> FormationType<span style=color:#f92672>::</span>LINE:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> computeLineOffset(uavIndex, 
</span></span><span style=display:flex><span>                    std<span style=color:#f92672>::</span>static_pointer_cast<span style=color:#f92672>&lt;</span>LineFormationParams<span style=color:#f92672>&gt;</span>(params));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> FormationType<span style=color:#f92672>::</span>WEDGE:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> computeWedgeOffset(uavIndex, 
</span></span><span style=display:flex><span>                    std<span style=color:#f92672>::</span>static_pointer_cast<span style=color:#f92672>&lt;</span>WedgeFormationParams<span style=color:#f92672>&gt;</span>(params),
</span></span><span style=display:flex><span>                    branch);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> Point2D(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> Point2D computeLineOffset(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> uavIndex, 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>LineFormationParams<span style=color:#f92672>&gt;&amp;</span> params) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Point2D</span>(<span style=color:#ae81ff>0</span>, uavIndex <span style=color:#f92672>*</span> params<span style=color:#f92672>-&gt;</span>spacing);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> Point2D <span style=color:#a6e22e>computeWedgeOffset</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> uavIndex,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>WedgeFormationParams<span style=color:#f92672>&gt;&amp;</span> params,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string<span style=color:#f92672>&amp;</span> branch) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (branch <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;left&#34;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Point2D(uavIndex <span style=color:#f92672>*</span> params<span style=color:#f92672>-&gt;</span>dx, uavIndex <span style=color:#f92672>*</span> params<span style=color:#f92672>-&gt;</span>dy);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (branch <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;right&#34;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Point2D(uavIndex <span style=color:#f92672>*</span> params<span style=color:#f92672>-&gt;</span>dx, <span style=color:#f92672>-</span>uavIndex <span style=color:#f92672>*</span> params<span style=color:#f92672>-&gt;</span>dy);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Point2D(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è½¨è¿¹å¹³æ»‘å™¨æ¥å£
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TrajectorySmoothing</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span> smooth(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&amp;</span> rawTrajectory) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>virtual</span> <span style=color:#f92672>~</span>TrajectorySmoothing() <span style=color:#f92672>=</span> <span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç®€å•çš„è½¨è¿¹å¹³æ»‘å™¨å®ç°ï¼ˆå¯æ‰©å±•ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SimpleSmoothing</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> TrajectorySmoothing {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span> smooth(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&amp;</span> rawTrajectory) <span style=color:#66d9ef>override</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è¿™é‡Œå¯ä»¥å®ç°å…·ä½“çš„å¹³æ»‘ç®—æ³•ï¼Œå¦‚æ ·æ¡æ’å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> rawTrajectory;  <span style=color:#75715e>// å½“å‰ä»…è¿”å›åŸè½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// é˜Ÿå½¢æ§åˆ¶å™¨ä¸»ç±»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormationController</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    FormationController(
</span></span><span style=display:flex><span>        FormationType type,
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>FormationParams<span style=color:#f92672>&gt;</span> params,
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>TrajectorySmoothing<span style=color:#f92672>&gt;</span> smoother)
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> formationType(type)
</span></span><span style=display:flex><span>        , formationParams(params)
</span></span><span style=display:flex><span>        , trajectorySmoother(smoother) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&gt;</span> generateFormationTrajectories(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&amp;</span> leaderTrajectory,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> numFollowers) {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&gt;</span> formationTrajs;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸ºæ¯ä¸ªè·Ÿéšè€…åˆå§‹åŒ–è½¨è¿¹å®¹å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> numFollowers; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            formationTrajs[i] <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—æ¯ä¸ªæ—¶é—´ç‚¹çš„é˜Ÿå½¢ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> leaderState : leaderTrajectory) {
</span></span><span style=display:flex><span>            Eigen<span style=color:#f92672>::</span>Matrix2d R <span style=color:#f92672>=</span> RotationMatrix<span style=color:#f92672>::</span>compute(leaderState.heading);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> numFollowers; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// è®¡ç®—å±€éƒ¨åç§»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Point2D localOffset <span style=color:#f92672>=</span> FormationOffset<span style=color:#f92672>::</span>compute(
</span></span><span style=display:flex><span>                    i, formationType, formationParams);
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                <span style=color:#75715e>// è½¬æ¢åˆ°å…¨å±€åæ ‡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Eigen<span style=color:#f92672>::</span>Vector2d localOffsetVec(localOffset.x, localOffset.y);
</span></span><span style=display:flex><span>                Eigen<span style=color:#f92672>::</span>Vector2d globalOffset <span style=color:#f92672>=</span> R <span style=color:#f92672>*</span> localOffsetVec;
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e>// è®¡ç®—è·Ÿéšè€…ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Point2D <span style=color:#a6e22e>followerPos</span>(
</span></span><span style=display:flex><span>                    leaderState.position.x <span style=color:#f92672>+</span> globalOffset(<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>                    leaderState.position.y <span style=color:#f92672>+</span> globalOffset(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e>// åˆ›å»ºè·Ÿéšè€…çŠ¶æ€å¹¶æ·»åŠ åˆ°è½¨è¿¹ä¸­
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                UAVState <span style=color:#a6e22e>followerState</span>(
</span></span><span style=display:flex><span>                    followerPos,
</span></span><span style=display:flex><span>                    leaderState.heading,
</span></span><span style=display:flex><span>                    leaderState.velocity
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>                formationTrajs[i].push_back(followerState);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å¯¹æ‰€æœ‰è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> [uavId, trajectory] <span style=color:#f92672>:</span> formationTrajs) {
</span></span><span style=display:flex><span>            trajectory <span style=color:#f92672>=</span> trajectorySmoother<span style=color:#f92672>-&gt;</span>smooth(trajectory);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> formationTrajs;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    FormationType formationType;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>FormationParams<span style=color:#f92672>&gt;</span> formationParams;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>shared_ptr<span style=color:#f92672>&lt;</span>TrajectorySmoothing<span style=color:#f92672>&gt;</span> trajectorySmoother;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>} <span style=color:#75715e>// namespace uav
</span></span></span></code></pre></div><h4 id=ä»£ç è¯´æ˜-1>ä»£ç è¯´æ˜</h4><ol><li><p><strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼š</p><ul><li>ä½¿ç”¨å‘½åç©ºé—´<code>uav</code>éš”ç¦»æ‰€æœ‰ç›¸å…³ç±»å’Œç»“æ„</li><li>æ¯ä¸ªä¸»è¦ç»„ä»¶éƒ½è¢«è®¾è®¡ä¸ºç‹¬ç«‹çš„ç±»</li><li>ä½¿ç”¨ç»§æ‰¿å’Œå¤šæ€æ”¯æŒä¸åŒçš„é˜µå‹å‚æ•°å’Œå¹³æ»‘ç®—æ³•</li></ul></li><li><p><strong>å…³é”®ç»„ä»¶</strong>ï¼š</p><ul><li><code>Point2D</code>å’Œ<code>UAVState</code>ï¼šåŸºç¡€æ•°æ®ç»“æ„</li><li><code>FormationType</code>å’Œ<code>FormationParams</code>ï¼šé˜µå‹é…ç½®</li><li><code>RotationMatrix</code>ï¼šæ—‹è½¬çŸ©é˜µè®¡ç®—</li><li><code>FormationOffset</code>ï¼šå±€éƒ¨åç§»è®¡ç®—</li><li><code>TrajectorySmoothing</code>ï¼šè½¨è¿¹å¹³æ»‘æ¥å£</li><li><code>FormationController</code>ï¼šä¸»æ§åˆ¶å™¨ç±»</li></ul></li><li><p><strong>æ‰©å±•æ€§è€ƒè™‘</strong>ï¼š</p><ul><li>å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„é˜µå‹ç±»å‹</li><li>å¯ä»¥å®ç°ä¸åŒçš„è½¨è¿¹å¹³æ»‘ç®—æ³•</li><li>ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</li></ul></li><li><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p></li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> uav;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºçº¿å‹é˜µå‹å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>auto</span> lineParams <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>make_shared<span style=color:#f92672>&lt;</span>LineFormationParams<span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>5.0</span>);  <span style=color:#75715e>// 5.0ç±³é—´è·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºè½¨è¿¹å¹³æ»‘å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>auto</span> smoother <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>make_shared<span style=color:#f92672>&lt;</span>SimpleSmoothing<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºé˜Ÿå½¢æ§åˆ¶å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>FormationController <span style=color:#a6e22e>controller</span>(
</span></span><span style=display:flex><span>    FormationType<span style=color:#f92672>::</span>LINE,
</span></span><span style=display:flex><span>    lineParams,
</span></span><span style=display:flex><span>    smoother
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å‡†å¤‡é¢†èˆªæœºè½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span> leaderTrajectory <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    UAVState(Point2D(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>), <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>),  <span style=color:#75715e>// ä½ç½®(0,0)ï¼Œèˆªå‘0ï¼Œé€Ÿåº¦20
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    UAVState(Point2D(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>0</span>), M_PI<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ... æ›´å¤šè½¨è¿¹ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç”Ÿæˆç¼–é˜Ÿè½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> numFollowers <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>auto</span> formationTrajectories <span style=color:#f92672>=</span> controller.generateFormationTrajectories(
</span></span><span style=display:flex><span>    leaderTrajectory,
</span></span><span style=display:flex><span>    numFollowers
</span></span><span style=display:flex><span>);</span></span></code></pre></div><p>è¦å°†è¿™ä¸ªä»£ç é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿä¸­ï¼Œä½ éœ€è¦ï¼š</p><ol><li>å°†ä»£ç æ”¾å…¥é€‚å½“çš„å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶ä¸­</li><li>ç¡®ä¿ä½ çš„é¡¹ç›®ä¸­åŒ…å«äº†Eigenåº“</li><li>æ ¹æ®éœ€è¦å®ç°å…·ä½“çš„è½¨è¿¹å¹³æ»‘ç®—æ³•</li><li>æ ¹æ®å®é™…éœ€æ±‚æ‰©å±•å…¶ä»–é˜µå‹ç±»å‹</li></ol><p>è¿™ä¸ªå®ç°ä¿æŒäº†åŸå§‹æ•°å­¦æ¨¡å‹çš„ç»“æ„ï¼ŒåŒæ—¶æä¾›äº†è‰¯å¥½çš„é¢å‘å¯¹è±¡å°è£…å’Œæ‰©å±•æ€§ã€‚ä½ å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œè¿›ä¸€æ­¥çš„å®šåˆ¶å’Œä¼˜åŒ–ã€‚</p><h2 id=é™„å½•1-è½¨è¿¹è·Ÿè¸ªå®ç°å‚è€ƒç¤ºä¾‹>é™„å½•1. è½¨è¿¹è·Ÿè¸ªå®ç°å‚è€ƒç¤ºä¾‹</h2><p>ä¸‹é¢æŒ‰æ­¥è¿›ä»¿çœŸæ–¹å¼ï¼Œä½¿è½¨è¿¹è·Ÿè¸ªæ¨¡å‹èƒ½å¤Ÿå®æ—¶è·Ÿè¸ªç”Ÿæˆçš„æœŸæœ›è½¨è¿¹ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨æ¯ä¸ªä»¿çœŸæ—¶é—´æ­¥å†…ï¼Œæ ¹æ®å½“å‰ UAV çŠ¶æ€ä¸æœŸæœ›è½¨è¿¹ï¼ˆç”±ä¸Šä¸€ä¸ªæ¨¡å—ç”Ÿæˆï¼‰çš„å‚è€ƒç‚¹è®¡ç®—è¯¯å·®ï¼Œç„¶ååˆ©ç”¨æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚ PIDã€çº¯è·Ÿè¸ªç®—æ³• Pure Pursuitã€MPC ç­‰ï¼‰è®¡ç®—æ§åˆ¶æŒ‡ä»¤ï¼Œå†åˆ©ç”¨ UAV çš„è¿åŠ¨å­¦æˆ–åŠ¨åŠ›å­¦æ¨¡å‹å¯¹çŠ¶æ€è¿›è¡Œæ›´æ–°ã€‚ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•å®ç°è¿™ä¸€æµç¨‹ã€‚</p><hr><h3 id=1-æŒ‰æ­¥è¿›ä»¿çœŸçš„åŸºæœ¬æµç¨‹>1. æŒ‰æ­¥è¿›ä»¿çœŸçš„åŸºæœ¬æµç¨‹</h3><ol><li><p><strong>åˆå§‹åŒ–</strong></p><ul><li>å®šä¹‰ä»¿çœŸå‚æ•°ï¼šæ€»ä»¿çœŸæ—¶é—´ $T$ å’Œæ­¥é•¿ $dt$ï¼›</li><li>åˆå§‹åŒ– UAV å½“å‰çŠ¶æ€ï¼ˆä½ç½®ã€èˆªå‘è§’ã€é€Ÿåº¦ç­‰ï¼‰ï¼›</li><li>å¯¼å…¥æˆ–ç”Ÿæˆå‚è€ƒè½¨è¿¹ï¼ˆç”Ÿæˆçš„é˜Ÿå½¢è½¨è¿¹ï¼‰ï¼Œé€šå¸¸ä¸ºä¸€ç³»åˆ—å¸¦æ—¶é—´æ ‡ç­¾çš„è½¨è¿¹ç‚¹ã€‚</li></ul></li><li><p><strong>ä¸»ä»¿çœŸå¾ªç¯</strong><br>åœ¨æ¯ä¸ªæ—¶é—´æ­¥ $t$ å†…ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li><strong>ï¼ˆaï¼‰æŸ¥æ‰¾å‚è€ƒç‚¹</strong><br>æ ¹æ®å½“å‰ä»¿çœŸæ—¶é—´ $t$ ä»å‚è€ƒè½¨è¿¹ä¸­æå–æˆ–æ’å€¼å¾—åˆ°æœŸæœ›çŠ¶æ€ï¼ˆä½ç½®ã€èˆªå‘è§’ç­‰ï¼‰ã€‚</li><li><strong>ï¼ˆbï¼‰è®¡ç®—è¯¯å·®</strong><br>å¯¹æ¯” UAV å½“å‰çŠ¶æ€å’Œå‚è€ƒçŠ¶æ€ï¼Œè®¡ç®—ä½ç½®è¯¯å·®ã€èˆªå‘è¯¯å·®ç­‰ã€‚</li><li><strong>ï¼ˆcï¼‰æ§åˆ¶å™¨è®¡ç®—</strong><br>å°†è¯¯å·®è¾“å…¥æ§åˆ¶å™¨ï¼Œç”Ÿæˆæ§åˆ¶å‘½ä»¤ï¼ˆä¾‹å¦‚èˆªå‘è§’é€Ÿç‡ã€æ²¹é—¨æŒ‡ä»¤æˆ–å…¶ä»–æ§åˆ¶å˜é‡ï¼‰ã€‚</li><li><strong>ï¼ˆdï¼‰çŠ¶æ€æ›´æ–°</strong><br>æ ¹æ® UAV çš„è¿åŠ¨å­¦/åŠ¨åŠ›å­¦æ¨¡å‹ï¼ˆä¾‹å¦‚ç®€å•çš„ kinematic æ¨¡å‹æˆ–æ›´å¤æ‚çš„åŠ¨åŠ›å­¦æ¨¡å‹ï¼‰ï¼Œä½¿ç”¨ç¦»æ•£ç§¯åˆ†æ–¹æ³•ï¼ˆå¦‚æ¬§æ‹‰ç§¯åˆ†æˆ– Runge-Kutta æ–¹æ³•ï¼‰æ›´æ–° UAV çš„çŠ¶æ€ã€‚</li><li><strong>ï¼ˆeï¼‰è®°å½•æ•°æ®</strong><br>ä¿å­˜ UAV å½“å‰çŠ¶æ€ã€æ§åˆ¶å‘½ä»¤ä»¥åŠè¯¯å·®ä¿¡æ¯ï¼Œä¾¿äºåç»­åˆ†æå’Œå¯è§†åŒ–ã€‚</li></ul></li><li><p><strong>ä»¿çœŸç»“æŸ</strong><br>å½“ä»¿çœŸæ—¶é—´è¾¾åˆ°é¢„è®¾æ—¶é—´åç»“æŸï¼Œå¹¶è¾“å‡ºä»¿çœŸæ•°æ®æˆ–è½¨è¿¹å›¾ä»¥ä¾¿è¯„ä¼°è·Ÿè¸ªæ•ˆæœã€‚</p></li></ol><hr><h3 id=2-chatgpt-o3-mini-high-ç¤ºä¾‹ä»£ç c>2. ChatGPT o3-mini-high ç¤ºä¾‹ä»£ç ï¼ˆC++ï¼‰</h3><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€åŒ–çš„ C++ ç¤ºä¾‹ä»£ç ï¼Œè¯¥ä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨ä»¿çœŸä¸»å¾ªç¯ä¸­è®©ä¸€ä¸ªç®€å•çš„ PID è·Ÿè¸ªæ§åˆ¶å™¨è·Ÿè¸ªå‚è€ƒè½¨è¿¹ã€‚æ³¨æ„ï¼šä»£ç ä¸­çš„ UAV åŠ¨åŠ›å­¦æ¨¡å‹é‡‡ç”¨ç®€å•çš„å¹³é¢è¿åŠ¨ kinematic æ¨¡å‹ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„æ¨¡å‹ã€‚</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------- æ•°æ®ç»“æ„å®šä¹‰ --------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// UAV çŠ¶æ€ï¼ˆä½ç½®ã€èˆªå‘è§’ã€é€Ÿåº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>UAVState</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> theta; <span style=color:#75715e>// èˆªå‘è§’ï¼ˆå¼§åº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> v;     <span style=color:#75715e>// é€Ÿåº¦ï¼ˆå‡è®¾ä¿æŒæ’å®šæˆ–å¯æ§åˆ¶ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æœŸæœ›è½¨è¿¹ç‚¹ï¼ˆå«æ—¶é—´æ ‡ç­¾ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TrajectoryPoint</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> t;     <span style=color:#75715e>// æ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> theta; <span style=color:#75715e>// æœŸæœ›èˆªå‘è§’ï¼ˆå¯é€‰ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------- PID æ§åˆ¶å™¨ --------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PIDController</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    PIDController(<span style=color:#66d9ef>double</span> kp, <span style=color:#66d9ef>double</span> ki, <span style=color:#66d9ef>double</span> kd)
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> kp_(kp), ki_(ki), kd_(kd), prevError_(<span style=color:#ae81ff>0.0</span>), integral_(<span style=color:#ae81ff>0.0</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è¾“å…¥è¯¯å·®ï¼Œè¾“å‡ºæ§åˆ¶å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼šèˆªå‘è§’é€Ÿç‡æˆ–è§’åº¦ä¿®æ­£ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>compute</span>(<span style=color:#66d9ef>double</span> error, <span style=color:#66d9ef>double</span> dt) {
</span></span><span style=display:flex><span>        integral_ <span style=color:#f92672>+=</span> error <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> derivative <span style=color:#f92672>=</span> (error <span style=color:#f92672>-</span> prevError_) <span style=color:#f92672>/</span> dt;
</span></span><span style=display:flex><span>        prevError_ <span style=color:#f92672>=</span> error;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> kp_ <span style=color:#f92672>*</span> error <span style=color:#f92672>+</span> ki_ <span style=color:#f92672>*</span> integral_ <span style=color:#f92672>+</span> kd_ <span style=color:#f92672>*</span> derivative;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> kp_, ki_, kd_;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> prevError_;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> integral_;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------- è¾…åŠ©å‡½æ•° --------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å°†è§’åº¦å·®å½’ä¸€åŒ–åˆ° [-pi, pi]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> <span style=color:#a6e22e>normalizeAngle</span>(<span style=color:#66d9ef>double</span> angle) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (angle <span style=color:#f92672>&gt;</span> M_PI)
</span></span><span style=display:flex><span>        angle <span style=color:#f92672>-=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> M_PI;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (angle <span style=color:#f92672>&lt;</span> <span style=color:#f92672>-</span>M_PI)
</span></span><span style=display:flex><span>        angle <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> M_PI;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> angle;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æ ¹æ®å½“å‰ UAV çŠ¶æ€å’ŒæœŸæœ›è½¨è¿¹ç‚¹ï¼Œè®¡ç®—èˆªå‘è§’è¯¯å·®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> <span style=color:#a6e22e>computeHeadingError</span>(<span style=color:#66d9ef>const</span> UAVState<span style=color:#f92672>&amp;</span> current, <span style=color:#66d9ef>const</span> TrajectoryPoint<span style=color:#f92672>&amp;</span> desired) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®—ä»å½“å‰ç‚¹æŒ‡å‘å‚è€ƒç‚¹çš„è§’åº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> desiredTheta <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>atan2(desired.y <span style=color:#f92672>-</span> current.y, desired.x <span style=color:#f92672>-</span> current.x);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> error <span style=color:#f92672>=</span> normalizeAngle(desiredTheta <span style=color:#f92672>-</span> current.theta);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> error;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç®€å•çš„ UAV çŠ¶æ€æ›´æ–°å‡½æ•°ï¼ˆåŸºäº kinematic æ¨¡å‹ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>UAVState <span style=color:#a6e22e>updateState</span>(<span style=color:#66d9ef>const</span> UAVState<span style=color:#f92672>&amp;</span> current, <span style=color:#66d9ef>double</span> controlCommand, <span style=color:#66d9ef>double</span> dt) {
</span></span><span style=display:flex><span>    UAVState next <span style=color:#f92672>=</span> current;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å‡è®¾ controlCommand ä¸ºèˆªå‘è§’é€Ÿç‡æ§åˆ¶è¾“å…¥
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    next.theta <span style=color:#f92672>+=</span> controlCommand <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>    next.theta <span style=color:#f92672>=</span> normalizeAngle(next.theta);
</span></span><span style=display:flex><span>    next.x <span style=color:#f92672>+=</span> current.v <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>cos(next.theta) <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>    next.y <span style=color:#f92672>+=</span> current.v <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>sin(next.theta) <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> next;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -------------------- ä¸»ä»¿çœŸç¨‹åº --------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 1. åˆå§‹åŒ–ä»¿çœŸå‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> simulationTime <span style=color:#f92672>=</span> <span style=color:#ae81ff>10.0</span>; <span style=color:#75715e>// æ€»ä»¿çœŸæ—¶é—´ï¼ˆç§’ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> dt <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.1</span>;              <span style=color:#75715e>// æ—¶é—´æ­¥é•¿ï¼ˆç§’ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> currentTime <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 2. åˆå§‹åŒ– UAV çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    UAVState uav <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>5.0</span>}; <span style=color:#75715e>// åˆå§‹ä½ç½® (0,0), èˆªå‘ 0, é€Ÿåº¦ 5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 3. å®šä¹‰å‚è€ƒè½¨è¿¹ï¼ˆç”Ÿæˆçš„è½¨è¿¹ï¼‰â€”â€”ç¤ºä¾‹æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>TrajectoryPoint<span style=color:#f92672>&gt;</span> refTrajectory <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>2.0</span>, <span style=color:#ae81ff>2.0</span>, <span style=color:#ae81ff>2.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>4.0</span>, <span style=color:#ae81ff>4.0</span>, <span style=color:#ae81ff>4.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>6.0</span>, <span style=color:#ae81ff>6.0</span>, <span style=color:#ae81ff>6.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>8.0</span>, <span style=color:#ae81ff>8.0</span>, <span style=color:#ae81ff>8.0</span>, <span style=color:#ae81ff>0.0</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>10.0</span>, <span style=color:#ae81ff>10.0</span>, <span style=color:#ae81ff>10.0</span>, <span style=color:#ae81ff>0.0</span>}
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 4. åˆå§‹åŒ– PID æ§åˆ¶å™¨å‚æ•°ï¼ˆè°ƒè¯•æ—¶æ ¹æ®éœ€è¦è°ƒæ•´ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    PIDController pid(<span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 5. ä»¿çœŸä¸»å¾ªç¯ï¼ˆæŒ‰æ­¥è¿›è¿è¡Œï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>while</span> (currentTime <span style=color:#f92672>&lt;=</span> simulationTime) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5.1 æ ¹æ®å½“å‰æ—¶é—´è·å–å‚è€ƒè½¨è¿¹ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// æ­¤å¤„ç®€å•é€‰å–ç¦»å½“å‰æ—¶é—´æœ€è¿‘çš„ç‚¹ï¼ˆå¯æ”¹ä¸ºçº¿æ€§æ’å€¼ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        TrajectoryPoint desired <span style=color:#f92672>=</span> refTrajectory.back();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> point : refTrajectory) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (point.t <span style=color:#f92672>&gt;=</span> currentTime) {
</span></span><span style=display:flex><span>                desired <span style=color:#f92672>=</span> point;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5.2 è®¡ç®—è·Ÿè¸ªè¯¯å·®ï¼ˆè¿™é‡Œä»¥èˆªå‘è§’è¯¯å·®ä¸ºä¾‹ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> headingError <span style=color:#f92672>=</span> computeHeadingError(uav, desired);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5.3 æ§åˆ¶å™¨è®¡ç®—ï¼Œè¾“å‡ºæ§åˆ¶å‘½ä»¤ï¼ˆä¾‹å¦‚èˆªå‘è§’é€Ÿç‡ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> controlCommand <span style=color:#f92672>=</span> pid.compute(headingError, dt);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5.4 æ›´æ–° UAV çŠ¶æ€ï¼ˆçŠ¶æ€æ›´æ–°å‡½æ•°å¯ä»¥æ ¹æ® UAV åŠ¨åŠ›å­¦è¿›è¡Œæ‰©å±•ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        uav <span style=color:#f92672>=</span> updateState(uav, controlCommand, dt);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5.5 è¾“å‡ºå½“å‰çŠ¶æ€ä¸å‚è€ƒä¿¡æ¯ï¼Œä¾¿äºè§‚å¯Ÿè·Ÿè¸ªæ•ˆæœ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Time: &#34;</span> <span style=color:#f92672>&lt;&lt;</span> currentTime
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | UAV: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.theta <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | Ref: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> desired.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> desired.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | Heading Error: &#34;</span> <span style=color:#f92672>&lt;&lt;</span> headingError
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 5.6 æ›´æ–°æ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        currentTime <span style=color:#f92672>+=</span> dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h4 id=ä»£ç è¯´æ˜-2>ä»£ç è¯´æ˜</h4><ul><li><p><strong>æ•°æ®ç»“æ„</strong></p><ul><li><code>UAVState</code> å®šä¹‰äº†æ— äººæœºå½“å‰çš„çŠ¶æ€ä¿¡æ¯ï¼›</li><li><code>TrajectoryPoint</code> åŒ…å«å‚è€ƒè½¨è¿¹ç‚¹å’Œå¯¹åº”çš„æ—¶é—´æ ‡ç­¾ï¼ˆå®é™…åº”ç”¨ä¸­å¯ä»¥æ›´ç²¾ç»†ï¼Œå¦‚åŒ…å«é€Ÿåº¦ã€åŠ é€Ÿåº¦ç­‰ï¼‰ã€‚</li></ul></li><li><p><strong>æ§åˆ¶å™¨éƒ¨åˆ†</strong></p><ul><li>ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ PID æ§åˆ¶å™¨è®¡ç®—èˆªå‘è§’è¯¯å·®ï¼Œä»è€Œç”Ÿæˆæ§åˆ¶æŒ‡ä»¤ã€‚</li><li>è¿™é‡Œçš„è¯¯å·®é‡‡ç”¨å½“å‰ UAV æŒ‡å‘å‚è€ƒç‚¹çš„æœŸæœ›èˆªå‘è§’ä¸å®é™…èˆªå‘è§’çš„å·®å€¼ã€‚</li></ul></li><li><p><strong>çŠ¶æ€æ›´æ–°</strong></p><ul><li><code>updateState</code> å‡½æ•°åŸºäºç®€å•çš„å¹³é¢è¿åŠ¨ kinematic æ¨¡å‹ï¼Œåˆ©ç”¨æ¬§æ‹‰ç§¯åˆ†æ–¹æ³•æ›´æ–°çŠ¶æ€ã€‚</li><li>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯æ ¹æ® UAV çš„åŠ¨åŠ›å­¦ç‰¹æ€§é‡‡ç”¨æ›´ç²¾ç¡®çš„ç§¯åˆ†æ–¹æ³•ã€‚</li></ul></li><li><p><strong>ä»¿çœŸå¾ªç¯</strong></p><ul><li>åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¸­ï¼Œä»å‚è€ƒè½¨è¿¹ä¸­æ‰¾åˆ°å½“å‰æ—¶é—´å¯¹åº”çš„æœŸæœ›çŠ¶æ€ï¼ˆè¿™é‡Œé‡‡ç”¨æœ€ç®€å•çš„æ–¹æ³•ï¼Œå®é™…å¯é‡‡ç”¨æ’å€¼ï¼‰ï¼›</li><li>è®¡ç®—è¯¯å·®ã€å¾—åˆ°æ§åˆ¶å‘½ä»¤ï¼Œå†æ›´æ–°çŠ¶æ€ã€‚æ•´ä¸ªè¿‡ç¨‹æŒ‰ dt è¿›è¡Œè¿­ä»£ï¼Œå®Œæˆä»¿çœŸã€‚</li></ul></li></ul><hr><h4 id=å®é™…é›†æˆæ³¨æ„äº‹é¡¹>å®é™…é›†æˆæ³¨æ„äº‹é¡¹</h4><ul><li><p><strong>è½¨è¿¹æ’å€¼</strong><br>å¦‚æœç”Ÿæˆçš„å‚è€ƒè½¨è¿¹æ—¶é—´é—´éš”è¾ƒå¤§ï¼Œå»ºè®®é‡‡ç”¨çº¿æ€§æˆ–æ ·æ¡æ’å€¼ï¼Œè·å¾—æ›´å¹³æ»‘çš„æœŸæœ›çŠ¶æ€ã€‚</p></li><li><p><strong>æ§åˆ¶å™¨é€‰æ‹©</strong><br>æ ¹æ® UAV çš„åŠ¨åŠ›å­¦å’Œä»»åŠ¡éœ€æ±‚ï¼Œå¯ä»¥é€‰æ‹©æ›´ä¸ºå¤æ‚çš„æ§åˆ¶å™¨ï¼ˆå¦‚ MPCã€çº¯è·Ÿè¸ªç®—æ³• Pure Pursuitã€Backstepping ç­‰ï¼‰ã€‚</p></li><li><p><strong>æ¨¡å‹åŒ¹é…</strong><br>è·Ÿè¸ªæ¨¡å‹åº”ä¸ UAV å®é™…åŠ¨æ€ç‰¹æ€§ç›¸åŒ¹é…ï¼Œåœ¨ä»¿çœŸä¸­å¯èƒ½éœ€è¦è€ƒè™‘åŠ é€Ÿåº¦ã€ä¾§å‘åŠ¨åŠ›å­¦ç­‰å› ç´ ã€‚</p></li><li><p><strong>å®æ—¶æ€§</strong><br>å½“å°†è¯¥æ¨¡å‹é›†æˆåˆ°å®é™…æ— äººæœºæ§åˆ¶ç³»ç»Ÿæ—¶ï¼Œè¦ç¡®ä¿æ§åˆ¶å™¨è®¡ç®—å’ŒçŠ¶æ€æ›´æ–°èƒ½å¤Ÿæ»¡è¶³å®æ—¶è¦æ±‚ã€‚</p></li></ul><hr><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤å’Œç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥åœ¨ä»¿çœŸç¨‹åºä¸­ï¼Œä½¿è½¨è¿¹è·Ÿè¸ªæ¨¡å‹å®æ—¶è·Ÿè¸ªç”Ÿæˆçš„å‚è€ƒè½¨è¿¹ï¼Œä»è€ŒéªŒè¯å’Œä¼˜åŒ– UAV é˜Ÿå½¢é£è¡Œæ§åˆ¶ç­–ç•¥ã€‚</p><h3 id=3-claude-35-sonnet-ç¤ºä¾‹ä»£ç c>3. Claude 3.5 Sonnet ç¤ºä¾‹ä»£ç ï¼ˆC++ï¼‰</h3><p>ä»¥ä¸‹ä¸ºClaude 3.5 Sonnetç”Ÿæˆçš„çš„è½¨è¿¹è·Ÿè¸ªæ§åˆ¶å™¨C++ä»£ç ï¼Œç”¨äºä»¿çœŸç¯å¢ƒä¸­è·Ÿè¸ªä¸Šè¿°ç”Ÿæˆçš„ç¼–é˜Ÿè½¨è¿¹ã€‚</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C++ data-lang=C++><span style=display:flex><span><span style=color:#75715e>// trajectory_tracking.hpp
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#pragma once
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;Eigen/Dense&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&#34;formation_control.hpp&#34;</span><span style=color:#75715e>  </span><span style=color:#75715e>// å¼•ç”¨ä¹‹å‰çš„ç¼–é˜Ÿæ§åˆ¶ä»£ç 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> uav {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// UAVåŠ¨åŠ›å­¦æ¨¡å‹å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>UAVDynamicsParams</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> max_velocity;        <span style=color:#75715e>// æœ€å¤§é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> min_velocity;        <span style=color:#75715e>// æœ€å°é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> max_acceleration;    <span style=color:#75715e>// æœ€å¤§åŠ é€Ÿåº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> max_yaw_rate;       <span style=color:#75715e>// æœ€å¤§åèˆªè§’é€Ÿç‡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> control_frequency;   <span style=color:#75715e>// æ§åˆ¶é¢‘ç‡ (Hz)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    UAVDynamicsParams(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> maxV <span style=color:#f92672>=</span> <span style=color:#ae81ff>30.0</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> minV <span style=color:#f92672>=</span> <span style=color:#ae81ff>15.0</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> maxA <span style=color:#f92672>=</span> <span style=color:#ae81ff>5.0</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> maxYaw <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> freq <span style=color:#f92672>=</span> <span style=color:#ae81ff>50.0</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>:</span> max_velocity(maxV),
</span></span><span style=display:flex><span>        min_velocity(minV),
</span></span><span style=display:flex><span>        max_acceleration(maxA),
</span></span><span style=display:flex><span>        max_yaw_rate(maxYaw),
</span></span><span style=display:flex><span>        control_frequency(freq) {}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è½¨è¿¹è·Ÿè¸ªæ§åˆ¶å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TrajectoryTracker</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    TrajectoryTracker(<span style=color:#66d9ef>const</span> UAVDynamicsParams<span style=color:#f92672>&amp;</span> params)
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> dynamics_params(params)
</span></span><span style=display:flex><span>        , dt(<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>/</span> params.control_frequency)
</span></span><span style=display:flex><span>        , current_index(<span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// PIDæ§åˆ¶å™¨å¢ç›Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        pid_gains <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>2.0</span>,  <span style=color:#75715e>// Kp for heading
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>0.1</span>,  <span style=color:#75715e>// Ki for heading
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>0.5</span>,  <span style=color:#75715e>// Kd for heading
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>1.0</span>,  <span style=color:#75715e>// Kp for velocity
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>0.1</span>,  <span style=color:#75715e>// Ki for velocity
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#ae81ff>0.2</span>   <span style=color:#75715e>// Kd for velocity
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¾ç½®ç›®æ ‡è½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setTrajectory</span>(<span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&amp;</span> trajectory) {
</span></span><span style=display:flex><span>        reference_trajectory <span style=color:#f92672>=</span> trajectory;
</span></span><span style=display:flex><span>        current_index <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        resetPIDErrors();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ›´æ–°UAVçŠ¶æ€ï¼ˆå•æ­¥ä»¿çœŸï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    UAVState <span style=color:#a6e22e>updateState</span>(<span style=color:#66d9ef>const</span> UAVState<span style=color:#f92672>&amp;</span> current_state) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (current_index <span style=color:#f92672>&gt;=</span> reference_trajectory.size()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> current_state;  <span style=color:#75715e>// è½¨è¿¹å·²å®Œæˆ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è·å–å‚è€ƒçŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> UAVState<span style=color:#f92672>&amp;</span> reference <span style=color:#f92672>=</span> reference_trajectory[current_index];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—è¯¯å·®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> dx <span style=color:#f92672>=</span> reference.position.x <span style=color:#f92672>-</span> current_state.position.x;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dy <span style=color:#f92672>=</span> reference.position.y <span style=color:#f92672>-</span> current_state.position.y;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> distance_error <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>sqrt(dx <span style=color:#f92672>*</span> dx <span style=color:#f92672>+</span> dy <span style=color:#f92672>*</span> dy);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—æœŸæœ›èˆªå‘è§’
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> desired_heading <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>atan2(dy, dx);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> heading_error <span style=color:#f92672>=</span> normalizeAngle(desired_heading <span style=color:#f92672>-</span> current_state.heading);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ›´æ–°PIDè¯¯å·®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        updatePIDErrors(heading_error, distance_error);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—æ§åˆ¶è¾“å…¥
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> yaw_rate <span style=color:#f92672>=</span> computeHeadingControl();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> velocity <span style=color:#f92672>=</span> computeVelocityControl(distance_error);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// åº”ç”¨åŠ¨åŠ›å­¦çº¦æŸ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        yaw_rate <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>clamp(yaw_rate, 
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span>dynamics_params.max_yaw_rate,
</span></span><span style=display:flex><span>            dynamics_params.max_yaw_rate);
</span></span><span style=display:flex><span>        velocity <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>clamp(velocity,
</span></span><span style=display:flex><span>            dynamics_params.min_velocity,
</span></span><span style=display:flex><span>            dynamics_params.max_velocity);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ›´æ–°çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        UAVState new_state;
</span></span><span style=display:flex><span>        new_state.heading <span style=color:#f92672>=</span> normalizeAngle(
</span></span><span style=display:flex><span>            current_state.heading <span style=color:#f92672>+</span> yaw_rate <span style=color:#f92672>*</span> dt);
</span></span><span style=display:flex><span>        new_state.velocity <span style=color:#f92672>=</span> velocity;
</span></span><span style=display:flex><span>        new_state.position.x <span style=color:#f92672>=</span> current_state.position.x <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>            velocity <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>cos(new_state.heading) <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>        new_state.position.y <span style=color:#f92672>=</span> current_state.position.y <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>            velocity <span style=color:#f92672>*</span> std<span style=color:#f92672>::</span>sin(new_state.heading) <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè½¨è¿¹ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (distance_error <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1.0</span>) {  <span style=color:#75715e>// 1.0ç±³é˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            current_index<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> new_state;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    UAVDynamicsParams dynamics_params;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span> reference_trajectory;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> pid_gains;  <span style=color:#75715e>// [Kp_h, Ki_h, Kd_h, Kp_v, Ki_v, Kd_v]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> dt;
</span></span><span style=display:flex><span>    size_t current_index;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// PIDæ§åˆ¶å™¨çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> heading_error_sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> heading_error_prev <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> velocity_error_sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> velocity_error_prev <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    } pid_state;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>resetPIDErrors</span>() {
</span></span><span style=display:flex><span>        pid_state <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>updatePIDErrors</span>(<span style=color:#66d9ef>double</span> heading_error, <span style=color:#66d9ef>double</span> distance_error) {
</span></span><span style=display:flex><span>        pid_state.heading_error_sum <span style=color:#f92672>+=</span> heading_error <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>        pid_state.velocity_error_sum <span style=color:#f92672>+=</span> distance_error <span style=color:#f92672>*</span> dt;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>computeHeadingControl</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> p_term <span style=color:#f92672>=</span> pid_gains[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> normalizeAngle(
</span></span><span style=display:flex><span>            reference_trajectory[current_index].heading <span style=color:#f92672>-</span> 
</span></span><span style=display:flex><span>            pid_state.heading_error_prev);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> i_term <span style=color:#f92672>=</span> pid_gains[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> pid_state.heading_error_sum;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> d_term <span style=color:#f92672>=</span> pid_gains[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> (normalizeAngle(
</span></span><span style=display:flex><span>            reference_trajectory[current_index].heading <span style=color:#f92672>-</span> 
</span></span><span style=display:flex><span>            pid_state.heading_error_prev) <span style=color:#f92672>/</span> dt);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> p_term <span style=color:#f92672>+</span> i_term <span style=color:#f92672>+</span> d_term;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>computeVelocityControl</span>(<span style=color:#66d9ef>double</span> distance_error) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> p_term <span style=color:#f92672>=</span> pid_gains[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> distance_error;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> i_term <span style=color:#f92672>=</span> pid_gains[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>*</span> pid_state.velocity_error_sum;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> d_term <span style=color:#f92672>=</span> pid_gains[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>*</span> 
</span></span><span style=display:flex><span>            (distance_error <span style=color:#f92672>-</span> pid_state.velocity_error_prev) <span style=color:#f92672>/</span> dt;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> reference_trajectory[current_index].velocity <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>            p_term <span style=color:#f92672>+</span> i_term <span style=color:#f92672>+</span> d_term;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å°†è§’åº¦å½’ä¸€åŒ–åˆ°[-Ï€, Ï€]èŒƒå›´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>normalizeAngle</span>(<span style=color:#66d9ef>double</span> angle) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (angle <span style=color:#f92672>&gt;</span> M_PI) angle <span style=color:#f92672>-=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> M_PI;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (angle <span style=color:#f92672>&lt;</span> <span style=color:#f92672>-</span>M_PI) angle <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> M_PI;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> angle;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ä»¿çœŸç®¡ç†å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SimulationManager</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    SimulationManager(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> UAVDynamicsParams<span style=color:#f92672>&amp;</span> params,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&amp;</span> leader_trajectory,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> num_followers)
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> dynamics_params(params)
</span></span><span style=display:flex><span>        , num_uavs(num_followers <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)  <span style=color:#75715e>// åŒ…æ‹¬é¢†èˆªæœº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// åˆ›å»ºç¼–é˜Ÿæ§åˆ¶å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>auto</span> formation_params <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>make_shared<span style=color:#f92672>&lt;</span>LineFormationParams<span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>5.0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> smoother <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>make_shared<span style=color:#f92672>&lt;</span>SimpleSmoothing<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        formation_controller <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>make_unique<span style=color:#f92672>&lt;</span>FormationController<span style=color:#f92672>&gt;</span>(
</span></span><span style=display:flex><span>            FormationType<span style=color:#f92672>::</span>LINE,
</span></span><span style=display:flex><span>            formation_params,
</span></span><span style=display:flex><span>            smoother
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ç”Ÿæˆç¼–é˜Ÿè½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>auto</span> formation_trajectories <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>            formation_controller<span style=color:#f92672>-&gt;</span>generateFormationTrajectories(
</span></span><span style=display:flex><span>                leader_trajectory,
</span></span><span style=display:flex><span>                num_followers
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ä¸ºæ¯ä¸ªUAVåˆ›å»ºè½¨è¿¹è·Ÿè¸ªå™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        trackers.push_back(std<span style=color:#f92672>::</span>make_unique<span style=color:#f92672>&lt;</span>TrajectoryTracker<span style=color:#f92672>&gt;</span>(params));
</span></span><span style=display:flex><span>        trackers[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>-&gt;</span>setTrajectory(leader_trajectory);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> num_followers; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            trackers.push_back(std<span style=color:#f92672>::</span>make_unique<span style=color:#f92672>&lt;</span>TrajectoryTracker<span style=color:#f92672>&gt;</span>(params));
</span></span><span style=display:flex><span>            trackers[i]<span style=color:#f92672>-&gt;</span>setTrajectory(formation_trajectories[i]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// åˆå§‹åŒ–UAVçŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        current_states.resize(num_uavs);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> num_uavs; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>                current_states[i] <span style=color:#f92672>=</span> leader_trajectory[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                current_states[i] <span style=color:#f92672>=</span> formation_trajectories[i][<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å•æ­¥ä»¿çœŸ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>stepSimulation</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> num_uavs; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>            current_states[i] <span style=color:#f92672>=</span> trackers[i]<span style=color:#f92672>-&gt;</span>updateState(current_states[i]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è·å–å½“å‰æ‰€æœ‰UAVçŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;&amp;</span> getCurrentStates() <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> current_states;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    UAVDynamicsParams dynamics_params;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> num_uavs;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>unique_ptr<span style=color:#f92672>&lt;</span>FormationController<span style=color:#f92672>&gt;</span> formation_controller;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>unique_ptr<span style=color:#f92672>&lt;</span>TrajectoryTracker<span style=color:#f92672>&gt;&gt;</span> trackers;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span> current_states;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>} <span style=color:#75715e>// namespace uav
</span></span></span></code></pre></div><h4 id=ä»£ç è¯´æ˜-3>ä»£ç è¯´æ˜</h4><p>è¿™ä¸ªå®ç°æä¾›äº†å®Œæ•´çš„è½¨è¿¹è·Ÿè¸ªåŠŸèƒ½ã€‚ä¸»è¦åŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼š</p><ol><li><p><strong>TrajectoryTrackerç±»</strong>ï¼š</p><ul><li>å®ç°PIDæ§åˆ¶çš„è½¨è¿¹è·Ÿè¸ªå™¨</li><li>è€ƒè™‘äº†æ— äººæœºåŠ¨åŠ›å­¦çº¦æŸ</li><li>æä¾›èˆªå‘è§’å’Œé€Ÿåº¦æ§åˆ¶</li><li>æ”¯æŒå®æ—¶çŠ¶æ€æ›´æ–°</li></ul></li><li><p><strong>SimulationManagerç±»</strong>ï¼š</p><ul><li>ç®¡ç†æ•´ä¸ªä»¿çœŸè¿‡ç¨‹</li><li>é›†æˆç¼–é˜Ÿæ§åˆ¶å’Œè½¨è¿¹è·Ÿè¸ª</li><li>æä¾›ç»Ÿä¸€çš„ä»¿çœŸæ­¥è¿›æ¥å£</li></ul></li></ol><h4 id=ä½¿ç”¨ç¤ºä¾‹>ä½¿ç”¨ç¤ºä¾‹</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> uav;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºåŠ¨åŠ›å­¦å‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>UAVDynamicsParams <span style=color:#a6e22e>params</span>(
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>30.0</span>,  <span style=color:#f92672>//</span> <span style=color:#960050;background-color:#1e0010>æœ€å¤§é€Ÿåº¦</span> (m<span style=color:#f92672>/</span>s)
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>15.0</span>,  <span style=color:#75715e>// æœ€å°é€Ÿåº¦ (m/s)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#ae81ff>5.0</span>,   <span style=color:#75715e>// æœ€å¤§åŠ é€Ÿåº¦ (m/s^2)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#ae81ff>0.5</span>,   <span style=color:#75715e>// æœ€å¤§åèˆªè§’é€Ÿç‡ (rad/s)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#ae81ff>50.0</span>   <span style=color:#75715e>// æ§åˆ¶é¢‘ç‡ (Hz)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºé¢†èˆªæœºè½¨è¿¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>UAVState<span style=color:#f92672>&gt;</span> leader_trajectory <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    UAVState(Point2D(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>), <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    UAVState(Point2D(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>0</span>), <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    UAVState(Point2D(<span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>50</span>), M_PI<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ... æ›´å¤šè½¨è¿¹ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºä»¿çœŸç®¡ç†å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>SimulationManager <span style=color:#a6e22e>sim</span>(params, leader_trajectory, <span style=color:#ae81ff>3</span>);  <span style=color:#75715e>// 3ä¸ªè·Ÿéšè€…
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ä»¿çœŸä¸»å¾ªç¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> sim_time <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>double</span> sim_duration <span style=color:#f92672>=</span> <span style=color:#ae81ff>100.0</span>;  <span style=color:#75715e>// ä»¿çœŸ100ç§’
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>while</span> (sim_time <span style=color:#f92672>&lt;</span> sim_duration) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ›´æ–°ä»¿çœŸ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    sim.stepSimulation();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è·å–å½“å‰çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> states <span style=color:#f92672>=</span> sim.getCurrentStates();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å¯è§†åŒ–æˆ–æ•°æ®è®°å½•ä»£ç 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> state : states) {
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Position: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> state.position.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> 
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> state.position.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    sim_time <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>/</span> params.control_frequency;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>è¯¥å®ç°çš„ç‰¹ç‚¹ï¼š</p><ol><li><p><strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼š</p><ul><li>è½¨è¿¹è·Ÿè¸ªå’Œä»¿çœŸç®¡ç†åˆ†ç¦»</li><li>ä¾¿äºé›†æˆåˆ°æ›´å¤§çš„ç³»ç»Ÿä¸­</li></ul></li><li><p><strong>å®Œæ•´çš„æ§åˆ¶æµç¨‹</strong>ï¼š</p><ul><li>åŒ…å«PIDæ§åˆ¶å™¨</li><li>è€ƒè™‘åŠ¨åŠ›å­¦çº¦æŸ</li><li>æ”¯æŒè¿ç»­è½¨è¿¹è·Ÿè¸ª</li></ul></li><li><p><strong>å¯æ‰©å±•æ€§</strong>ï¼š</p><ul><li>å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„æ§åˆ¶ç®—æ³•</li><li>æ”¯æŒä¸åŒçš„ç¼–é˜Ÿå½¢å¼</li><li>å¯ä»¥é›†æˆå…¶ä»–åŠ¨åŠ›å­¦æ¨¡å‹</li></ul></li><li><p><strong>ä»¿çœŸå‹å¥½</strong>ï¼š</p><ul><li>æ”¯æŒæ­¥è¿›å¼ä»¿çœŸ</li><li>ä¾¿äºæ•°æ®è®°å½•å’Œå¯è§†åŒ–</li><li>æ”¯æŒå¤šæœºååŒä»¿çœŸ</li></ul></li></ol><p>è¦æ ¹æ®å…·ä½“éœ€æ±‚ä½¿ç”¨è¿™ä¸ªä»£ç ï¼Œä½ å¯èƒ½éœ€è¦ï¼š</p><ol><li>è°ƒæ•´PIDæ§åˆ¶å™¨å‚æ•°</li><li>æ·»åŠ å…·ä½“çš„å¯è§†åŒ–ä»£ç </li><li>æ ¹æ®å®é™…æ— äººæœºæ€§èƒ½ä¿®æ”¹åŠ¨åŠ›å­¦å‚æ•°</li><li>æ·»åŠ æ•°æ®è®°å½•å’Œåˆ†æåŠŸèƒ½</li></ol><h2 id=é™„å½•2-é˜µå‹è¿‡æ¸¡è¿‡ç¨‹ä¸­éœ€æ³¨æ„çš„é—®é¢˜>é™„å½•2. é˜µå‹è¿‡æ¸¡è¿‡ç¨‹ä¸­éœ€æ³¨æ„çš„é—®é¢˜</h2><p>åœ¨é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ï¼Œè¦å®ç°é«˜æ•ˆè¿‡æ¸¡å¹¶å°½é‡é¿å…ç¢°æ’ï¼Œé€šå¸¸éœ€è¦ä»è§„åˆ’ã€åè°ƒã€ä»¥åŠå®æ—¶è°ƒæ•´ç­‰å¤šä¸ªå±‚é¢è€ƒè™‘ã€‚</p><p>åœ¨é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†é«˜æ•ˆå®ç°è¿‡æ¸¡å¹¶å°½é‡é¿å…ç¢°æ’ï¼Œå»ºè®®é‡‡å–ä»¥ä¸‹ç»¼åˆç­–ç•¥ï¼š</p><ol><li><strong>æœ€ä¼˜ä»»åŠ¡åˆ†é…</strong>ï¼šåˆç†åˆ†é…æ¯æ¶ UAV çš„ç›®æ ‡ä½ç½®ï¼Œé¿å…è·¯å¾„äº¤å‰ã€‚</li><li><strong>å¹³æ»‘ã€æ—¶é—´å‚æ•°åŒ–çš„è½¨è¿¹è§„åˆ’</strong>ï¼šåˆ©ç”¨æ›²çº¿è§„åˆ’æ–¹æ³•ç”Ÿæˆè¿ç»­ä¸”æ»¡è¶³ UAV åŠ¨åŠ›å­¦è¦æ±‚çš„è½¨è¿¹ï¼Œå¹¶åœ¨æ—¶é—´ä¸Šåˆç†é”™å¼€ UAV çš„é€šè¿‡æ—¶åˆ»ã€‚</li><li><strong>ç¢°æ’çº¦æŸä¸å±€éƒ¨é¿ç¢°</strong>ï¼šåœ¨å…¨å±€è§„åˆ’ä¸­èå…¥ç¢°æ’çº¦æŸï¼Œå¹¶è®¾ç½®å±€éƒ¨é¿ç¢°æœºåˆ¶åº”å¯¹æ„å¤–æƒ…å†µã€‚</li><li><strong>åˆ†å¸ƒå¼åè°ƒä¸å®æ—¶åé¦ˆ</strong>ï¼šé€šè¿‡ UAV é—´ä¿¡æ¯å…±äº«å’Œå®æ—¶æ§åˆ¶ï¼Œç¡®ä¿åœ¨è¿‡æ¸¡è¿‡ç¨‹ä¸­å„ UAV èƒ½å¤ŸååŒè°ƒæ•´ï¼Œç»´æŒå®‰å…¨è·ç¦»ã€‚</li></ol><p>é‡‡ç”¨ä¸Šè¿°æ–¹æ³•å¯ä»¥æœ‰æ•ˆé™ä½é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ UAV è·¯å¾„äº¤å‰å’Œç¢°æ’çš„é£é™©ï¼ŒåŒæ—¶å…¼é¡¾å˜æ¢æ•ˆç‡ï¼Œé€‚åº”åŠ¨æ€å˜åŒ–çš„ä»»åŠ¡éœ€æ±‚ã€‚</p><hr><h3 id=1-ä»»åŠ¡åˆ†é…ä¸ç›®æ ‡åŒ¹é…>1. ä»»åŠ¡åˆ†é…ä¸ç›®æ ‡åŒ¹é…</h3><ul><li><p><strong>ç›®æ ‡åˆ†é…ä¼˜åŒ–</strong><br>åœ¨å˜æ¢å¼€å§‹å‰ï¼Œå¯ä»¥é‡‡ç”¨æœ€ä¼˜åŒ¹é…ç®—æ³•ï¼ˆå¦‚åŒˆç‰™åˆ©ç®—æ³•ï¼‰ä¸ºæ¯æ¶ UAV åˆ†é…ç›®æ ‡ä½ç½®ï¼Œç¡®ä¿æ€»è¡Œç¨‹æœ€çŸ­ä¸”é¿å…äº¤å‰è·¯å¾„ã€‚è¿™æ ·å¯ä»¥å‡å°‘ UAV é—´è·¯å¾„äº¤å‰å’Œå†²çªçš„å¯èƒ½æ€§ã€‚</p></li><li><p><strong>è€ƒè™‘é˜Ÿå½¢é—´ç›¸å¯¹é¡ºåº</strong><br>ä¿æŒ UAV åœ¨é˜Ÿå½¢å†…çš„ç›¸å¯¹é¡ºåºï¼Œå‡å°‘è·¯å¾„äº¤å‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å›ºå®šéƒ¨åˆ† UAV çš„ç›¸å¯¹ä½ç½®ï¼Œä»…è®©å°‘æ•° UAV è°ƒæ•´ä½ç½®ï¼Œä»è€Œé™ä½æ•´ä½“ç¢°æ’é£é™©ã€‚</p></li></ul><hr><h3 id=2-è¿‡æ¸¡è½¨è¿¹ç”Ÿæˆ>2. è¿‡æ¸¡è½¨è¿¹ç”Ÿæˆ</h3><ul><li><p><strong>å¹³æ»‘è½¨è¿¹è§„åˆ’</strong><br>åˆ©ç”¨æ ·æ¡æ›²çº¿ã€BÃ©zier æ›²çº¿æˆ–è€…å¤šé¡¹å¼è½¨è¿¹è§„åˆ’æ–¹æ³•ï¼Œåœ¨åˆå§‹å’Œç›®æ ‡ä½ç½®ä¹‹é—´ç”Ÿæˆè¿ç»­ã€å…‰æ»‘çš„è¿‡æ¸¡è½¨è¿¹ã€‚å¹³æ»‘è½¨è¿¹æœ‰åŠ©äºæ»¡è¶³ UAV çš„åŠ¨åŠ›å­¦çº¦æŸï¼ˆå¦‚æœ€å°è½¬å¼¯åŠå¾„ï¼‰å¹¶å‡å°‘æ€¥å‰§å˜æ¢ã€‚</p></li><li><p><strong>æ—¶é—´å‚æ•°åŒ–</strong><br>ä¸ºæ¯ä¸ª UAV çš„è¿‡æ¸¡è½¨è¿¹å¢åŠ æ—¶é—´æ ‡è®°ï¼Œä½¿å¾— UAV åœ¨ä¸åŒæ—¶é—´æ®µé€šè¿‡å„è‡ªçš„è¿‡æ¸¡åŒºåŸŸã€‚é€šè¿‡æ—¶é—´åŒæ­¥æ§åˆ¶ï¼Œåè°ƒå„ UAV çš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ï¼Œé™ä½åœ¨åŒä¸€åŒºåŸŸåŒæ—¶å‡ºç°çš„é£é™©ã€‚</p></li><li><p><strong>åˆ†æ®µè§„åˆ’ä¸ç¼“å†²åŒºåŸŸ</strong><br>å¯ä»¥å°†è¿‡æ¸¡è¿‡ç¨‹åˆ’åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µå…ˆå®Œæˆå±€éƒ¨é˜Ÿå½¢è°ƒæ•´ï¼Œä¸”åœ¨å…³é”®è½¬æŠ˜ç‚¹è®¾ç½®ç¼“å†²åŒºåŸŸï¼Œç»™ UAV è¶³å¤Ÿçš„æ—¶é—´å’Œç©ºé—´é¿å¼€ä¸´è¿‘ UAVã€‚</p></li></ul><hr><h3 id=3-ç¢°æ’é¿å…ç­–ç•¥>3. ç¢°æ’é¿å…ç­–ç•¥</h3><ul><li><p><strong>ä¼˜åŒ–ä¸­åŠ å…¥ç¢°æ’çº¦æŸ</strong><br>åœ¨è½¨è¿¹è§„åˆ’çš„ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œå¼•å…¥ UAV é—´æœ€å°å®‰å…¨è·ç¦»ä½œä¸ºçº¦æŸæ¡ä»¶ã€‚åˆ©ç”¨è¯¸å¦‚åºåˆ—äºŒæ¬¡è§„åˆ’ï¼ˆSQPï¼‰ã€æ¨¡å‹é¢„æµ‹æ§åˆ¶ï¼ˆMPCï¼‰ç­‰æ–¹æ³•ï¼Œå°†ç¢°æ’çº¦æŸèå…¥å…¨å±€è½¨è¿¹è§„åˆ’ä¸­ï¼Œç”Ÿæˆæ»¡è¶³åŠ¨æ€çº¦æŸä¸”é¿å…ç¢°æ’çš„è½¨è¿¹ã€‚</p></li><li><p><strong>å±€éƒ¨é¿ç¢°æœºåˆ¶</strong><br>åœ¨ UAV å®é™…é£è¡Œä¸­ï¼Œå¯å®æ—¶ç›‘æµ‹ UAV é—´è·ç¦»ï¼Œå½“æ£€æµ‹åˆ°æ½œåœ¨ç¢°æ’é£é™©æ—¶ï¼Œè§¦å‘å±€éƒ¨é¿ç¢°ç­–ç•¥ï¼ˆå¦‚å°å¹…åç¦»ã€å‡é€Ÿæˆ–æš‚åœï¼‰ï¼Œä¿è¯ UAV åœ¨çŸ­æ—¶é—´å†…ä¸è¿›å…¥å±é™©åŒºåŸŸã€‚<br>è¿™ç§å±€éƒ¨é¿ç¢°å¯ä»¥åŸºäºä¼ æ„Ÿå™¨åé¦ˆå’Œç®€å•çš„æ§åˆ¶è§„åˆ™å®ç°ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨åŸºäºäººå·¥åŠ¿åœºçš„æ–¹æ³•è¿›è¡ŒåŠ¨æ€è°ƒæ•´ã€‚</p></li><li><p><strong>åˆ†å¸ƒå¼åè°ƒè§„åˆ’</strong><br>æ¯æ¶ UAV æ ¹æ®è‡ªèº«çŠ¶æ€å’Œé‚»è¿‘ UAV çš„ä¿¡æ¯è¿›è¡Œå±€éƒ¨è½¨è¿¹è°ƒæ•´ï¼Œå¹¶é€šè¿‡é€šä¿¡åè°ƒå½¢æˆä¸€è‡´çš„å…¨å±€å˜æ¢ã€‚åˆ†å¸ƒå¼æ–¹æ³•èƒ½æé«˜é²æ£’æ€§å’Œå“åº”é€Ÿåº¦ï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§è§„æ¨¡ UAV é˜Ÿå½¢ã€‚</p></li></ul><hr><h3 id=4-åœ¨çº¿è°ƒæ•´ä¸åé¦ˆæ§åˆ¶>4. åœ¨çº¿è°ƒæ•´ä¸åé¦ˆæ§åˆ¶</h3><ul><li><p><strong>å®æ—¶åé¦ˆæœºåˆ¶</strong><br>åœ¨ UAV è·Ÿè¸ªé¢„å®šè¿‡æ¸¡è½¨è¿¹æ—¶ï¼Œåˆ©ç”¨å®æ—¶çŠ¶æ€åé¦ˆå¯¹è½¨è¿¹è¿›è¡ŒåŠ¨æ€ä¿®æ­£ã€‚ç»“åˆé¢„æµ‹æ¨¡å‹ï¼Œå½“æ£€æµ‹åˆ°è½¨è¿¹åç¦»æˆ–æ½œåœ¨ç¢°æ’æ—¶ï¼ŒåŠæ—¶è°ƒæ•´æ§åˆ¶å‘½ä»¤ä»¥æ¢å¤å®‰å…¨çŠ¶æ€ã€‚</p></li><li><p><strong>é€Ÿåº¦ä¸åŠ é€Ÿåº¦è°ƒæ§</strong><br>æ ¹æ®è¿‡æ¸¡åŒºåŸŸå†… UAV å¯†åº¦åŠç¯å¢ƒé£é™©ï¼Œé€‚æ—¶é™ä½é€Ÿåº¦æˆ–è°ƒæ•´åŠ é€Ÿåº¦ï¼Œä¸ºè½¨è¿¹å˜æ¢ç•™å‡ºæ›´å¤šå†—ä½™æ—¶é—´ï¼Œé™ä½å› é€Ÿåº¦è¿‡å¿«å¯¼è‡´çš„ç¢°æ’é£é™©ã€‚</p></li></ul><hr><h2 id=é™„å½•3-é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ä¿è¯è·Ÿè¸ªå‰æ–¹çš„è½¨è¿¹ç‚¹>é™„å½•3. é˜µå‹å˜æ¢è¿‡ç¨‹ä¸­ä¿è¯è·Ÿè¸ªå‰æ–¹çš„è½¨è¿¹ç‚¹</h2><p>é€šè¿‡åœ¨è½¨è¿¹è§„åˆ’é˜¶æ®µè®¾è®¡æ­£å‘åç½®ï¼Œå¹¶åœ¨ UAV è·Ÿè¸ªæ§åˆ¶ä¸­é‡‡ç”¨å‰ç»å‚è€ƒç‚¹é€‰æ‹©ç®—æ³•ï¼ˆç»“åˆè·ç¦»å’Œå‡ ä½•åˆ¤æ–­ï¼‰ï¼Œå¯ä»¥æœ‰æ•ˆä¿è¯é˜µå‹è¿‡æ¸¡è¿‡ç¨‹ä¸­æ¯æ¶å›ºå®šç¿¼ UAV çš„æœŸæœ›è½¨è¿¹ç‚¹å§‹ç»ˆä½äºå‰è¿›æ–¹å‘å‰ï¼Œä»è€Œæ»¡è¶³å›ºå®šç¿¼ UAV çš„é£è¡ŒåŠ¨æ€è¦æ±‚ï¼Œå¹¶é™ä½å› ç›®æ ‡ç‚¹é€‰æ‹©ä¸å½“å¼•èµ·çš„è·Ÿè¸ªè¯¯å·®æˆ–ç¢°æ’é£é™©ã€‚</p><p>ä¸‹é¢ç»™å‡ºçš„å®æ–½æ–¹æ¡ˆï¼Œæ—¨åœ¨ç¡®ä¿åœ¨é˜µå‹è¿‡æ¸¡è¿‡ç¨‹ä¸­ï¼Œæ¯æ¶å›ºå®šç¿¼ UAV çš„æœŸæœ›è½¨è¿¹ç‚¹å§‹ç»ˆä½äºå…¶å‰è¿›æ–¹å‘å‰ï¼Œè€Œä¸æ˜¯åæ–¹ã€‚æ–¹æ¡ˆåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><hr><h3 id=1-æ€»ä½“æ€è·¯>1 æ€»ä½“æ€è·¯</h3><ol><li><p><strong>è½¨è¿¹è§„åˆ’æ—¶çš„æ­£å‘è®¾è®¡</strong></p><ul><li><strong>ç”Ÿæˆå¹³æ»‘è¿‡æ¸¡è½¨è¿¹</strong>ï¼šåœ¨ç”Ÿæˆä»åˆå§‹ï¼ˆæ¨ªæ’ï¼‰åˆ°ç›®æ ‡ï¼ˆæ¥”å½¢ï¼‰çŠ¶æ€çš„å¹³æ»‘è½¨è¿¹æ—¶ï¼Œé‡‡ç”¨å±€éƒ¨åæ ‡ç³»ï¼Œå…¶ä¸­ x è½´ä»£è¡¨ UAV å‰è¿›æ–¹å‘ï¼Œä¿è¯è½¨è¿¹ç‚¹åœ¨å±€éƒ¨åæ ‡ç³»ä¸­ x åæ ‡å•è°ƒé€’å¢ã€‚</li><li><strong>é¢„ç•™å‰å‘åç½®</strong>ï¼šåœ¨è§„åˆ’è¿‡ç¨‹ä¸­ï¼Œå¯¹æ¯ä¸ª UAV çš„è½¨è¿¹æ–½åŠ æ­£å‘åç½®ï¼Œç¡®ä¿è½¨è¿¹æ•´ä½“å»¶ä¼¸äº UAV å‰æ–¹ã€‚</li></ul></li><li><p><strong>å‰ç»ï¼ˆLookaheadï¼‰å‚è€ƒç‚¹é€‰æ‹©</strong></p><ul><li><strong>å‰ç»è·ç¦»è®¾å®š</strong>ï¼šå®šä¹‰ä¸€ä¸ªåˆé€‚çš„å‰ç»è·ç¦» $ L $ï¼ˆä¾‹å¦‚ 10ï½20 ç±³ï¼‰ï¼Œä¿è¯ UAV è·Ÿè¸ªæ—¶æ€»æ˜¯é€‰æ‹©è·ç¦»å½“å‰ä½ç½®å¤§äº $ L $ çš„å‚è€ƒç‚¹ã€‚</li><li><strong>å‡ ä½•åˆ¤æ–­</strong>ï¼šåœ¨å®æ—¶è·Ÿè¸ªæ—¶ï¼Œåˆ©ç”¨å½“å‰ UAV çŠ¶æ€è®¡ç®—å…¶å‰è¿›æ–¹å‘ï¼ˆé€šå¸¸é€šè¿‡å½“å‰èˆªå‘è§’å¾—åˆ°å‰å‘å•ä½å‘é‡ $\vec{v}=(\cos\theta,\sin\theta)$ï¼‰ï¼Œç„¶åä»é¢„å…ˆè§„åˆ’å¥½çš„è½¨è¿¹ä¸­é€‰å–æ»¡è¶³ï¼š<ul><li>è·ç¦»å½“å‰ UAV ä½ç½®å¤§äº $ L $ï¼Œä»¥åŠ</li><li>å‘é‡ $ \vec{w}= $ï¼ˆå€™é€‰ç‚¹ä½ç½® $-$ UAV å½“å‰ä½ç½®ï¼‰çš„ç‚¹ç§¯ $ \vec{v}\cdot\vec{w} > 0 $ï¼ˆç¡®ä¿å€™é€‰ç‚¹åœ¨ UAV å‰æ–¹ï¼‰<br>çš„è½¨è¿¹ç‚¹ä½œä¸ºå‚è€ƒç‚¹ã€‚</li></ul></li></ul></li><li><p><strong>å®æ—¶æ£€æµ‹ä¸è°ƒæ•´</strong></p><ul><li><strong>åŠ¨æ€ç›‘æ§</strong>ï¼šåœ¨æ¯ä¸ªä»¿çœŸæ—¶é—´æ­¥å†…ï¼Œå®æ—¶æ£€æµ‹å½“å‰å‚è€ƒç‚¹æ˜¯å¦æ»¡è¶³â€œåœ¨å‰æ–¹â€æ¡ä»¶ï¼›</li><li><strong>è°ƒæ•´ç­–ç•¥</strong>ï¼šè‹¥å‘ç°å‚è€ƒç‚¹å›  UAV çŠ¶æ€å˜åŒ–è€Œè½å…¥åæ–¹ï¼Œåˆ™é‡æ–°ä»è½¨è¿¹ä¸­æœç´¢åˆé€‚çš„å‰ç»å‚è€ƒç‚¹ï¼Œæˆ–å¯¹è½¨è¿¹åšå±€éƒ¨æ’å€¼ä¿®æ­£ã€‚</li></ul></li></ol><hr><h3 id=2-å…·ä½“å®æ–½æ­¥éª¤>2. å…·ä½“å®æ–½æ­¥éª¤</h3><h4 id=21-è½¨è¿¹è§„åˆ’é˜¶æ®µ>2.1 è½¨è¿¹è§„åˆ’é˜¶æ®µ</h4><ul><li><p><strong>è§„åˆ’å¹³æ»‘æ›²çº¿</strong><br>åˆ©ç”¨æ ·æ¡æ›²çº¿ã€BÃ©zier æ›²çº¿æˆ–å¤šé¡¹å¼æ’å€¼æŠ€æœ¯ï¼Œåœ¨ UAV çš„å±€éƒ¨åæ ‡ç³»ï¼ˆx ä¸ºå‰è¿›æ–¹å‘ï¼‰ä¸­ç”Ÿæˆä»åˆå§‹ç‚¹åˆ°ç›®æ ‡ç‚¹çš„å¹³æ»‘è½¨è¿¹ï¼Œç¡®ä¿æ¯ä¸ªè½¨è¿¹ç‚¹çš„ x åˆ†é‡å•è°ƒå¢åŠ ã€‚è¿™æ ·åœ¨å…¨å±€è½¬æ¢åï¼Œè½¨è¿¹è‡ªç„¶å‘ˆç°å‡ºæ²¿ UAV å‰è¿›æ–¹å‘å»¶ä¼¸çš„ç‰¹æ€§ã€‚</p></li><li><p><strong>å…¨å±€åæ ‡è½¬æ¢</strong><br>åœ¨æ¯ä¸ªæ—¶åˆ»ï¼Œå°†å±€éƒ¨è½¨è¿¹ç‚¹è½¬æ¢ä¸ºå…¨å±€åæ ‡ï¼š</p>$$
P_{\text{global}} = P_{\text{UAV}} + R(\theta) \cdot P_{\text{local}},
$$<p>å…¶ä¸­ $R(\theta)$ ä¸ºæ—‹è½¬çŸ©é˜µï¼Œå°†å±€éƒ¨ x è½´å¯¹é½åˆ° UAV å½“å‰èˆªå‘ã€‚</p></li></ul><h4 id=22-è·Ÿè¸ªé˜¶æ®µå®æ—¶é€‰æ‹©å‚è€ƒç‚¹>2.2 è·Ÿè¸ªé˜¶æ®µï¼ˆå®æ—¶é€‰æ‹©å‚è€ƒç‚¹ï¼‰</h4><p>åœ¨ä»¿çœŸæˆ–å®é™…é£è¡Œä¸­ï¼Œæ¯ä¸ª UAV æŒ‰å¦‚ä¸‹æ­¥éª¤è¿›è¡Œå®æ—¶å‚è€ƒç‚¹é€‰æ‹©ï¼š</p><ol><li><p><strong>è·å– UAV å½“å‰çŠ¶æ€</strong><br>åŒ…æ‹¬ä½ç½® $P$ å’Œèˆªå‘è§’ $\theta$ã€‚</p></li><li><p><strong>è®¡ç®— UAV å‰è¿›æ–¹å‘å‘é‡</strong><br>è®¾ï¼š</p>$$
\vec{v} = (\cos\theta,\, \sin\theta).
$$</li><li><p><strong>æ²¿è½¨è¿¹æœç´¢å€™é€‰ç‚¹</strong><br>éå†é¢„å…ˆç”Ÿæˆçš„è½¨è¿¹ç‚¹é›†åˆï¼Œå¯¹æ¯ä¸ªå€™é€‰ç‚¹ $ Q $ï¼š</p><ul><li><p>è®¡ç®—å‘é‡å·®ï¼š</p>$$
\vec{w} = Q - P.
$$</li><li><p>è®¡ç®—è·ç¦» $ d = \|\vec{w}\| $ å’Œç‚¹ç§¯ $ \vec{v}\cdot\vec{w} $ã€‚</p></li><li><p>å¦‚æœæ»¡è¶³ï¼š</p><ul><li>$ d \ge L $ï¼ˆæ»¡è¶³å‰ç»è·ç¦»ï¼‰ï¼Œ</li><li>ä¸” $ \vec{v}\cdot\vec{w} > 0 $ï¼ˆç¡®ä¿å€™é€‰ç‚¹åœ¨ UAV å‰æ–¹ï¼‰ï¼Œ</li></ul><p>åˆ™å°† $ Q $ ä½œä¸ºåˆé€‚çš„å‚è€ƒç‚¹ã€‚</p></li></ul></li><li><p><strong>é€‰æ‹©æœ€ä¼˜å€™é€‰ç‚¹</strong><br>è‹¥æœ‰å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„ç‚¹ï¼Œå¯é€‰è·ç¦»åˆšå¥½å¤§äº $ L $ çš„ç¬¬ä¸€ä¸ªç‚¹ï¼Œæˆ–è€…é€šè¿‡æ’å€¼æ–¹å¼è·å¾—ä¸€ä¸ªå¹³æ»‘çš„ç›®æ ‡å‚è€ƒç‚¹ã€‚</p></li><li><p><strong>å®æ—¶åé¦ˆä¸æ§åˆ¶</strong><br>å‚è€ƒç‚¹ç¡®å®šåï¼Œå°†å…¶ä½œä¸ºæœŸæœ›ä½ç½®ä¼ ç»™è·Ÿè¸ªæ§åˆ¶å™¨ï¼Œè¿›è¡Œè¯¯å·®è®¡ç®—å’Œæ§åˆ¶æŒ‡ä»¤ç”Ÿæˆã€‚è‹¥æ£€æµ‹åˆ°å½“å‰å‚è€ƒç‚¹ä¸å†æ»¡è¶³æ¡ä»¶ï¼ˆä¾‹å¦‚ UAV è¯¯å·®è¾ƒå¤§å¯¼è‡´å‚è€ƒç‚¹åœ¨åæ–¹ï¼‰ï¼Œåˆ™ç«‹å³é‡æ–°é€‰æ‹©æˆ–åŠ¨æ€æ›´æ–°ã€‚</p></li></ol><hr><h3 id=3-ç¤ºä¾‹å®ç°cä¼ªä»£ç >3. ç¤ºä¾‹å®ç°ï¼ˆC++ä¼ªä»£ç ï¼‰</h3><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•çš„ C++ ä¼ªä»£ç ï¼Œè¯´æ˜å¦‚ä½•ä»é¢„å…ˆç”Ÿæˆçš„è½¨è¿¹ä¸­é€‰å–å‰æ–¹å‚è€ƒç‚¹ï¼š</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å®šä¹‰äºŒç»´ç‚¹ç»“æ„ä½“
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Point</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å®šä¹‰ UAV çŠ¶æ€ç»“æ„ä½“
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>UAVState</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> theta; <span style=color:#75715e>// èˆªå‘è§’ï¼ˆå¼§åº¦ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è®¡ç®—ä¸¤ç‚¹ä¹‹é—´æ¬§æ°è·ç¦»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> <span style=color:#a6e22e>distance</span>(<span style=color:#66d9ef>const</span> Point<span style=color:#f92672>&amp;</span> p1, <span style=color:#66d9ef>const</span> Point<span style=color:#f92672>&amp;</span> p2) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> std<span style=color:#f92672>::</span>sqrt((p1.x <span style=color:#f92672>-</span> p2.x)<span style=color:#f92672>*</span>(p1.x <span style=color:#f92672>-</span> p2.x) <span style=color:#f92672>+</span> (p1.y <span style=color:#f92672>-</span> p2.y)<span style=color:#f92672>*</span>(p1.y <span style=color:#f92672>-</span> p2.y));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// é€‰æ‹©å‚è€ƒç‚¹å‡½æ•°ï¼šä»è½¨è¿¹ä¸­é€‰æ‹©ä¸€ä¸ªæ—¢æ»¡è¶³å‰ç»è·ç¦»åˆåœ¨å‰æ–¹çš„ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Point <span style=color:#a6e22e>selectReferencePoint</span>(<span style=color:#66d9ef>const</span> UAVState<span style=color:#f92672>&amp;</span> current, <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&amp;</span> trajectory, <span style=color:#66d9ef>double</span> lookaheadDistance) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// UAV å½“å‰ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Point currentPos{ current.x, current.y };
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®— UAV çš„å‰å‘å•ä½å‘é‡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Point forward{ std<span style=color:#f92672>::</span>cos(current.theta), std<span style=color:#f92672>::</span>sin(current.theta) };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// éå†è½¨è¿¹ç‚¹ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> candidate : trajectory) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—å€™é€‰ç‚¹ç›¸å¯¹äºå½“å‰çš„ä½ç½®å·®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Point diff { candidate.x <span style=color:#f92672>-</span> currentPos.x, candidate.y <span style=color:#f92672>-</span> currentPos.y };
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> d <span style=color:#f92672>=</span> distance(candidate, currentPos);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—ç‚¹ç§¯ï¼Œåˆ¤æ–­å€™é€‰ç‚¹æ˜¯å¦åœ¨å‰æ–¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>double</span> dot <span style=color:#f92672>=</span> forward.x <span style=color:#f92672>*</span> diff.x <span style=color:#f92672>+</span> forward.y <span style=color:#f92672>*</span> diff.y;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (d <span style=color:#f92672>&gt;=</span> lookaheadDistance <span style=color:#f92672>&amp;&amp;</span> dot <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// æ‰¾åˆ°åˆé€‚çš„å‚è€ƒç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>return</span> candidate;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ç‚¹ï¼Œè¿”å›è½¨è¿¹æœ«å°¾ç‚¹ï¼ˆæˆ–æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œå…¶ä»–å¤„ç†ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> trajectory.back();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç¤ºä¾‹ä¸»å‡½æ•°ï¼šæ¼”ç¤ºåœ¨æ¯ä¸ªæ—¶é—´æ­¥å¦‚ä½•é€‰æ‹©å‚è€ƒç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å‡è®¾å·²ç”Ÿæˆçš„å¹³æ»‘è¿‡æ¸¡è½¨è¿¹ï¼ˆå…¨å±€åæ ‡ï¼‰ï¼Œå¯ä»¥é€šè¿‡è§„åˆ’æ¨¡å—è·å¾—
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;</span> trajectory <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>}, {<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>10</span>}, {<span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>15</span>}, {<span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>20</span>}, {<span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>25</span>}
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä»¿çœŸå‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> lookaheadDistance <span style=color:#f92672>=</span> <span style=color:#ae81ff>10.0</span>; <span style=color:#75715e>// å‰ç»è·ç¦»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ¨¡æ‹Ÿ UAV åˆå§‹çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    UAVState uav <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>}; <span style=color:#75715e>// åˆå§‹ä½ç½® (0,0)ï¼Œèˆªå‘ 0 å¼§åº¦ï¼ˆæ­£å‘ x è½´ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä»¿çœŸå¾ªç¯ï¼ˆè¿™é‡Œåªåšç®€å•æ¨¡æ‹Ÿï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> step <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; step <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; <span style=color:#f92672>++</span>step) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å‡è®¾ UAV çŠ¶æ€ç”±æ§åˆ¶å™¨æ›´æ–°ï¼Œè¿™é‡Œåšç®€å•çº¿æ€§å‰è¿›æ¨¡æ‹Ÿ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        uav.x <span style=color:#f92672>+=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// æ¯æ­¥å‰è¿› 5 å•ä½
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// ä¾‹å¦‚ä¿æŒèˆªå‘ä¸å˜ï¼Œå®é™…å¯é€šè¿‡æ§åˆ¶å™¨è°ƒæ•´
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// é€‰æ‹©å‚è€ƒç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Point refPoint <span style=color:#f92672>=</span> selectReferencePoint(uav, trajectory, lookaheadDistance);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è¾“å‡ºå½“å‰çŠ¶æ€å’Œå‚è€ƒç‚¹ä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Step &#34;</span> <span style=color:#f92672>&lt;&lt;</span> step <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | UAV Position: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | Reference Point: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> refPoint.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> refPoint.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ­¤å¤„è°ƒç”¨æ§åˆ¶å™¨ï¼šè®¡ç®—è¯¯å·®ã€ç”Ÿæˆæ§åˆ¶å‘½ä»¤ï¼Œå¹¶æ›´æ–° UAV çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h5 id=ä»£ç è¯´æ˜-4>ä»£ç è¯´æ˜</h5><ul><li><strong>è½¨è¿¹ç”Ÿæˆæ¨¡å—</strong>ï¼šåº”ä¿è¯è§„åˆ’å‡ºçš„è½¨è¿¹åœ¨ UAV å±€éƒ¨åæ ‡ç³»ä¸­ x è½´å•è°ƒé€’å¢ï¼Œè¿™æ ·å…¨å±€è½¬æ¢åï¼Œå¤§éƒ¨åˆ†è½¨è¿¹ç‚¹è‡ªç„¶åœ¨ UAV å‰æ–¹ã€‚</li><li><strong>å‰ç»ç­–ç•¥</strong>ï¼šåœ¨ <code>selectReferencePoint</code> å‡½æ•°ä¸­ï¼Œé€šè¿‡è·ç¦»å’Œç‚¹ç§¯åˆ¤æ–­ç¡®ä¿é€‰æ‹©çš„ç‚¹ä½äº UAV å‰æ–¹ä¸”æ»¡è¶³å‰ç»è·ç¦»è¦æ±‚ã€‚</li><li><strong>å®æ—¶æ›´æ–°</strong>ï¼šåœ¨ä»¿çœŸå¾ªç¯æˆ–é£è¡Œæ§åˆ¶ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ§åˆ¶å‘¨æœŸéƒ½è°ƒç”¨å‚è€ƒç‚¹é€‰æ‹©å‡½æ•°ï¼Œç¡®ä¿ UAV å§‹ç»ˆè·å–åˆé€‚çš„æœŸæœ›è½¨è¿¹ç‚¹ã€‚</li></ul><hr><h2 id=é™„å½•4-ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨>é™„å½•4. ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨</h2><p>ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨ï¼ˆMoving Average Filter, MA Filterï¼‰æ˜¯ä¸€ç§ç®€å•è€Œå¸¸ç”¨çš„æ•°å­—æ»¤æ³¢æ–¹æ³•ï¼Œå…¶ä¸»è¦åŸç†åœ¨äºå¯¹è¿ç»­çš„æ•°å€¼åºåˆ—è¿›è¡Œå±€éƒ¨å¹³å‡ï¼Œä»è€Œå‡å°‘æ•°æ®ä¸­çš„éšæœºå™ªå£°å’Œé«˜é¢‘æˆåˆ†ï¼Œèµ·åˆ°äº†ä½é€šæ»¤æ³¢å’Œä¿¡å·å¹³æ»‘çš„ä½œç”¨ï¼Œä¿ç•™ä¿¡å·çš„ä½é¢‘è¶‹åŠ¿ã€‚å®ƒç®€å•é«˜æ•ˆï¼Œæ˜“äºå®ç°ï¼Œé€‚ç”¨äºå®æ—¶æ•°æ®å¤„ç†ï¼Œä½†éœ€è¦æ³¨æ„ä¿¡å·å»¶è¿Ÿå’Œå¯èƒ½çš„è¿‡åº¦å¹³æ»‘é—®é¢˜ã€‚</p><hr><h3 id=1-åŸºæœ¬åŸç†>1. åŸºæœ¬åŸç†</h3><ul><li><p><strong>æ•°æ®å¹³æ»‘</strong>ï¼š<br>ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨é€šè¿‡è®¡ç®—å½“å‰æ•°æ®ç‚¹åŠå…¶ç›¸é‚»æ•°æ®ç‚¹çš„å¹³å‡å€¼ï¼Œå¹³æ»‘æ‰æ•°æ®ä¸­çš„çŸ­æœŸæ³¢åŠ¨ã€‚ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªç¦»æ•£æ—¶é—´åºåˆ— $ \{x(n)\} $ï¼Œå¦‚æœé‡‡ç”¨çª—å£å¤§å°ä¸º $ N $ï¼ˆä¸€èˆ¬ä¸ºå¥‡æ•°ï¼‰çš„ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨ï¼Œåˆ™æ»¤æ³¢åçš„è¾“å‡º $ y(n) $ é€šå¸¸å®šä¹‰ä¸ºï¼š</p>$$
y(n) = \frac{1}{N}\sum_{k=-M}^{M} x(n+k) \quad \text{å…¶ä¸­} \quad N=2M+1,
$$<p>ä¹Ÿå¯ä»¥é‡‡ç”¨åªè€ƒè™‘è¿‡å»çš„ $ N $ ä¸ªæ•°æ®ç‚¹çš„å½¢å¼ï¼š</p>$$
y(n) = \frac{1}{N}\sum_{k=0}^{N-1} x(n-k).
$$<p>è¿™ç§æ–¹æ³•é€šè¿‡å¯¹å±€éƒ¨çª—å£å†…çš„å¤šä¸ªæ•°æ®æ±‚å¹³å‡ï¼Œä»è€ŒæŠ‘åˆ¶éšæœºå™ªå£°å’Œçªå˜ï¼Œä½¿å¾—è¾“å‡ºä¿¡å·æ›´åŠ å¹³æ»‘å’Œè¿ç»­ã€‚</p></li><li><p><strong>ä½é€šæ»¤æ³¢</strong>ï¼š<br>ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨å®é™…ä¸Šæ˜¯ä¸€ç§ä½é€šæ»¤æ³¢å™¨ï¼Œå…¶é¢‘ç‡å“åº”ç±»ä¼¼äºä¸€ä¸ª sinc å‡½æ•°ã€‚ä½é¢‘æˆåˆ†ï¼ˆä¿¡å·çš„ä¸»è¦è¶‹åŠ¿ï¼‰èƒ½å¤Ÿè¾ƒå¥½åœ°ä¿ç•™ï¼Œè€Œé«˜é¢‘æˆåˆ†ï¼ˆå™ªå£°æˆ–å¿«é€Ÿæ³¢åŠ¨ï¼‰åˆ™è¢«è¡°å‡æ‰ã€‚è¿™æ˜¯å› ä¸ºç›¸é‚»æ•°æ®ä¸­çš„é«˜é¢‘æˆåˆ†åœ¨å¹³å‡è¿‡ç¨‹ä¸­ç›¸äº’æŠµæ¶ˆï¼Œä»è€Œè¾¾åˆ°å¹³æ»‘æ•ˆæœã€‚</p></li></ul><hr><h3 id=2-æ•°å­¦æ¨¡å‹å’Œé¢‘ç‡å“åº”>2. æ•°å­¦æ¨¡å‹å’Œé¢‘ç‡å“åº”</h3><ul><li><p><strong>æ•°å­¦æ¨¡å‹</strong>ï¼š<br>ä»¥å¯¹ç§°çª—å£ä¸ºä¾‹ï¼Œå‡è®¾æ»¤æ³¢å™¨çš„å†²æ¿€å“åº”ä¸ºï¼š</p>$$
h(k) = \frac{1}{N}, \quad k = -M, \ldots, M.
$$<p>åˆ™æ»¤æ³¢å™¨çš„è¾“å‡ºä¸ºï¼š</p>$$
y(n) = \sum_{k=-M}^{M} h(k)x(n+k) = \frac{1}{N}\sum_{k=-M}^{M} x(n+k).
$$<p>è¿™æ˜¯ä¸€ä¸ªæœ‰é™è„‰å†²å“åº”ï¼ˆFIRï¼‰æ»¤æ³¢å™¨ï¼Œå…¶æ‰€æœ‰ç³»æ•°å‡ä¸ºå¸¸æ•° $1/N$ã€‚</p></li><li><p><strong>é¢‘ç‡å“åº”</strong>ï¼š<br>å¯¹è¯¥ FIR æ»¤æ³¢å™¨åšç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢ï¼ˆDTFTï¼‰ï¼Œå¯ä»¥å¾—åˆ°å…¶é¢‘ç‡å“åº” $ H(e^{j\omega}) $ï¼š</p>$$
H(e^{j\omega}) = \frac{1}{N}\sum_{k=-M}^{M} e^{-j\omega k} = \frac{1}{N} \cdot \frac{\sin\left(\frac{N\omega}{2}\right)}{\sin\left(\frac{\omega}{2}\right)} e^{-j\omega M}.
$$<p>ä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œå…¶å¹…åº¦å“åº”å‘ˆç°å‡ºç±»ä¼¼ sinc å‡½æ•°çš„å½¢çŠ¶ï¼Œå¯¹ä½é¢‘ä¿¡å·é€šè¿‡è¾ƒå¤šï¼Œè€Œå¯¹é«˜é¢‘ä¿¡å·åˆ™èµ·åˆ°è¡°å‡ä½œç”¨ã€‚</p></li></ul><h3 id=3-windowsize-çš„é€‰å–>3. windowSize çš„é€‰å–</h3><p>åœ¨ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨ä¸­ï¼Œ<strong>windowSize</strong>ï¼ˆçª—å£å¤§å°ï¼‰è¡¨ç¤ºåœ¨è®¡ç®—æ¯ä¸ªæ»¤æ³¢è¾“å‡ºæ—¶æ‰€åŒ…å«çš„è¿ç»­æ•°æ®ç‚¹ä¸ªæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªç¦»æ•£ä¿¡å·ï¼Œæ»¤æ³¢å™¨ä¼šåœ¨å½“å‰ä½ç½®å‘¨å›´é€‰å–ä¸€ä¸ªçª—å£å†…çš„å¤šä¸ªæ ·æœ¬ï¼Œç„¶åè®¡ç®—è¿™äº›æ ·æœ¬çš„å¹³å‡å€¼ä½œä¸ºå½“å‰è¾“å‡ºå€¼ã€‚</p><h4 id=windowsize-çš„å«ä¹‰>windowSize çš„å«ä¹‰</h4><ul><li><p><strong>å¹³æ»‘ç¨‹åº¦</strong>ï¼š<br>çª—å£è¶Šå¤§ï¼Œæ»¤æ³¢å™¨ä¼šæ•´åˆæ›´å¤šæ•°æ®ç‚¹ï¼Œä»è€Œä½¿å¾—è¾“å‡ºä¿¡å·æ›´åŠ å¹³æ»‘ï¼Œèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°æŠ‘åˆ¶é«˜é¢‘å™ªå£°ã€‚ä½†åŒæ—¶ï¼Œè¿‡å¤§çš„çª—å£å¯èƒ½ä¼šä½¿å¾—ä¿¡å·ç»†èŠ‚ä¸¢å¤±ï¼Œå¯¼è‡´å“åº”æ»åã€‚</p></li><li><p><strong>å»¶è¿Ÿæ•ˆåº”</strong>ï¼š<br>ç”±äºæ»¤æ³¢å™¨éœ€è¦åˆ©ç”¨çª—å£å†…çš„æ•°æ®è®¡ç®—å¹³å‡å€¼ï¼Œå½“çª—å£è¾ƒå¤§æ—¶ï¼Œä¼šå¼•å…¥æ›´æ˜æ˜¾çš„å»¶è¿Ÿã€‚è¿™åœ¨å®æ—¶æ§åˆ¶ä¸­å¯èƒ½æ˜¯ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚</p></li><li><p><strong>é¢‘ç‡ç‰¹æ€§</strong>ï¼š<br>ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä½é€šæ»¤æ³¢å™¨ã€‚çª—å£å¤§å°è¶Šå¤§ï¼Œå…¶ä½é€šç‰¹æ€§è¶Šæ˜æ˜¾ï¼Œå³èƒ½å¤Ÿæ›´å¼ºåœ°æŠ‘åˆ¶é«˜é¢‘æˆåˆ†ï¼›çª—å£è¾ƒå°æ—¶ï¼Œæˆªæ­¢é¢‘ç‡è¾ƒé«˜ï¼Œæ»¤æ³¢æ•ˆæœç›¸å¯¹è¾ƒå¼±ã€‚</p></li></ul><h4 id=windowsize-çš„å–å€¼å‚è€ƒ>windowSize çš„å–å€¼å‚è€ƒ</h4><ol><li><p><strong>æ ¹æ®ä¿¡å·ç‰¹æ€§å’Œå™ªå£°æ°´å¹³</strong>ï¼š</p><ul><li>å¦‚æœåŸå§‹æ•°æ®å™ªå£°è¾ƒå¤§ï¼Œå¯ä»¥é€‰æ‹©è¾ƒå¤§çš„ windowSize ä»¥è·å¾—æ›´å¹³æ»‘çš„è¾“å‡ºã€‚</li><li>å¦‚æœæ•°æ®å˜åŒ–è¾ƒå¿«ã€éœ€è¦æ•æ‰ç»†èŠ‚ï¼Œåˆ™åº”é€‰ç”¨è¾ƒå°çš„ windowSizeã€‚</li></ul></li><li><p><strong>ä¸é‡‡æ ·ç‡æœ‰å…³</strong>ï¼š</p><ul><li>é‡‡æ ·ç‡è¾ƒé«˜æ—¶ï¼Œçª—å£ä¸­åŒ…å«çš„æ•°æ®ç‚¹æ›´å¤šï¼Œé€šå¸¸å¯ä»¥é€‚å½“å¢å¤§ windowSize æ¥å¹³æ»‘å™ªå£°ï¼Œä½†éœ€è¦æ³¨æ„ä¸è¦è¿‡å¤§ä»¥å…å¼•èµ·è¿‡å¤šå»¶è¿Ÿã€‚</li><li>é‡‡æ ·ç‡è¾ƒä½æ—¶ï¼ŒwindowSize ä¸€èˆ¬å–è¾ƒå°å€¼ï¼Œé¿å…æ•°æ®è¿‡åº¦å¹³å‡å¯¼è‡´ä¿¡å·å¤±çœŸã€‚</li></ul></li><li><p><strong>ç»éªŒå€¼å»ºè®®</strong>ï¼š</p><ul><li>å¯¹äºç®€å•åº”ç”¨ï¼Œå¸¸è§çš„å–å€¼ä¸º 3ã€5ã€7 æˆ– 9 ç­‰å¥‡æ•°ã€‚å¥‡æ•°çš„å¥½å¤„åœ¨äºèƒ½ä¿è¯çª—å£ä¸­å¿ƒå¯¹ç§°ï¼Œå‡å°‘ç›¸ä½å¤±çœŸã€‚</li><li>å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥å…ˆå°è¯• windowSize = 3 æˆ– 5ï¼Œç„¶åè§‚å¯Ÿæ»¤æ³¢åçš„ä¿¡å·å¹³æ»‘æ•ˆæœä¸å“åº”é€Ÿåº¦æ˜¯å¦æ»¡è¶³éœ€æ±‚ï¼Œå†è¿›è¡Œè°ƒæ•´ã€‚</li></ul></li><li><p><strong>ä»¿çœŸå’Œå®éªŒè°ƒè¯•</strong>ï¼š</p><ul><li>æœ€ç»ˆçš„ windowSize éœ€è¦ç»“åˆå…·ä½“åº”ç”¨è¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥é€šè¿‡ä»¿çœŸæˆ–å®éªŒè·å¾—æœ€ä½³å¹³è¡¡ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨æ— äººæœºè½¨è¿¹å¹³æ»‘ä¸­ï¼Œå¦‚æœç›®æ ‡æ˜¯å»é™¤å™ªå£°å¹¶ä¿æŒè¶³å¤Ÿçš„å“åº”é€Ÿåº¦ï¼Œå¯ä»¥ä» windowSize = 3 å¼€å§‹æµ‹è¯•ï¼Œç„¶åæ ¹æ®å¹³æ»‘æ•ˆæœå’Œç³»ç»Ÿå“åº”å»¶è¿Ÿé€æ­¥è°ƒæ•´åˆ°åˆé€‚çš„å€¼ã€‚</li></ul></li></ol><h4 id=æ€»ç»“>æ€»ç»“</h4><ul><li><strong>windowSize</strong> è¡¨ç¤ºè®¡ç®—å¹³å‡å€¼æ—¶æ‰€åŒ…å«çš„æ•°æ®ç‚¹æ•°ï¼Œå†³å®šäº†æ»¤æ³¢å™¨çš„å¹³æ»‘ç¨‹åº¦ä¸å»¶è¿Ÿæ•ˆåº”ã€‚</li><li>å–å€¼éœ€è¦åœ¨ä¿¡å·å¹³æ»‘ä¸åŠ¨æ€å“åº”ä¹‹é—´å–å¾—å¹³è¡¡ï¼š<ul><li>è¾ƒå¤§ windowSize â†’ å¹³æ»‘æ•ˆæœå¥½ã€å»¶è¿Ÿå¢å¤§ã€ç»†èŠ‚å¯èƒ½ä¸¢å¤±ï¼›</li><li>è¾ƒå° windowSize â†’ å¹³æ»‘æ•ˆæœå¼±ã€ç»†èŠ‚ä¿ç•™ã€å™ªå£°å¯èƒ½æœªå®Œå…¨æ»¤é™¤ã€‚</li></ul></li><li>å¸¸ç”¨ç»éªŒå€¼ä¸º 3ã€5ã€7 ç­‰ï¼Œå¹¶å»ºè®®ç»“åˆé‡‡æ ·ç‡å’Œå®é™…ç³»ç»Ÿéœ€æ±‚ï¼Œé€šè¿‡ä»¿çœŸå’Œå®éªŒç¡®å®šæœ€ä½³å€¼ã€‚</li></ul><p>æ ¹æ®ä»¥ä¸Šå‚è€ƒå’Œå®é™…åœºæ™¯è¿›è¡Œè°ƒæ•´ï¼Œå¯ä»¥è·å¾—æ—¢æ»¡è¶³å™ªå£°æŠ‘åˆ¶éœ€æ±‚åˆä¸ä¼šè¿‡å¤šå¼•å…¥å»¶è¿Ÿçš„æ»¤æ³¢æ•ˆæœã€‚</p><hr><h3 id=4-ä¼˜ç‚¹ä¸ç¼ºç‚¹>4. ä¼˜ç‚¹ä¸ç¼ºç‚¹</h3><ul><li><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li><strong>å®ç°ç®€å•</strong>ï¼šç®—æ³•åªéœ€è¦å¯¹å›ºå®šçª—å£å†…çš„æ•°æ®æ±‚å’Œå¹¶é™¤ä»¥çª—å£é•¿åº¦ï¼Œè®¡ç®—é‡å°ï¼Œæ˜“äºå®ç°ã€‚</li><li><strong>çº¿æ€§ç›¸ä½ç‰¹æ€§</strong>ï¼šç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨å±äºå¯¹ç§° FIR æ»¤æ³¢å™¨ï¼Œå› æ­¤å…·æœ‰çº¿æ€§ç›¸ä½ç‰¹æ€§ï¼Œä¸ä¼šå¼•å…¥ç›¸ä½å¤±çœŸï¼Œä¿æŒä¿¡å·æ³¢å½¢çš„å½¢çŠ¶ã€‚</li><li><strong>å®æ—¶æ€§å¥½</strong>ï¼šé€‚åˆäºå®æ—¶æ•°æ®å¤„ç†å’Œåœ¨çº¿å¹³æ»‘ã€‚</li></ul></li><li><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li><strong>ä¿¡å·å»¶è¿Ÿ</strong>ï¼šç”±äºæ»¤æ³¢å™¨éœ€è¦åˆ©ç”¨æœªæ¥æˆ–è¿‡å»çš„æ•°æ®è¿›è¡Œå¹³å‡ï¼Œä¼šäº§ç”Ÿä¸€å®šçš„å»¶è¿Ÿï¼Œå¯èƒ½å¯¼è‡´å“åº”æ»åã€‚</li><li><strong>é¢‘ç‡é€‰æ‹©æ€§è¾ƒå·®</strong>ï¼šç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨çš„æˆªæ­¢ç‰¹æ€§è¾ƒä¸ºå®½æ¾ï¼Œä¸èƒ½ç²¾ç¡®åˆ†ç¦»æŸä¸ªé¢‘æ®µå†…çš„ä¿¡å·å’Œå™ªå£°ï¼Œå¯¹æŸäº›åº”ç”¨åœºåˆå¯èƒ½ä¸å¤Ÿç†æƒ³ã€‚</li><li><strong>å¹³æ»‘è¿‡åº¦</strong>ï¼šå¦‚æœçª—å£å°ºå¯¸é€‰å¾—è¿‡å¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡å·ç»†èŠ‚ä¸¢å¤±ï¼Œè¿‡åº¦å¹³æ»‘ã€‚</li></ul></li></ul><hr><h3 id=5-åº”ç”¨åœºæ™¯>5. åº”ç”¨åœºæ™¯</h3><p>ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨å¹¿æ³›åº”ç”¨äºï¼š</p><ul><li>ä¿¡å·å™ªå£°æŠ‘åˆ¶ï¼ˆä¾‹å¦‚ä¼ æ„Ÿå™¨æ•°æ®ã€è‚¡ç¥¨ä»·æ ¼å¹³æ»‘ï¼‰</li><li>å›¾åƒå¤„ç†ä¸­çš„é™å™ª</li><li>æ•°å€¼æ•°æ®å¹³æ»‘ï¼Œæå–æ•°æ®çš„æ€»ä½“è¶‹åŠ¿</li></ul><p>åœ¨æ— äººæœºè½¨è¿¹è§„åˆ’ä¸­ï¼Œåˆ©ç”¨ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨å¯¹ç¦»æ•£è§„åˆ’çš„è½¨è¿¹ç‚¹è¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œå¯ä»¥æ¶ˆé™¤å› ç¦»æ•£é‡‡æ ·äº§ç”Ÿçš„ä¸è¿ç»­æ€§å’ŒæŠ–åŠ¨ï¼Œä½¿å¾—è½¨è¿¹æ›´åŠ å¹³æ»‘ä¸”ç¬¦åˆå›ºå®šç¿¼ UAV çš„é£è¡ŒåŠ¨æ€è¦æ±‚ã€‚</p><hr><h3 id=6-c-ä»£ç ç¤ºä¾‹>6. C++ ä»£ç ç¤ºä¾‹</h3><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªå®Œæ•´çš„ C++ ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹åœ¨ä¹‹å‰è½¨è¿¹ç”Ÿæˆå’Œå‰ç»å‚è€ƒç‚¹é€‰æ‹©çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€ä¸ªç®€å•çš„è½¨è¿¹å¹³æ»‘ç®—æ³•ï¼ˆåˆ©ç”¨ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨ï¼‰å¯¹åŸå§‹è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œç¡®ä¿ç”Ÿæˆçš„è½¨è¿¹å¹³æ»‘ä¸”è¿ç»­ã€‚å¹³æ»‘åçš„è½¨è¿¹å†ç”¨äºå®æ—¶é€‰æ‹©å‰æ–¹å‚è€ƒç‚¹ï¼Œä¿è¯ UAV å§‹ç»ˆè·Ÿè¸ªå‰æ–¹è½¨è¿¹ç‚¹ã€‚</p><p>ä»¥ä¸‹ä»£ç åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>æ•°æ®ç»“æ„å®šä¹‰åŠè¾…åŠ©å‡½æ•°ï¼ˆè·ç¦»è®¡ç®—ï¼‰ï¼›</li><li>å¹³æ»‘ç®—æ³•å‡½æ•° <code>smoothTrajectory</code>ï¼ˆé‡‡ç”¨ç§»åŠ¨å¹³å‡æ»¤æ³¢ï¼‰ï¼›</li><li>å‰ç»å‚è€ƒç‚¹é€‰æ‹©å‡½æ•° <code>selectReferencePoint</code> ä¸ä»¿çœŸä¸»å¾ªç¯ç¤ºä¾‹ã€‚</li></ol><hr><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cmath&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;algorithm&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ---------------------- æ•°æ®ç»“æ„å®šä¹‰ ----------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// è¡¨ç¤ºäºŒç»´ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Point</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// è¡¨ç¤º UAV çŠ¶æ€ï¼ˆä½ç½®åŠèˆªå‘è§’ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>UAVState</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> theta; <span style=color:#75715e>// èˆªå‘è§’ï¼ˆå¼§åº¦åˆ¶ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ---------------------- è¾…åŠ©å‡½æ•° ----------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„æ¬§æ°è·ç¦»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> <span style=color:#a6e22e>distance</span>(<span style=color:#66d9ef>const</span> Point<span style=color:#f92672>&amp;</span> p1, <span style=color:#66d9ef>const</span> Point<span style=color:#f92672>&amp;</span> p2) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> std<span style=color:#f92672>::</span>sqrt((p1.x <span style=color:#f92672>-</span> p2.x) <span style=color:#f92672>*</span> (p1.x <span style=color:#f92672>-</span> p2.x) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                     (p1.y <span style=color:#f92672>-</span> p2.y) <span style=color:#f92672>*</span> (p1.y <span style=color:#f92672>-</span> p2.y));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ---------------------- è½¨è¿¹å¹³æ»‘ç®—æ³• ----------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>    ä½¿ç”¨ç®€å•çš„ç§»åŠ¨å¹³å‡æ»¤æ³¢å™¨å¯¹åŸå§‹è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†ã€‚  
</span></span></span><span style=display:flex><span><span style=color:#75715e>    å‚æ•° windowSize ä¸ºæ»¤æ³¢çª—å£å¤§å°ï¼ˆå»ºè®®å–å¥‡æ•°ï¼‰ï¼Œçª—å£å†…æ‰€æœ‰ç‚¹çš„å‡å€¼ä½œä¸ºå½“å‰å¹³æ»‘åçš„ç‚¹ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;</span> smoothTrajectory(<span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&amp;</span> trajectory, <span style=color:#66d9ef>int</span> windowSize <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>) {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;</span> smoothed;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> trajectory.size();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (n <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> smoothed;
</span></span><span style=display:flex><span>    smoothed.resize(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> halfWindow <span style=color:#f92672>=</span> windowSize <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> sumX <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>, sumY <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è®¡ç®—çª—å£å†…ç‚¹çš„å‡å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span> start <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>max(<span style=color:#ae81ff>0</span>, i <span style=color:#f92672>-</span> halfWindow);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> end   <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>min(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, i <span style=color:#f92672>+</span> halfWindow);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> start; j <span style=color:#f92672>&lt;=</span> end; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            sumX <span style=color:#f92672>+=</span> trajectory[j].x;
</span></span><span style=display:flex><span>            sumY <span style=color:#f92672>+=</span> trajectory[j].y;
</span></span><span style=display:flex><span>            count<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        smoothed[i].x <span style=color:#f92672>=</span> sumX <span style=color:#f92672>/</span> count;
</span></span><span style=display:flex><span>        smoothed[i].y <span style=color:#f92672>=</span> sumY <span style=color:#f92672>/</span> count;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> smoothed;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ---------------------- å‰ç»å‚è€ƒç‚¹é€‰æ‹©å‡½æ•° ----------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>    ä»ç»™å®šè½¨è¿¹ä¸­é€‰æ‹©ä¸€ä¸ªæ»¡è¶³å‰ç»è·ç¦»ä¸”ä½äº UAV å½“å‰èˆªå‘å‰çš„ç‚¹ä½œä¸ºå‚è€ƒç‚¹ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>    æ¡ä»¶ï¼šå€™é€‰ç‚¹ä¸ UAV ä¹‹é—´çš„è·ç¦»å¤§äº lookaheadDistanceï¼Œ
</span></span></span><span style=display:flex><span><span style=color:#75715e>          ä¸”å€™é€‰ç‚¹ç›¸å¯¹äº UAV å½“å‰ä½ç½®åœ¨å‰è¿›æ–¹å‘ä¸Šï¼ˆç‚¹ç§¯å¤§äºé›¶ï¼‰ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>Point <span style=color:#a6e22e>selectReferencePoint</span>(<span style=color:#66d9ef>const</span> UAVState<span style=color:#f92672>&amp;</span> current, <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;&amp;</span> trajectory, <span style=color:#66d9ef>double</span> lookaheadDistance) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// UAV å½“å‰çš„ä½ç½®
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Point currentPos { current.x, current.y };
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è®¡ç®— UAV å‰è¿›æ–¹å‘ï¼ˆå•ä½å‘é‡ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Point forward { std<span style=color:#f92672>::</span>cos(current.theta), std<span style=color:#f92672>::</span>sin(current.theta) };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// éå†è½¨è¿¹ç‚¹ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å€™é€‰ç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> candidate : trajectory) {
</span></span><span style=display:flex><span>        Point diff { candidate.x <span style=color:#f92672>-</span> currentPos.x, candidate.y <span style=color:#f92672>-</span> currentPos.y };
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> d <span style=color:#f92672>=</span> distance(candidate, currentPos);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>double</span> dot <span style=color:#f92672>=</span> forward.x <span style=color:#f92672>*</span> diff.x <span style=color:#f92672>+</span> forward.y <span style=color:#f92672>*</span> diff.y;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (d <span style=color:#f92672>&gt;=</span> lookaheadDistance <span style=color:#f92672>&amp;&amp;</span> dot <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> candidate;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// è‹¥æœªæ‰¾åˆ°åˆé€‚ç‚¹ï¼Œåˆ™è¿”å›è½¨è¿¹æœ€åä¸€ä¸ªç‚¹ï¼ˆæˆ–æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œå…¶ä»–å¤„ç†ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> trajectory.back();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ---------------------- ä¸»å‡½æ•° ----------------------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åŸå§‹è½¨è¿¹ï¼ˆä¾‹å¦‚ä»æ¨ªæ’åˆ°æ¥”å½¢é˜µå‹è½¬æ¢è¿‡ç¨‹ä¸­çš„è§„åˆ’è½¨è¿¹ï¼Œå•ä½ä¸ºå…¨å±€åæ ‡ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;</span> rawTrajectory <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>}, {<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>10</span>}, {<span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>15</span>}, {<span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>20</span>}, {<span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>25</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>30</span>}, {<span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>35</span>}, {<span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>40</span>}, {<span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>45</span>}, {<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>50</span>}
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å¯¹åŸå§‹è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†ï¼ˆçª—å£å¤§å°å¯æ ¹æ®å®é™…éœ€è¦è°ƒæ•´ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>Point<span style=color:#f92672>&gt;</span> trajectory <span style=color:#f92672>=</span> smoothTrajectory(rawTrajectory, <span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä»¿çœŸä¸­è®¾å®šçš„å‰ç»è·ç¦»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> lookaheadDistance <span style=color:#f92672>=</span> <span style=color:#ae81ff>10.0</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åˆå§‹åŒ– UAV çŠ¶æ€ï¼šåˆå§‹ä½ç½® (0, 0)ï¼Œèˆªå‘ 0 å¼§åº¦ï¼ˆæ­£å‘ x è½´ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    UAVState uav {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>};
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ç®€å•ä»¿çœŸå¾ªç¯ï¼šæ¨¡æ‹Ÿ UAV æ²¿ x æ–¹å‘å‰è¿›ï¼Œå¹¶é€‰æ‹©åˆé€‚çš„å‚è€ƒç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> step <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; step <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; <span style=color:#f92672>++</span>step) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ¨¡æ‹Ÿ UAV å‰è¿›ï¼šæ¯ä¸ªæ—¶é—´æ­¥æ²¿ x è½´å‰è¿› 5 ä¸ªå•ä½ï¼ˆå®é™…ç³»ç»Ÿä¸­ç”±æ§åˆ¶å™¨æ›´æ–°çŠ¶æ€ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        uav.x <span style=color:#f92672>+=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// é€‰æ‹©å½“å‰æ—¶åˆ»çš„å‚è€ƒç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Point refPoint <span style=color:#f92672>=</span> selectReferencePoint(uav, trajectory, lookaheadDistance);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è¾“å‡ºå½“å‰ UAV çŠ¶æ€å’Œé€‰å–çš„å‚è€ƒç‚¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Step &#34;</span> <span style=color:#f92672>&lt;&lt;</span> step <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | UAV Position: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> uav.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; | Reference Point: (&#34;</span> <span style=color:#f92672>&lt;&lt;</span> refPoint.x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>&lt;&lt;</span> refPoint.y <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// æ­¤å¤„å¯è°ƒç”¨è·Ÿè¸ªæ§åˆ¶å™¨ï¼Œå°† refPoint ä½œä¸ºç›®æ ‡è¿›è¡Œè¯¯å·®è®¡ç®—å’Œæ§åˆ¶æŒ‡ä»¤ç”Ÿæˆ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><hr><h4 id=ä»£ç è¯´æ˜-5>ä»£ç è¯´æ˜</h4><ol><li><p><strong>è½¨è¿¹å¹³æ»‘éƒ¨åˆ†</strong></p><ul><li>å‡½æ•° <code>smoothTrajectory</code> å¯¹è¾“å…¥çš„åŸå§‹è½¨è¿¹è¿›è¡Œç§»åŠ¨å¹³å‡å¹³æ»‘ï¼Œæ¶ˆé™¤å› ç¦»æ•£é‡‡æ ·äº§ç”Ÿçš„å™ªå£°å’Œä¸è¿ç»­æ€§ã€‚</li><li>é€šè¿‡è°ƒæ•´ <code>windowSize</code> å‚æ•°å¯ä»¥æ§åˆ¶å¹³æ»‘ç¨‹åº¦ï¼ˆçª—å£è¶Šå¤§ï¼Œå¹³æ»‘æ•ˆæœè¶Šæ˜æ˜¾ï¼Œä½†ä¼šä½¿è½¨è¿¹æ»åï¼‰ã€‚</li></ul></li><li><p><strong>å‰ç»å‚è€ƒç‚¹é€‰æ‹©</strong></p><ul><li>å‡½æ•° <code>selectReferencePoint</code> åˆ©ç”¨ UAV å½“å‰çŠ¶æ€å’Œèˆªå‘ï¼Œç»“åˆå¹³æ»‘åçš„è½¨è¿¹æ•°æ®ï¼Œé€‰æ‹©è·ç¦»å½“å‰ UAV ä½ç½®å¤§äº <code>lookaheadDistance</code> ä¸”ä½äºå‰è¿›æ–¹å‘ä¸Šçš„ç¬¬ä¸€ä¸ªè½¨è¿¹ç‚¹ä½œä¸ºç›®æ ‡ç‚¹ã€‚</li></ul></li><li><p><strong>é›†æˆä¸å®æ—¶æ§åˆ¶</strong></p><ul><li>åœ¨ä¸»å‡½æ•°ä¸­ï¼Œå…ˆå¯¹è§„åˆ’çš„åŸå§‹è½¨è¿¹è¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œå†åœ¨ä»¿çœŸå¾ªç¯ä¸­ä¸æ–­é€‰å–å‚è€ƒç‚¹å¹¶è¾“å‡ºï¼ˆå®é™…ç³»ç»Ÿä¸­åº”ç»“åˆ UAV çš„çŠ¶æ€æ›´æ–°ä¸æ§åˆ¶å™¨ï¼‰ã€‚</li></ul></li></ol><p>é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œä¸ä»…èƒ½è·å¾—å¹³æ»‘è¿ç»­çš„è¿‡æ¸¡è½¨è¿¹ï¼Œè¿˜èƒ½ç¡®ä¿åœ¨å®æ—¶è·Ÿè¸ªä¸­ UAV å§‹ç»ˆå‚è€ƒå‰æ–¹çš„ç›®æ ‡è½¨è¿¹ç‚¹ï¼Œæ»¡è¶³å›ºå®šç¿¼ UAV çš„é£è¡ŒåŠ¨æ€è¦æ±‚ï¼Œå¹¶é™ä½ç¢°æ’é£é™©ã€‚</p><footer class=footline><i class='fa-fw fas fa-calendar'></i> 2025-05-21</footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo href=/index.html><img src=/images/logo.png alt="FlitSoft Docs" style=width:80px;height:auto></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class=default-animation><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li class=parent data-nav-id=/uas/index.html><a class=padding href=/uas/index.html>UAS</a><ul id=R-subsections-50d6e18f3c774adcdf96c62beb3fb9ae class=collapsible-menu><li class=alwaysopen data-nav-id=/uas/fix_wing_uav_flight_sim/index.html><a class=padding href=/uas/fix_wing_uav_flight_sim/index.html>Aerodynamics</a><ul id=R-subsections-7b1f39252932eb84ff7bebd53dbcc7d4 class=collapsible-menu></ul></li><li class=alwaysopen data-nav-id=/uas/path-searching/index.html><a class=padding href=/uas/path-searching/index.html>Path Searching</a><ul id=R-subsections-a2b409e9d066676ed37742c4805a3eb9 class=collapsible-menu></ul></li><li class="parent alwaysopen" data-nav-id=/uas/formation-control/index.html><a class=padding href=/uas/formation-control/index.html>Formation Control</a><ul id=R-subsections-e4f6444dc383e8d177ba6adc0bda1264 class=collapsible-menu><li data-nav-id=/uas/formation-control/%E5%9F%BA%E4%BA%8E%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%E6%8E%A7%E5%88%B6%E7%9A%84%E6%97%A0%E4%BA%BA%E6%9C%BA%E7%BC%96%E9%98%9F%E9%A3%9E%E8%A1%8C/index.html><a class=padding href=/uas/formation-control/%E5%9F%BA%E4%BA%8E%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%E6%8E%A7%E5%88%B6%E7%9A%84%E6%97%A0%E4%BA%BA%E6%9C%BA%E7%BC%96%E9%98%9F%E9%A3%9E%E8%A1%8C/index.html>åŸºäºéçº¿æ€§æ¨¡å‹é¢„æµ‹æ§åˆ¶çš„æ— äººæœºç¼–é˜Ÿé£è¡Œ</a></li><li class=active data-nav-id=/uas/formation-control/%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%9B%86%E7%BE%A4%E5%9B%BA%E5%AE%9A%E9%98%B5%E5%9E%8B%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/index.html><a class=padding href=/uas/formation-control/%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%9B%86%E7%BE%A4%E5%9B%BA%E5%AE%9A%E9%98%B5%E5%9E%8B%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/index.html>æ— äººæœºé›†ç¾¤å›ºå®šé˜µå‹è½¨è¿¹ç”Ÿæˆæ¨¡å‹</a></li><li data-nav-id=/uas/formation-control/%E5%9B%BA%E5%AE%9A%E7%BF%BC%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%98%B5%E5%9E%8B%E5%8F%98%E6%8D%A2%E8%BF%87%E6%B8%A1%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90/index.html><a class=padding href=/uas/formation-control/%E5%9B%BA%E5%AE%9A%E7%BF%BC%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%98%B5%E5%9E%8B%E5%8F%98%E6%8D%A2%E8%BF%87%E6%B8%A1%E8%BD%A8%E8%BF%B9%E7%94%9F%E6%88%90/index.html>å›ºå®šç¿¼æ— äººæœºé˜µå‹å˜æ¢è¿‡æ¸¡è½¨è¿¹ç”Ÿæˆ</a></li></ul></li><li class=alwaysopen data-nav-id=/uas/velocity_plan/index.html><a class=padding href=/uas/velocity_plan/index.html>Velocity Planning</a><ul id=R-subsections-60d9350f137676e977a8a40fa195d7e5 class=collapsible-menu></ul></li><li class=alwaysopen data-nav-id=/uas/trajectory_planning/index.html><a class=padding href=/uas/trajectory_planning/index.html>Trajectory Planning</a><ul id=R-subsections-abf2bea1fe96559e28880644014fc77f class=collapsible-menu></ul></li></ul></li><li data-nav-id=/em/index.html><a class=padding href=/em/index.html>EM</a><ul id=R-subsections-5221d921411ef33ede36c0310590339e class=collapsible-menu></ul></li><li data-nav-id=/agi/index.html><a class=padding href=/agi/index.html>AI</a><ul id=R-subsections-b697951847df19851ae8635cac95c15a class=collapsible-menu></ul></li><li data-nav-id=/gaming/index.html><a class=padding href=/gaming/index.html>Gaming</a></li><li data-nav-id=/c2/index.html><a class=padding href=/c2/index.html>C2</a><ul id=R-subsections-e0126222f5f1b52fd67c95ccf5ad1c18 class=collapsible-menu></ul></li><li data-nav-id=/simu/index.html><a class=padding href=/simu/index.html>Simulation</a><ul id=R-subsections-80cfed847676c641fa01f11f3f2904bf class=collapsible-menu></ul></li><li data-nav-id=/visual/index.html><a class=padding href=/visual/index.html>Visualization</a><ul id=R-subsections-080a96fba97ea97926a463e36c9cb108 class=collapsible-menu></ul></li><li data-nav-id=/log/index.html><a class=padding href=/log/index.html>Log</a></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul><li class=R-variantswitcher><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Theme</label>
<select id=R-select-variant><option id=R-select-variant-zen-light value=zen-light selected>Zen Light</option><option id=R-select-variant-zen-dark value=zen-dark>Zen Dark</option></select></div><div class=clear></div></div><script>window.relearn.markVariant()</script></li></ul></div><div id=R-footer><p>Built By FlitSoft</p></div></div></aside><script src=/js/clipboard/clipboard.min.js?1750251247 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1750251247 defer></script><script>window.MathJax=Object.assign(window.MathJax||{},{tex:{inlineMath:[["\\(","\\)"],["$","$"]],displayMath:[["\\[","\\]"],["$$","$$"]]},options:{enableMenu:!1}},JSON.parse("{}"))</script><script id=MathJax-script async src=/js/mathjax/tex-mml-chtml.js?1750251247></script><script src=/js/theme.min.js?1750251247 defer></script></body></html>